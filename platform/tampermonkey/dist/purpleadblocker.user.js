// ==UserScript==
// @name         Purple Adblocker
// @source       https://github.com/arthurbolsoni/Purple-adblock
// @version      2.6.6
// @description  Per aspera ad astra
// @author       ArthurBolzoni
// @downloadURL  https://raw.githubusercontent.com/arthurbolsoni/Purple-adblock/main/tampermonkey/dist/purpleadblocker.user.js
// @updateURL    https://raw.githubusercontent.com/arthurbolsoni/Purple-adblock/main/tampermonkey/dist/purpleadblocker.user.js
// @match        *://*.twitch.tv/*
// @run-at       document-start
// @grant        none
// ==/UserScript==

/******/ (() => { // webpackBootstrap
/******/ 	"use strict";
/******/ 	var __webpack_modules__ = ({

/***/ "./src/index.ts":
/*!**********************!*\
  !*** ./src/index.ts ***!
  \**********************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {


var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
//this line gonna import the content from compile worker as string
//@ts-expect-error
const app_worker_js_1 = __importDefault(__webpack_require__(/*! ../dist/app.worker.js */ "./dist/app.worker.js"));
(function () {
    let mainWorker;
    window.Worker = class WorkerInjector extends Worker {
        constructor(twitchBlobUrl) {
            console.log("new worker intance " + twitchBlobUrl);
            if (twitchBlobUrl == "")
                super(twitchBlobUrl);
            console.log("[Purple]: init " + twitchBlobUrl);
            const newBlobStr = `${app_worker_js_1.default}
      importScripts('${twitchBlobUrl}');`;
            super(URL.createObjectURL(new Blob([newBlobStr], { type: "text/javascript" })));
            mainWorker = this;
            mainWorker.declareEventWorker();
            mainWorker.declareEventWindow();
            mainWorker.integrity();
        }
        integrity() {
            return __awaiter(this, void 0, void 0, function* () {
                __webpack_require__.g.request = fetch;
                __webpack_require__.g.fetch = (url, options) => __awaiter(this, void 0, void 0, function* () {
                    const response = yield __webpack_require__.g.request(url, options);
                    const body = yield response.text();
                    if (url == "https://gql.twitch.tv/integrity") {
                        mainWorker.postMessage({ funcName: "setIntegrity", value: body });
                    }
                    return new Response(body, response);
                });
            });
        }
        declareEventWorker() {
            this.addEventListener("message", (event) => {
                var _a, _b, _c, _d, _e;
                switch ((_a = event === null || event === void 0 ? void 0 : event.data) === null || _a === void 0 ? void 0 : _a.type) {
                    case "getSettings": {
                        window.postMessage({ type: "getSettings", value: null });
                        break;
                    }
                    case "PlayerQualityChanged": {
                        mainWorker.postMessage({ funcName: "setQuality", value: event.data.arg.name });
                        break;
                    }
                    case "pause": {
                        mainWorker.postMessage({ funcName: "pause", args: undefined, id: 1 });
                        break;
                    }
                    case "play": {
                        mainWorker.postMessage({ funcName: "play", args: undefined, id: 1 });
                        break;
                    }
                    default: {
                        break;
                    }
                }
                switch ((_c = (_b = event === null || event === void 0 ? void 0 : event.data) === null || _b === void 0 ? void 0 : _b.arg) === null || _c === void 0 ? void 0 : _c.key) {
                    case "quality": {
                        if (!event.data.arg.value.name)
                            break;
                        console.log("Changed quality by player: " + event.data.arg.value.name);
                        mainWorker.postMessage({ funcName: "setQuality", value: event.data.arg.value.name });
                        break;
                    }
                    case "state": {
                        mainWorker.postMessage({ funcName: event.data.arg.value });
                    }
                    default: {
                        break;
                    }
                }
                switch ((_e = (_d = event === null || event === void 0 ? void 0 : event.data) === null || _d === void 0 ? void 0 : _d.arg) === null || _e === void 0 ? void 0 : _e.name) {
                    case "pause": {
                        break;
                    }
                    case "play": {
                        break;
                    }
                    default: {
                        break;
                    }
                }
            });
        }
        declareEventWindow() {
            //Event listener from window and extension.
            window.addEventListener("message", (event) => {
                switch (event.data.type) {
                    case "setSettings": {
                        //send settings to worker
                        mainWorker.postMessage({ funcName: "setSettings", value: event.data.value });
                    }
                }
            });
        }
    };
})();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMvaW5kZXgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7QUFBQSxrRUFBa0U7QUFDbEUsa0JBQWtCO0FBQ2xCLDBFQUF3QztBQUV4QyxDQUFDO0lBQ0MsSUFBSSxVQUFlLENBQUM7SUFFcEIsTUFBTSxDQUFDLE1BQU0sR0FBRyxNQUFNLGNBQWUsU0FBUSxNQUFNO1FBQ2pELFlBQVksYUFBa0I7WUFDNUIsT0FBTyxDQUFDLEdBQUcsQ0FBQyxxQkFBcUIsR0FBRyxhQUFhLENBQUMsQ0FBQztZQUVuRCxJQUFJLGFBQWEsSUFBSSxFQUFFO2dCQUFFLEtBQUssQ0FBQyxhQUFhLENBQUMsQ0FBQztZQUM5QyxPQUFPLENBQUMsR0FBRyxDQUFDLGlCQUFpQixHQUFHLGFBQWEsQ0FBQyxDQUFDO1lBRS9DLE1BQU0sVUFBVSxHQUFHLEdBQUcsdUJBQUc7dUJBQ1IsYUFBYSxLQUFLLENBQUM7WUFFcEMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxlQUFlLENBQUMsSUFBSSxJQUFJLENBQUMsQ0FBQyxVQUFVLENBQUMsRUFBRSxFQUFFLElBQUksRUFBRSxpQkFBaUIsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ2hGLFVBQVUsR0FBRyxJQUFJLENBQUM7WUFDbEIsVUFBVSxDQUFDLGtCQUFrQixFQUFFLENBQUM7WUFDaEMsVUFBVSxDQUFDLGtCQUFrQixFQUFFLENBQUM7WUFDaEMsVUFBVSxDQUFDLFNBQVMsRUFBRSxDQUFDO1FBQ3pCLENBQUM7UUFFSyxTQUFTOztnQkFDYixNQUFNLENBQUMsT0FBTyxHQUFHLEtBQUssQ0FBQTtnQkFDdEIsTUFBTSxDQUFDLEtBQUssR0FBRyxDQUFPLEdBQVEsRUFBRSxPQUFZLEVBQUUsRUFBRTtvQkFDOUMsTUFBTSxRQUFRLEdBQUcsTUFBTSxNQUFNLENBQUMsT0FBTyxDQUFDLEdBQUcsRUFBRSxPQUFPLENBQUMsQ0FBQztvQkFDcEQsTUFB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

/***/ }),

/***/ "./dist/app.worker.js":
/*!****************************!*\
  !*** ./dist/app.worker.js ***!
  \****************************/
/***/ ((module) => {

module.exports = "/******/ (() => { // webpackBootstrap\n/******/ \tvar __webpack_modules__ = ({\n\n/***/ \"./src/app.controller.ts\":\n/*!*******************************!*\\\n  !*** ./src/app.controller.ts ***!\n  \\*******************************/\n/***/ (function(__unused_webpack_module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\r\nexports.AppController = void 0;\r\nconst controller_decorator_1 = __webpack_require__(/*! ./decorator/controller.decorator */ \"./src/decorator/controller.decorator.ts\");\r\nconst handler_decorator_1 = __webpack_require__(/*! ./decorator/handler.decorator */ \"./src/decorator/handler.decorator.ts\");\r\nlet AppController = class AppController {\r\n    constructor(appService) {\r\n        this.appService = appService;\r\n        this.getSettings = () => __webpack_require__.g.postMessage({ type: \"getSettings\" });\r\n        this.getSettings();\r\n    }\r\n    setIntegrity(data) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            this.appService.setIntegrityToken(JSON.parse(data.value).token);\r\n        });\r\n    }\r\n    onChannel(url, options) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            const response = yield __webpack_require__.g.request(url, options);\r\n            if (!response.ok) {\r\n                console.log(\"Error on channel load\");\r\n                return response;\r\n            }\r\n            const text = yield response.text();\r\n            const channelName = /hls\\/(.*).m3u8/gm.exec(url) || [];\r\n            yield this.appService.setChannel(channelName[1]);\r\n            return new Response(text);\r\n        });\r\n    }\r\n    onFetch(url, options) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            const body = yield (yield request(url, options)).text();\r\n            const playlist = yield this.appService.onFetch(body);\r\n            return new Response(playlist);\r\n        });\r\n    }\r\n    onChannelPicture(url, options) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            return new Response();\r\n        });\r\n    }\r\n    setSettings(data) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            this.appService.setSettings(data);\r\n        });\r\n    }\r\n    setQuality(data) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            this.appService.quality = data.value;\r\n        });\r\n    }\r\n};\r\n__decorate([\r\n    (0, handler_decorator_1.Message)(\"setIntegrity\")\r\n], AppController.prototype, \"setIntegrity\", null);\r\n__decorate([\r\n    (0, handler_decorator_1.Fetch)(\"usher.ttvnw.net/api/channel/hls/\", \"picture-by-picture\")\r\n], AppController.prototype, \"onChannel\", null);\r\n__decorate([\r\n    (0, handler_decorator_1.Fetch)(\"hls.ttvnw.net/v1/playlist/\")\r\n], AppController.prototype, \"onFetch\", null);\r\n__decorate([\r\n    (0, handler_decorator_1.Fetch)(\"picture-by-picture\")\r\n], AppController.prototype, \"onChannelPicture\", null);\r\n__decorate([\r\n    (0, handler_decorator_1.Message)(\"setSettings\")\r\n], AppController.prototype, \"setSettings\", null);\r\n__decorate([\r\n    (0, handler_decorator_1.Message)(\"setQuality\")\r\n], AppController.prototype, \"setQuality\", null);\r\nAppController = __decorate([\r\n    (0, controller_decorator_1.Controller)()\r\n], AppController);\r\nexports.AppController = AppController;\r\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXBwLmNvbnRyb2xsZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMvYXBwLmNvbnRyb2xsZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsMkVBQThEO0FBQzlELHFFQUErRDtBQUkvRCxJQUFhLGFBQWEsR0FBMUIsTUFBYSxhQUFhO0lBR3hCLFlBQTZCLFVBQWtCO1FBQWxCLGVBQVUsR0FBVixVQUFVLENBQVE7UUFGL0MsZ0JBQVcsR0FBRyxHQUFHLEVBQUUsQ0FBQyxNQUFNLENBQUMsV0FBVyxDQUFDLEVBQUUsSUFBSSxFQUFFLGFBQWEsRUFBRSxDQUFDLENBQUM7UUFHOUQsSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDO0lBQ3JCLENBQUM7SUFHSyxZQUFZLENBQUMsSUFBUzs7WUFDMUIsSUFBSSxDQUFDLFVBQVUsQ0FBQyxpQkFBaUIsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUNsRSxDQUFDO0tBQUE7SUFHSyxTQUFTLENBQUMsR0FBVyxFQUFFLE9BQVk7O1lBQ3ZDLE1BQU0sUUFBUSxHQUFhLE1BQU0sTUFBTSxDQUFDLE9BQU8sQ0FBQyxHQUFHLEVBQUUsT0FBTyxDQUFDLENBQUM7WUFDOUQsSUFBSSxDQUFDLFFBQVEsQ0FBQyxFQUFFLEVBQUU7Z0JBQ2hCLE9BQU8sQ0FBQyxHQUFHLENBQUMsdUJBQXVCLENBQUMsQ0FBQztnQkFDckMsT0FBTyxRQUFRLENBQUM7YUFDakI7WUFFRCxNQUFNLElBQUksR0FBRyxNQUFNLFFBQVEsQ0FBQyxJQUFJLEVBQUUsQ0FBQztZQUNuQyxNQUFNLFdBQVcsR0FBRyxrQkFBa0IsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLElBQUksRUFBRSxDQUFDO1lBRXZELE1BQU0sSUFBSSxDQUFDLFVBQVUsQ0FBQyxVQUFVLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDakQsT0FBTyxJQUFJLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUM1QixDQUFDO0tBQUE7SUFHSyxPQUFPLENBQUMsR0FBVyxFQUFFLE9BQVk7O1lBQ3JDLE1BQU0sSUFBSSxHQUFXLE1BQU0sQ0FBQyxNQUFNLE9BQU8sQ0FBQyxHQUFHLEVBQUUsT0FBTyxDQUFDLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQztZQUNoRSxNQUFNLFFBQVEsR0FBRyxNQUFNLElBQUksQ0FBQyxVQUFVLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQ3JELE9BQU8sSUFBSSxRQUFRLENBQUMsUUFBUSxDQUFDLENBQUM7UUFDaEMsQ0FBQztLQUFBO0lBR0ssZ0JBQWdCLENBQUMsR0FBVyxFQUFFLE9BQVk7O1lBQzlDLE9BQU8sSUFBSSxRQUFRLEVBQUUsQ0FBQztRQUN4QixDQUFDO0tBQUE7SUFHSyxXQUFXLENBQUMsSUFBUzs7WUFDekIsSUFBSSxDQUFDLFVBQVUsQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDcEMsQ0FBQztLQUFBO0lBR0ssVUFBVSxDQUFDLElBQVM7O1lBQ3hCLElBQUksQ0FBQyxVQUFVLENBQUMsT0FBTyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUM7UUFDdkMsQ0FBQztLQUFBO0NBQ0YsQ0FBQTtBQXhDQztJQURDLElBQUEsMkJBQU8sRUFBQyxjQUFjLENBQUM7aURBR3ZCO0FBR0Q7SUFEQyxJQUFBLHlCQUFLLEVBQUMsa0NBQWtDLEVBQUUsb0JBQW9CLENBQUM7OENBYS9EO0FBR0Q7SUFEQyxJQUFBLHlCQUFLLEVBQUMsNEJBQTRCLENBQUM7NENBS25DO0FBR0Q7SUFEQyxJQUFBLHlCQUFLLEVBQUMsb0JBQW9CLENBQUM7cURBRzNCO0FBR0Q7SUFEQyxJQUFBLDJCQUFPLEVBQUMsYUFBYSxDQUFDO2dEQUd0QjtBQUdEO0lBREMsSUFBQSwyQkFBTyxFQUFDLFlBQVksQ0FBQzsrQ0FHckI7QUEvQ1UsYUFBYTtJQUR6QixJQUFBLGlDQUFVLEdBQUU7R0FDQSxhQUFhLENBZ0R6QjtBQWhEWSxzQ0FBYSJ9\n\n/***/ }),\n\n/***/ \"./src/app.worker.ts\":\n/*!***************************!*\\\n  !*** ./src/app.worker.ts ***!\n  \\***************************/\n/***/ (function(__unused_webpack_module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\r\nconst app_controller_1 = __webpack_require__(/*! ./app.controller */ \"./src/app.controller.ts\");\r\nconst player_1 = __webpack_require__(/*! ./modules/player/player */ \"./src/modules/player/player.ts\");\r\nfunction app() {\r\n    __webpack_require__.g.logPrint = (x) => console.log(\"[Purple]: \", x);\r\n    __webpack_require__.g.appController = new app_controller_1.AppController(new player_1.Player());\r\n    __webpack_require__.g.logPrint(\"Script running\");\r\n}\r\nexports[\"default\"] = app;\r\n__webpack_require__.g.request = __webpack_require__.g.fetch;\r\n__webpack_require__.g.fetch = (url, options) => __awaiter(void 0, void 0, void 0, function* () {\r\n    if (typeof url === \"string\") {\r\n        for (var i = 0, len = routerList.length; i < len; i++) {\r\n            if (url.includes(routerList[i].match) && !url.includes(routerList[i].ignore)) {\r\n                return new Promise((resolve, reject) => __awaiter(void 0, void 0, void 0, function* () { return resolve(yield __webpack_require__.g.appController[routerList[i].propertyKey](url, options)); }));\r\n            }\r\n        }\r\n    }\r\n    return __webpack_require__.g.request.apply(this, [url, options]);\r\n});\r\n__webpack_require__.g.addEventListener(\"message\", (e) => {\r\n    __webpack_require__.g.messageList.forEach((x) => {\r\n        if (e.data.funcName == x.match)\r\n            __webpack_require__.g.appController[x.propertyKey](e.data);\r\n    });\r\n});\r\napp();\r\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXBwLndvcmtlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL3NyYy9hcHAud29ya2VyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQUEscURBQWlEO0FBQ2pELG9EQUFpRDtBQVVqRCxTQUF3QixHQUFHO0lBQ3pCLE1BQU0sQ0FBQyxRQUFRLEdBQUcsQ0FBQyxDQUFNLEVBQUUsRUFBRSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsWUFBWSxFQUFFLENBQUMsQ0FBQyxDQUFDO0lBQzNELE1BQU0sQ0FBQyxhQUFhLEdBQUcsSUFBSSw4QkFBYSxDQUFDLElBQUksZUFBTSxFQUFFLENBQUMsQ0FBQztJQUV2RCxNQUFNLENBQUMsUUFBUSxDQUFDLGdCQUFnQixDQUFDLENBQUM7QUFDcEMsQ0FBQztBQUxELHNCQUtDO0FBRUQsTUFBTSxDQUFDLE9BQU8sR0FBRyxNQUFNLENBQUMsS0FBSyxDQUFDO0FBQzlCLE1BQU0sQ0FBQyxLQUFLLEdBQUcsQ0FBTyxHQUFRLEVBQUUsT0FBWSxFQUFFLEVBQUU7SUFDOUMsSUFBSSxPQUFPLEdBQUcsS0FBSyxRQUFRLEVBQUU7UUFDM0IsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsR0FBRyxHQUFHLFVBQVUsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxHQUFHLEdBQUcsRUFBRSxDQUFDLEVBQUUsRUFBRTtZQUNyRCxJQUFJLEdBQUcsQ0FBQyxRQUFRLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLFFBQVEsQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTyxDQUFDLEVBQUU7Z0JBQzdFLE9BQU8sSUFBSSxPQUFPLENBQUMsQ0FBTyxPQUFPLEVBQUUsTUFBTSxFQUFFLEVBQUUsa0RBQUMsT0FBQSxPQUFPLENBQUMsTUFBTSxNQUFNLENBQUMsYUFBYSxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxXQUFXLENBQUMsQ0FBQyxHQUFHLEVBQUUsT0FBTyxDQUFDLENBQUMsQ0FBQSxHQUFBLENBQUMsQ0FBQzthQUM3SDtTQUNGO0tBQ0Y7SUFDRCxPQUFPLE1BQU0sQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLElBQUksRUFBRSxDQUFDLEdBQUcsRUFBRSxPQUFPLENBQUMsQ0FBQyxDQUFDO0FBQ3BELENBQUMsQ0FBQSxDQUFDO0FBRUYsTUFBTSxDQUFDLGdCQUFnQixDQUFDLFNBQVMsRUFBRSxDQUFDLENBQU0sRUFBRSxFQUFFO0lBQzVDLE1BQU0sQ0FBQyxXQUFXLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUU7UUFDL0IsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLFFBQVEsSUFBSSxDQUFDLENBQUMsS0FBSztZQUFFLE1BQU0sQ0FBQyxhQUFhLENBQUMsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUM5RSxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDO0FBRUgsR0FBRyxFQUFFLENBQUMifQ==\n\n/***/ }),\n\n/***/ \"./src/decorator/controller.decorator.ts\":\n/*!***********************************************!*\\\n  !*** ./src/decorator/controller.decorator.ts ***!\n  \\***********************************************/\n/***/ ((__unused_webpack_module, exports) => {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\r\nexports.Controller = void 0;\r\nconst Controller = () => {\r\n    return (target) => { };\r\n};\r\nexports.Controller = Controller;\r\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29udHJvbGxlci5kZWNvcmF0b3IuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvZGVjb3JhdG9yL2NvbnRyb2xsZXIuZGVjb3JhdG9yLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUFPLE1BQU0sVUFBVSxHQUFHLEdBQW1CLEVBQUU7SUFDN0MsT0FBTyxDQUFDLE1BQU0sRUFBRSxFQUFFLEdBQUUsQ0FBQyxDQUFDO0FBQ3hCLENBQUMsQ0FBQztBQUZXLFFBQUEsVUFBVSxjQUVyQiJ9\n\n/***/ }),\n\n/***/ \"./src/decorator/handler.decorator.ts\":\n/*!********************************************!*\\\n  !*** ./src/decorator/handler.decorator.ts ***!\n  \\********************************************/\n/***/ ((__unused_webpack_module, exports, __webpack_require__) => {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\r\nexports.Message = exports.Fetch = void 0;\r\nconst Fetch = (match, ignore = null) => {\r\n    return (target, propertyKey) => {\r\n        if (!__webpack_require__.g.routerList)\r\n            __webpack_require__.g.routerList = [];\r\n        __webpack_require__.g.routerList.push({ propertyKey: propertyKey, match: match, ignore: ignore });\r\n    };\r\n};\r\nexports.Fetch = Fetch;\r\nconst Message = (match) => {\r\n    return (target, propertyKey) => {\r\n        if (!__webpack_require__.g.messageList)\r\n            __webpack_require__.g.messageList = [];\r\n        __webpack_require__.g.messageList.push({ propertyKey: propertyKey, match: match });\r\n    };\r\n};\r\nexports.Message = Message;\r\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaGFuZGxlci5kZWNvcmF0b3IuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvZGVjb3JhdG9yL2hhbmRsZXIuZGVjb3JhdG9yLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUFPLE1BQU0sS0FBSyxHQUFHLENBQUMsS0FBYSxFQUFFLFNBQXdCLElBQUksRUFBbUIsRUFBRTtJQUNwRixPQUFPLENBQUMsTUFBTSxFQUFFLFdBQVcsRUFBRSxFQUFFO1FBQzdCLElBQUksQ0FBQyxNQUFNLENBQUMsVUFBVTtZQUFFLE1BQU0sQ0FBQyxVQUFVLEdBQUcsRUFBRSxDQUFDO1FBQy9DLE1BQU0sQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLEVBQUUsV0FBVyxFQUFFLFdBQXFCLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUUsTUFBTSxFQUFFLENBQUMsQ0FBQztJQUMvRixDQUFDLENBQUM7QUFDSixDQUFDLENBQUM7QUFMVyxRQUFBLEtBQUssU0FLaEI7QUFFSyxNQUFNLE9BQU8sR0FBRyxDQUFDLEtBQWEsRUFBbUIsRUFBRTtJQUN4RCxPQUFPLENBQUMsTUFBTSxFQUFFLFdBQVcsRUFBRSxFQUFFO1FBQzdCLElBQUksQ0FBQyxNQUFNLENBQUMsV0FBVztZQUFFLE1BQU0sQ0FBQyxXQUFXLEdBQUcsRUFBRSxDQUFDO1FBQ2pELE1BQU0sQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLEVBQUUsV0FBVyxFQUFFLFdBQXFCLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxDQUFDLENBQUM7SUFDaEYsQ0FBQyxDQUFDO0FBQ0osQ0FBQyxDQUFDO0FBTFcsUUFBQSxPQUFPLFdBS2xCIn0=\n\n/***/ }),\n\n/***/ \"./src/modules/player/player.ts\":\n/*!**************************************!*\\\n  !*** ./src/modules/player/player.ts ***!\n  \\**************************************/\n/***/ (function(__unused_webpack_module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\r\nexports.Player = void 0;\r\nconst stream_1 = __webpack_require__(/*! ../stream/stream */ \"./src/modules/stream/stream.ts\");\r\nconst stream_enum_1 = __webpack_require__(/*! ../stream/interface/stream.enum */ \"./src/modules/stream/interface/stream.enum.ts\");\r\nconst m3u8_parser_1 = __webpack_require__(/*! m3u8-parser */ \"./node_modules/m3u8-parser/dist/m3u8-parser.es.js\");\r\nclass Player {\r\n    constructor() {\r\n        this.integrityToken = \"\"; //the integrity token\r\n        this.streamList = []; //the list of streams that are currently being played\r\n        this.actualChannel = \"\"; //the channel\r\n        this.playingAds = false; //if the stream is playing ads\r\n        this.quality = \"\"; //the quality of the stream\r\n        this.getQuality = () => __webpack_require__.g.postMessage({ type: \"getQuality\" });\r\n        this.getSettings = () => __webpack_require__.g.postMessage({ type: \"getSettings\" });\r\n        this.pause = () => __webpack_require__.g.postMessage({ type: \"pause\" });\r\n        this.play = () => __webpack_require__.g.postMessage({ type: \"play\" });\r\n        this.setSettings = (setting) => {\r\n            var _a, _b, _c, _d, _e;\r\n            this.setting = setting;\r\n            if (((_a = this.setting) === null || _a === void 0 ? void 0 : _a.toggleProxy) && ((_b = this.setting) === null || _b === void 0 ? void 0 : _b.proxyUrl))\r\n                (_d = (_c = this.currentStream()) === null || _c === void 0 ? void 0 : _c.tunnelList) === null || _d === void 0 ? void 0 : _d.push((_e = this.setting) === null || _e === void 0 ? void 0 : _e.proxyUrl);\r\n            logPrint(\"Settings loaded\");\r\n        };\r\n        this.setIntegrityToken = (integrityToken) => this.integrityToken = integrityToken;\r\n        this.pauseAndPlay = () => __awaiter(this, void 0, void 0, function* () {\r\n            this.pause();\r\n            yield new Promise(resolve => setTimeout(resolve, 1000));\r\n            this.play();\r\n        });\r\n        this.onStartAds = () => {\r\n            console.log(\"ads started\");\r\n            this.pauseAndPlay();\r\n            this.pauseAndPlay();\r\n        };\r\n        this.onEndAds = () => {\r\n            console.log(\"ads ended\");\r\n            this.pauseAndPlay();\r\n            this.pauseAndPlay();\r\n        };\r\n        this.isAds = (x, allowChange = false) => {\r\n            const ads = this.hasAds(x);\r\n            if (!allowChange)\r\n                return ads;\r\n            if (this.playingAds == false && this.playingAds != ads)\r\n                this.onStartAds();\r\n            if (this.playingAds == true && this.playingAds != ads)\r\n                this.onEndAds();\r\n            this.playingAds = ads;\r\n            return this.playingAds;\r\n        };\r\n        this.hasAds = (x) => (x === null || x === void 0 ? void 0 : x.toString().includes(\"stitched\")) || (x === null || x === void 0 ? void 0 : x.toString().includes(\"Amazon\")) || (x === null || x === void 0 ? void 0 : x.toString().includes(\"DCM\"));\r\n        this.currentStream = (channel = this.actualChannel) => {\r\n            var _a;\r\n            return (_a = this.streamList) === null || _a === void 0 ? void 0 : _a.find((x) => x.channelName === channel);\r\n        };\r\n    }\r\n    isWhitelist() {\r\n        var _a, _b;\r\n        return ((_b = (_a = this.setting) === null || _a === void 0 ? void 0 : _a.whitelist) === null || _b === void 0 ? void 0 : _b.includes(this.actualChannel)) || false;\r\n    }\r\n    onFetch(text) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (this.isWhitelist())\r\n                return text;\r\n            if (!this.isAds(text, true))\r\n                return this.mergeM3u8Contents([text]);\r\n            let dump = [];\r\n            this.currentStream().createStreamAccess(stream_enum_1.StreamType.FRONTPAGE, this.integrityToken);\r\n            this.currentStream().createStreamAccess(stream_enum_1.StreamType.PICTURE, this.integrityToken);\r\n            const frontpage = yield this.fetchm3u8ByStreamType(stream_enum_1.StreamType.FRONTPAGE);\r\n            // if (frontpage.data) return this.mergeM3u8Contents([frontpage.data, ...dump]);\r\n            dump = dump.concat(frontpage.dump);\r\n            const picture = yield this.fetchm3u8ByStreamType(stream_enum_1.StreamType.PICTURE);\r\n            // if (external.data) return this.mergeM3u8Contents([external.data, ...dump]);\r\n            dump = dump.concat(picture.dump);\r\n            console.log(\"All stream types failed\");\r\n            return this.mergeM3u8Contents([text, ...dump]);\r\n        });\r\n    }\r\n    generateM3u8(manifest) {\r\n        let m3u8Content = `#EXTM3U\\n`;\r\n        if (manifest.targetDuration) {\r\n            m3u8Content += `#EXT-X-TARGETDURATION:${manifest.targetDuration}\\n`;\r\n        }\r\n        if (manifest.mediaSequence) {\r\n            m3u8Content += `#EXT-X-MEDIA-SEQUENCE:${manifest.mediaSequence}\\n`;\r\n        }\r\n        if (manifest.segments) {\r\n            manifest.segments.forEach((segment) => {\r\n                if (segment.duration) {\r\n                    m3u8Content += `#EXTINF:${segment.duration}`;\r\n                    m3u8Content += `\\n`;\r\n                }\r\n                m3u8Content += `${segment.uri}\\n`;\r\n            });\r\n        }\r\n        return m3u8Content;\r\n    }\r\n    mergeM3u8Contents(conteudosM3u8) {\r\n        const manifestos = conteudosM3u8.map((conteudo) => {\r\n            const analisador = new m3u8_parser_1.Parser();\r\n            analisador.push(conteudo);\r\n            analisador.end();\r\n            // extract titles from #EXTINF tags in each segment\r\n            const manifest = analisador.manifest;\r\n            if (manifest.segments) {\r\n                manifest.segments.forEach((segment) => {\r\n                    // Find the #EXTINF tag associated with the current segment\r\n                    const extinfTagRegex = new RegExp(`#EXTINF:([0-9.]*)?,?(.*)(?:\\n|\\r\\n)${segment.uri}`);\r\n                    const match = conteudo.match(extinfTagRegex);\r\n                    if (match) {\r\n                        segment.title = match[2] ? match[2].trim() : \"\";\r\n                    }\r\n                });\r\n            }\r\n            return manifest;\r\n        });\r\n        const manifestoPrincipal = manifestos[0];\r\n        const manifestosSuporte = manifestos.slice(1);\r\n        if (manifestoPrincipal.segments) {\r\n            console.log(\"Segmentos encontrados no manifesto principal:\", manifestoPrincipal.segments.length);\r\n            console.log(\"Manifestos de suporte encontrados:\", manifestosSuporte.length);\r\n            let segmentRemoved = 0;\r\n            // Percorrer os segmentos do manifesto principal e preencher as lacunas com os segmentos do manifesto de suporte\r\n            for (let i = 0; i < manifestoPrincipal.segments.length; i++) {\r\n                const segmentoPrincipal = manifestoPrincipal.segments[i];\r\n                let isChanged = false;\r\n                if (this.hasAds(segmentoPrincipal.title)) {\r\n                    manifestosSuporte.forEach((manifestoSuporte) => {\r\n                        var _a;\r\n                        // Encontre o primeiro segmento de suporte que NÃO contenha o título \"Amazon\" e tenha um tempo semelhante ao segmentoPrincipal (ignorando milissegundos)\r\n                        const segmentoSuporte = (_a = manifestoSuporte === null || manifestoSuporte === void 0 ? void 0 : manifestoSuporte.segments) === null || _a === void 0 ? void 0 : _a.find((seg) => {\r\n                            if (this.hasAds(seg.title))\r\n                                return false;\r\n                            const dataPrincipal = new Date(segmentoPrincipal.dateTimeString);\r\n                            const dataSuporte = new Date(seg.dateTimeString);\r\n                            dataPrincipal.setMilliseconds(0);\r\n                            dataSuporte.setMilliseconds(0);\r\n                            return dataPrincipal.getTime() === dataSuporte.getTime();\r\n                        });\r\n                        if (segmentoSuporte) {\r\n                            // Substitua o segmento principal pelo segmento de suporte\r\n                            manifestoPrincipal.segments[i] = segmentoSuporte;\r\n                            isChanged = true;\r\n                        }\r\n                    });\r\n                    // Se o segmento principal ainda contiver o título \"Amazon\", remova-o\r\n                    if (!isChanged) {\r\n                        manifestoPrincipal.segments.splice(i, 1);\r\n                        i--;\r\n                        segmentRemoved++;\r\n                    }\r\n                }\r\n            }\r\n            console.log(\"Segmento com ads removidos:\", segmentRemoved);\r\n        }\r\n        // Criar uma nova lista de reprodução M3U8 com os segmentos mesclados\r\n        const conteudoM3u8Mesclado = this.generateM3u8(manifestoPrincipal);\r\n        // console.log(\"Conteúdo M3U8 mesclado:\", conteudoM3u8Mesclado);\r\n        return conteudoM3u8Mesclado;\r\n    }\r\n    fetchm3u8ByStreamType(accessType) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            logPrint(\"Stream Type: \" + accessType);\r\n            let dump = [];\r\n            let servers = this.currentStream().getStreamByStreamType(accessType);\r\n            for (const server of servers) {\r\n                //filter server url by quality or bestquality\r\n                const streamUrl = server.findByQuality(this.quality) || server.bestQuality();\r\n                //try get m3u8 content and return if don't have ads.\r\n                const text = yield (yield __webpack_require__.g.request(streamUrl === null || streamUrl === void 0 ? void 0 : streamUrl.url)).text();\r\n                dump.push(text);\r\n                if (this.isAds(text)) {\r\n                    logPrint(\"Stream Type: \" + accessType + \" - Ads found\");\r\n                    this.currentStream().removeServer(server);\r\n                    continue;\r\n                }\r\n                return { data: text, dump: dump };\r\n            }\r\n            return { data: null, dump: dump };\r\n        });\r\n    }\r\n    setChannel(channelName) {\r\n        logPrint(\"Loading channel\", channelName);\r\n        this.actualChannel = channelName;\r\n        const currentStream = new stream_1.Stream(this.actualChannel);\r\n        this.streamList.push(currentStream);\r\n    }\r\n}\r\nexports.Player = Player;\r\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGxheWVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL21vZHVsZXMvcGxheWVyL3BsYXllci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFBQSw2Q0FBMEM7QUFFMUMsaUVBQTZEO0FBRTdELDZDQUFxQztBQUVyQyxNQUFhLE1BQU07SUFBbkI7UUFDRSxtQkFBYyxHQUFHLEVBQUUsQ0FBQyxDQUFDLHFCQUFxQjtRQUUxQyxlQUFVLEdBQWEsRUFBRSxDQUFDLENBQUMscURBQXFEO1FBQ2hGLGtCQUFhLEdBQVcsRUFBRSxDQUFDLENBQUMsYUFBYTtRQUN6QyxlQUFVLEdBQUcsS0FBSyxDQUFDLENBQUMsOEJBQThCO1FBRWxELFlBQU8sR0FBVyxFQUFFLENBQUMsQ0FBQywyQkFBMkI7UUFFakQsZUFBVSxHQUFHLEdBQUcsRUFBRSxDQUFDLE1BQU0sQ0FBQyxXQUFXLENBQUMsRUFBRSxJQUFJLEVBQUUsWUFBWSxFQUFFLENBQUMsQ0FBQztRQUM5RCxnQkFBVyxHQUFHLEdBQUcsRUFBRSxDQUFDLE1BQU0sQ0FBQyxXQUFXLENBQUMsRUFBRSxJQUFJLEVBQUUsYUFBYSxFQUFFLENBQUMsQ0FBQztRQUNoRSxVQUFLLEdBQUcsR0FBRyxFQUFFLENBQUMsTUFBTSxDQUFDLFdBQVcsQ0FBQyxFQUFFLElBQUksRUFBRSxPQUFPLEVBQUUsQ0FBQyxDQUFDO1FBQ3BELFNBQUksR0FBRyxHQUFHLEVBQUUsQ0FBQyxNQUFNLENBQUMsV0FBVyxDQUFDLEVBQUUsSUFBSSxFQUFFLE1BQU0sRUFBRSxDQUFDLENBQUM7UUFFbEQsZ0JBQVcsR0FBRyxDQUFDLE9BQWdCLEVBQUUsRUFBRTs7WUFDakMsSUFBSSxDQUFDLE9BQU8sR0FBRyxPQUFPLENBQUM7WUFDdkIsSUFBSSxDQUFBLE1BQUEsSUFBSSxDQUFDLE9BQU8sMENBQUUsV0FBVyxNQUFJLE1BQUEsSUFBSSxDQUFDLE9BQU8sMENBQUUsUUFBUSxDQUFBO2dCQUFFLE1B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\n\n/***/ }),\n\n/***/ \"./src/modules/stream/interface/stream.enum.ts\":\n/*!*****************************************************!*\\\n  !*** ./src/modules/stream/interface/stream.enum.ts ***!\n  \\*****************************************************/\n/***/ ((__unused_webpack_module, exports) => {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\r\nexports.StreamType = void 0;\r\nvar StreamType;\r\n(function (StreamType) {\r\n    StreamType[\"PICTURE\"] = \"picture-in-picture\";\r\n    StreamType[\"THUNDERDOME\"] = \"thunderdome\";\r\n    StreamType[\"EMBED\"] = \"embed\";\r\n    StreamType[\"FRONTPAGE\"] = \"frontpage\";\r\n    StreamType[\"SITE\"] = \"site\";\r\n    StreamType[\"EXTERNAL\"] = \"external\";\r\n    StreamType[\"DNS\"] = \"dns\";\r\n})(StreamType = exports.StreamType || (exports.StreamType = {}));\r\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3RyZWFtLmVudW0uanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvbW9kdWxlcy9zdHJlYW0vaW50ZXJmYWNlL3N0cmVhbS5lbnVtLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUFBLElBQVksVUFRWDtBQVJELFdBQVksVUFBVTtJQUNwQiw0Q0FBOEIsQ0FBQTtJQUM5Qix5Q0FBMkIsQ0FBQTtJQUMzQiw2QkFBZSxDQUFBO0lBQ2YscUNBQXVCLENBQUE7SUFDdkIsMkJBQWEsQ0FBQTtJQUNiLG1DQUFxQixDQUFBO0lBQ3JCLHlCQUFXLENBQUE7QUFDYixDQUFDLEVBUlcsVUFBVSxHQUFWLGtCQUFVLEtBQVYsa0JBQVUsUUFRckIifQ==\n\n/***/ }),\n\n/***/ \"./src/modules/stream/interface/stream.types.ts\":\n/*!******************************************************!*\\\n  !*** ./src/modules/stream/interface/stream.types.ts ***!\n  \\******************************************************/\n/***/ ((__unused_webpack_module, exports) => {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\r\nexports.Server = exports.StreamUrl = void 0;\r\nclass StreamUrl {\r\n    constructor() {\r\n        this.url = \"\";\r\n        this.quality = \"\";\r\n    }\r\n}\r\nexports.StreamUrl = StreamUrl;\r\nclass Server {\r\n    constructor(partial) {\r\n        this.bestQuality = () => {\r\n            return this.urlList[0];\r\n        };\r\n        this.findByQuality = (quality) => this.urlList.find((x) => x.quality == quality);\r\n        Object.assign(this, partial);\r\n    }\r\n}\r\nexports.Server = Server;\r\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3RyZWFtLnR5cGVzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL21vZHVsZXMvc3RyZWFtL2ludGVyZmFjZS9zdHJlYW0udHlwZXMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQUEsTUFBYSxTQUFTO0lBQXRCO1FBQ0UsUUFBRyxHQUFXLEVBQUUsQ0FBQztRQUNqQixZQUFPLEdBQVcsRUFBRSxDQUFDO0lBQ3ZCLENBQUM7Q0FBQTtBQUhELDhCQUdDO0FBQ0QsTUFBYSxNQUFNO0lBVWpCLFlBQVksT0FBd0I7UUFMcEMsZ0JBQVcsR0FBRyxHQUFHLEVBQUU7WUFDakIsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ3pCLENBQUMsQ0FBQztRQUNGLGtCQUFhLEdBQUcsQ0FBQyxPQUFlLEVBQUUsRUFBRSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUMsT0FBTyxJQUFJLE9BQU8sQ0FBQyxDQUFDO1FBR2xGLE1BQU0sQ0FBQyxNQUFNLENBQUMsSUFBSSxFQUFFLE9BQU8sQ0FBQyxDQUFDO0lBQy9CLENBQUM7Q0FDRjtBQWJELHdCQWFDIn0=\n\n/***/ }),\n\n/***/ \"./src/modules/stream/stream.ts\":\n/*!**************************************!*\\\n  !*** ./src/modules/stream/stream.ts ***!\n  \\**************************************/\n/***/ (function(__unused_webpack_module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\r\nexports.Stream = void 0;\r\nconst stream_enum_1 = __webpack_require__(/*! ./interface/stream.enum */ \"./src/modules/stream/interface/stream.enum.ts\");\r\nconst stream_types_1 = __webpack_require__(/*! ./interface/stream.types */ \"./src/modules/stream/interface/stream.types.ts\");\r\nclass Stream {\r\n    constructor(channelName) {\r\n        this.serverList = []; //the list of servers links m3u8\r\n        this.integrityToken = \"\"; //the integrity token\r\n        this.tunnelList = [\"https://eu1.jupter.ga/channel/{channelname}\", \"https://eu2.jupter.ga/channel/{channelname}\"];\r\n        this.tunnelListHls = [\"https://eu1.jupter.ga/channel/hls/{channelname}\"];\r\n        this.channelName = channelName;\r\n    }\r\n    removeServer(server) {\r\n        const index = this.serverList.indexOf(server);\r\n        if (index > -1)\r\n            this.serverList.splice(index, 1);\r\n    }\r\n    //add m3u8 links with quality to the list of servers\r\n    createServer(text, type = \"local\", sig = true) {\r\n        const qualityUrlSplit = [];\r\n        let captureArray;\r\n        const REGEX = /NAME=\"((?:\\S+\\s+\\S+|\\S+))\",AUTO(?:^|\\S+\\s+)(?:^|\\S+\\s+)(https:\\/\\/video(\\S+).m3u8)/g;\r\n        while ((captureArray = REGEX.exec(text)) !== null) {\r\n            qualityUrlSplit.push({ quality: captureArray[1], url: captureArray[2] });\r\n        }\r\n        const streamList = new stream_types_1.Server({ type: type, urlList: qualityUrlSplit, sig: sig });\r\n        this.serverList.push(streamList);\r\n    }\r\n    //add a new player stream external\r\n    localRequest(playerType, complete = true) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            try {\r\n                const query = 'query PlaybackAccessToken_Template($login: String!, $isLive: Boolean!, $vodID: ID!, $isVod: Boolean!, $playerType: String!) { streamPlaybackAccessToken(channelName: $login, params: {platform: \"web\", playerBackend: \"mediaplayer\", playerType: $playerType}) @include(if: $isLive) { value signature __typename } videoPlaybackAccessToken(id: $vodID, params: {platform: \"web\", playerBackend: \"mediaplayer\", playerType: $playerType}) @include(if: $isVod) { value signature __typename }}';\r\n                const body = {\r\n                    operationName: \"PlaybackAccessToken_Template\",\r\n                    query: query,\r\n                    variables: {\r\n                        isLive: true,\r\n                        login: this.channelName,\r\n                        isVod: false,\r\n                        vodID: \"\",\r\n                        playerType: playerType,\r\n                    },\r\n                };\r\n                const gql = yield __webpack_require__.g.request(\"https://gql.twitch.tv/gql\", {\r\n                    method: \"POST\",\r\n                    headers: { \"Host\": \"gql.twitch.tv\", \"Client-ID\": \"kimne78kx3ncx6brgo4mv6wki5h1ko\" },\r\n                    body: JSON.stringify(body),\r\n                });\r\n                const streamDataAccess = yield gql.json();\r\n                const params = \"allow_source=true&fast_bread=true&p=\" +\r\n                    Math.floor(Math.random() * 1e7) +\r\n                    \"&player_backend=mediaplayer&playlist_include_framerate=true&reassignments_supported=false&sig=\" +\r\n                    streamDataAccess.data.streamPlaybackAccessToken.signature +\r\n                    \"&supported_codecs=avc1&token=\" +\r\n                    streamDataAccess.data.streamPlaybackAccessToken.value;\r\n                if (!complete)\r\n                    return params;\r\n                const text = yield (yield __webpack_require__.g.request(\"https://usher.ttvnw.net/api/channel/hls/\" + this.channelName + \".m3u8?\" + params)).text();\r\n                logPrint(\"Server loaded \" + playerType);\r\n                this.createServer(text, playerType);\r\n                return text;\r\n            }\r\n            catch (e) {\r\n                logPrint(e);\r\n                return \"\";\r\n            }\r\n        });\r\n    }\r\n    //add a new player stream external\r\n    requestPictureInPicture(integrityToken) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            try {\r\n                const query = 'query PlaybackAccessToken_Template($login: String!, $isLive: Boolean!, $vodID: ID!, $isVod: Boolean!, $playerType: String!) { streamPlaybackAccessToken(channelName: $login, params: {platform: \"web\", playerBackend: \"mediaplayer\", playerType: $playerType}) @include(if: $isLive) { value signature __typename } videoPlaybackAccessToken(id: $vodID, params: {platform: \"web\", playerBackend: \"mediaplayer\", playerType: $playerType}) @include(if: $isVod) { value signature __typename }}';\r\n                const body = {\r\n                    operationName: \"PlaybackAccessToken_Template\",\r\n                    query: query,\r\n                    variables: {\r\n                        isLive: true,\r\n                        login: this.channelName,\r\n                        isVod: false,\r\n                        vodID: \"\",\r\n                        playerType: \"picture-by-picture\",\r\n                    },\r\n                };\r\n                const gql = yield __webpack_require__.g.request(\"https://gql.twitch.tv/gql\", {\r\n                    method: \"POST\",\r\n                    headers: { \"Host\": \"gql.twitch.tv\", \"Client-ID\": \"kimne78kx3ncx6brgo4mv6wki5h1ko\" },\r\n                    body: JSON.stringify(body),\r\n                });\r\n                const streamDataAccess = yield gql.json();\r\n                const params = \"allow_source=true&fast_bread=true&p=\" +\r\n                    Math.floor(Math.random() * 1e7) +\r\n                    \"&player_backend=mediaplayer&playlist_include_framerate=true&reassignments_supported=false&sig=\" +\r\n                    streamDataAccess.data.streamPlaybackAccessToken.signature +\r\n                    \"&supported_codecs=avc1&token=\" +\r\n                    streamDataAccess.data.streamPlaybackAccessToken.value;\r\n                const text = yield (yield __webpack_require__.g.request(\"https://usher.ttvnw.net/api/channel/hls/\" + this.channelName + \".m3u8?\" + params)).text();\r\n                this.createServer(text, stream_enum_1.StreamType.PICTURE);\r\n                return text;\r\n            }\r\n            catch (e) {\r\n                logPrint(e);\r\n                return \"\";\r\n            }\r\n        });\r\n    }\r\n    //add a new player stream external\r\n    externalRequest() {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            logPrint(\"External Server: Loading\");\r\n            const urls = this.tunnelList.map((x) => x.replace(\"{channelname}\", this.channelName));\r\n            urls.forEach((currentTunnel) => __awaiter(this, void 0, void 0, function* () {\r\n                try {\r\n                    const response = yield __webpack_require__.g.request(currentTunnel);\r\n                    if (!response.ok)\r\n                        logPrint(\"Server proxy return error\", currentTunnel, response);\r\n                    this.createServer(yield response.text(), stream_enum_1.StreamType.EXTERNAL);\r\n                    logPrint(\"External Server: OK\");\r\n                    return true;\r\n                }\r\n                catch (e) {\r\n                    logPrint(\"Server proxy return error\", currentTunnel, e);\r\n                    return false;\r\n                }\r\n            }));\r\n        });\r\n    }\r\n    //add a new player stream external\r\n    externalRequest2() {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            logPrint(\"External Server 2: Loading\");\r\n            const url = this.tunnelListHls[0].replace(\"{channelname}\", this.channelName);\r\n            const params = yield this.localRequest(stream_enum_1.StreamType.SITE, false);\r\n            const m3u8 = yield fetch(url, { method: \"POST\", body: params });\r\n            if (!m3u8.ok) {\r\n                logPrint(\"Server proxy return error\", this.tunnelListHls[0], m3u8);\r\n                return;\r\n            }\r\n            const text = yield m3u8.text();\r\n            this.createServer(text, stream_enum_1.StreamType.EXTERNAL);\r\n            logPrint(\"External Server 2: OK\");\r\n        });\r\n    }\r\n    //create a new stream access\r\n    createStreamAccess(stream, integrityToken) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (stream == stream_enum_1.StreamType.EXTERNAL) {\r\n                yield this.externalRequest2();\r\n                return;\r\n            }\r\n            if (stream == stream_enum_1.StreamType.PICTURE) {\r\n                yield this.requestPictureInPicture(integrityToken);\r\n                return;\r\n            }\r\n            yield this.localRequest(stream);\r\n        });\r\n    }\r\n    getStreamByStreamType(accessType) {\r\n        //filter all server by type\r\n        const servers = this.serverList.filter((x) => x.type == accessType);\r\n        if (!servers)\r\n            return [];\r\n        return servers;\r\n    }\r\n}\r\nexports.Stream = Stream;\r\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3RyZWFtLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL21vZHVsZXMvc3RyZWFtL3N0cmVhbS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFBQSx5REFBcUQ7QUFDckQsMkRBQTZEO0FBRTdELE1BQWEsTUFBTTtJQVFqQixZQUFZLFdBQW1CO1FBUC9CLGVBQVUsR0FBYSxFQUFFLENBQUMsQ0FBQyxnQ0FBZ0M7UUFLM0QsbUJBQWMsR0FBRyxFQUFFLENBQUMsQ0FBQyxxQkFBcUI7UUFHeEMsSUFBSSxDQUFDLFVBQVUsR0FBRyxDQUFDLDZDQUE2QyxFQUFFLDZDQUE2QyxDQUFDLENBQUM7UUFDakgsSUFBSSxDQUFDLGFBQWEsR0FBRyxDQUFDLGlEQUFpRCxDQUFDLENBQUM7UUFDekUsSUFBSSxDQUFDLFdBQVcsR0FBRyxXQUFXLENBQUM7SUFDakMsQ0FBQztJQUVELFlBQVksQ0FBQyxNQUFjO1FBQ3pCLE1BQU0sS0FBSyxHQUFHLElBQUksQ0FBQyxVQUFVLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBQzlDLElBQUksS0FBSyxHQUFHLENBQUMsQ0FBQztZQUFFLElBQUksQ0FBQyxVQUFVLENBQUMsTUFBTSxDQUFDLEtBQUssRUFBRSxDQUFDLENBQUMsQ0FBQztJQUNuRCxDQUFDO0lBRUQsb0RBQW9EO0lBQ3BELFlBQVksQ0FBQyxJQUFZLEVBQUUsSUFBSSxHQUFHLE9BQU8sRUFBRSxHQUFHLEdBQUcsSUFBSTtRQUNuRCxNQUFNLGVBQWUsR0FBZ0IsRUFBRSxDQUFDO1FBQ3hDLElBQUksWUFBb0MsQ0FBQztRQUV6QyxNQUFNLEtBQUssR0FBRyxxRkFBcUYsQ0FBQztRQUVwRyxPQUFPLENBQUMsWUFBWSxHQUFHLEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsS0FBSyxJQUFJLEVBQUU7WUFDakQsZUFBZSxDQUFDLElBQUksQ0FBQyxFQUFFLE9BQU8sRUFBRSxZQUFZLENBQUMs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\n\n/***/ }),\n\n/***/ \"./node_modules/@videojs/vhs-utils/es/decode-b64-to-uint8-array.js\":\n/*!*************************************************************************!*\\\n  !*** ./node_modules/@videojs/vhs-utils/es/decode-b64-to-uint8-array.js ***!\n  \\*************************************************************************/\n/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {\n\n\"use strict\";\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ decodeB64ToUint8Array)\n/* harmony export */ });\n/* harmony import */ var global_window__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! global/window */ \"./node_modules/global/window.js\");\n/* harmony import */ var global_window__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(global_window__WEBPACK_IMPORTED_MODULE_0__);\n\n\nvar atob = function atob(s) {\n  return (global_window__WEBPACK_IMPORTED_MODULE_0___default().atob) ? global_window__WEBPACK_IMPORTED_MODULE_0___default().atob(s) : Buffer.from(s, 'base64').toString('binary');\n};\n\nfunction decodeB64ToUint8Array(b64Text) {\n  var decodedString = atob(b64Text);\n  var array = new Uint8Array(decodedString.length);\n\n  for (var i = 0; i < decodedString.length; i++) {\n    array[i] = decodedString.charCodeAt(i);\n  }\n\n  return array;\n}\n\n/***/ }),\n\n/***/ \"./node_modules/@videojs/vhs-utils/es/stream.js\":\n/*!******************************************************!*\\\n  !*** ./node_modules/@videojs/vhs-utils/es/stream.js ***!\n  \\******************************************************/\n/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {\n\n\"use strict\";\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ Stream)\n/* harmony export */ });\n/**\n * @file stream.js\n */\n\n/**\n * A lightweight readable stream implemention that handles event dispatching.\n *\n * @class Stream\n */\nvar Stream = /*#__PURE__*/function () {\n  function Stream() {\n    this.listeners = {};\n  }\n  /**\n   * Add a listener for a specified event type.\n   *\n   * @param {string} type the event name\n   * @param {Function} listener the callback to be invoked when an event of\n   * the specified type occurs\n   */\n\n\n  var _proto = Stream.prototype;\n\n  _proto.on = function on(type, listener) {\n    if (!this.listeners[type]) {\n      this.listeners[type] = [];\n    }\n\n    this.listeners[type].push(listener);\n  }\n  /**\n   * Remove a listener for a specified event type.\n   *\n   * @param {string} type the event name\n   * @param {Function} listener  a function previously registered for this\n   * type of event through `on`\n   * @return {boolean} if we could turn it off or not\n   */\n  ;\n\n  _proto.off = function off(type, listener) {\n    if (!this.listeners[type]) {\n      return false;\n    }\n\n    var index = this.listeners[type].indexOf(listener); // TODO: which is better?\n    // In Video.js we slice listener functions\n    // on trigger so that it does not mess up the order\n    // while we loop through.\n    //\n    // Here we slice on off so that the loop in trigger\n    // can continue using it's old reference to loop without\n    // messing up the order.\n\n    this.listeners[type] = this.listeners[type].slice(0);\n    this.listeners[type].splice(index, 1);\n    return index > -1;\n  }\n  /**\n   * Trigger an event of the specified type on this stream. Any additional\n   * arguments to this function are passed as parameters to event listeners.\n   *\n   * @param {string} type the event name\n   */\n  ;\n\n  _proto.trigger = function trigger(type) {\n    var callbacks = this.listeners[type];\n\n    if (!callbacks) {\n      return;\n    } // Slicing the arguments on every invocation of this method\n    // can add a significant amount of overhead. Avoid the\n    // intermediate object creation for the common case of a\n    // single callback argument\n\n\n    if (arguments.length === 2) {\n      var length = callbacks.length;\n\n      for (var i = 0; i < length; ++i) {\n        callbacks[i].call(this, arguments[1]);\n      }\n    } else {\n      var args = Array.prototype.slice.call(arguments, 1);\n      var _length = callbacks.length;\n\n      for (var _i = 0; _i < _length; ++_i) {\n        callbacks[_i].apply(this, args);\n      }\n    }\n  }\n  /**\n   * Destroys the stream and cleans up.\n   */\n  ;\n\n  _proto.dispose = function dispose() {\n    this.listeners = {};\n  }\n  /**\n   * Forwards all `data` events on this stream to the destination stream. The\n   * destination stream should provide a method `push` to receive the data\n   * events as they arrive.\n   *\n   * @param {Stream} destination the stream that will receive all `data` events\n   * @see http://nodejs.org/api/stream.html#stream_readable_pipe_destination_options\n   */\n  ;\n\n  _proto.pipe = function pipe(destination) {\n    this.on('data', function (data) {\n      destination.push(data);\n    });\n  };\n\n  return Stream;\n}();\n\n\n\n/***/ }),\n\n/***/ \"./node_modules/global/window.js\":\n/*!***************************************!*\\\n  !*** ./node_modules/global/window.js ***!\n  \\***************************************/\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar win;\n\nif (typeof window !== \"undefined\") {\n    win = window;\n} else if (typeof __webpack_require__.g !== \"undefined\") {\n    win = __webpack_require__.g;\n} else if (typeof self !== \"undefined\"){\n    win = self;\n} else {\n    win = {};\n}\n\nmodule.exports = win;\n\n\n/***/ }),\n\n/***/ \"./node_modules/m3u8-parser/dist/m3u8-parser.es.js\":\n/*!*********************************************************!*\\\n  !*** ./node_modules/m3u8-parser/dist/m3u8-parser.es.js ***!\n  \\*********************************************************/\n/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {\n\n\"use strict\";\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"LineStream\": () => (/* binding */ LineStream),\n/* harmony export */   \"ParseStream\": () => (/* binding */ ParseStream),\n/* harmony export */   \"Parser\": () => (/* binding */ Parser)\n/* harmony export */ });\n/* harmony import */ var _videojs_vhs_utils_es_stream_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @videojs/vhs-utils/es/stream.js */ \"./node_modules/@videojs/vhs-utils/es/stream.js\");\n/* harmony import */ var _babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/extends */ \"./node_modules/@babel/runtime/helpers/esm/extends.js\");\n/* harmony import */ var _videojs_vhs_utils_es_decode_b64_to_uint8_array_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @videojs/vhs-utils/es/decode-b64-to-uint8-array.js */ \"./node_modules/@videojs/vhs-utils/es/decode-b64-to-uint8-array.js\");\n/*! @name m3u8-parser @version 6.0.0 @license Apache-2.0 */\n\n\n\n\n/**\n * @file m3u8/line-stream.js\n */\n/**\n * A stream that buffers string input and generates a `data` event for each\n * line.\n *\n * @class LineStream\n * @extends Stream\n */\n\nclass LineStream extends _videojs_vhs_utils_es_stream_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\n  constructor() {\n    super();\n    this.buffer = '';\n  }\n  /**\n   * Add new data to be parsed.\n   *\n   * @param {string} data the text to process\n   */\n\n\n  push(data) {\n    let nextNewline;\n    this.buffer += data;\n    nextNewline = this.buffer.indexOf('\\n');\n\n    for (; nextNewline > -1; nextNewline = this.buffer.indexOf('\\n')) {\n      this.trigger('data', this.buffer.substring(0, nextNewline));\n      this.buffer = this.buffer.substring(nextNewline + 1);\n    }\n  }\n\n}\n\nconst TAB = String.fromCharCode(0x09);\n\nconst parseByterange = function (byterangeString) {\n  // optionally match and capture 0+ digits before `@`\n  // optionally match and capture 0+ digits after `@`\n  const match = /([0-9.]*)?@?([0-9.]*)?/.exec(byterangeString || '');\n  const result = {};\n\n  if (match[1]) {\n    result.length = parseInt(match[1], 10);\n  }\n\n  if (match[2]) {\n    result.offset = parseInt(match[2], 10);\n  }\n\n  return result;\n};\n/**\n * \"forgiving\" attribute list psuedo-grammar:\n * attributes -> keyvalue (',' keyvalue)*\n * keyvalue   -> key '=' value\n * key        -> [^=]*\n * value      -> '\"' [^\"]* '\"' | [^,]*\n */\n\n\nconst attributeSeparator = function () {\n  const key = '[^=]*';\n  const value = '\"[^\"]*\"|[^,]*';\n  const keyvalue = '(?:' + key + ')=(?:' + value + ')';\n  return new RegExp('(?:^|,)(' + keyvalue + ')');\n};\n/**\n * Parse attributes from a line given the separator\n *\n * @param {string} attributes the attribute line to parse\n */\n\n\nconst parseAttributes = function (attributes) {\n  const result = {};\n\n  if (!attributes) {\n    return result;\n  } // split the string using attributes as the separator\n\n\n  const attrs = attributes.split(attributeSeparator());\n  let i = attrs.length;\n  let attr;\n\n  while (i--) {\n    // filter out unmatched portions of the string\n    if (attrs[i] === '') {\n      continue;\n    } // split the key and value\n\n\n    attr = /([^=]*)=(.*)/.exec(attrs[i]).slice(1); // trim whitespace and remove optional quotes around the value\n\n    attr[0] = attr[0].replace(/^\\s+|\\s+$/g, '');\n    attr[1] = attr[1].replace(/^\\s+|\\s+$/g, '');\n    attr[1] = attr[1].replace(/^['\"](.*)['\"]$/g, '$1');\n    result[attr[0]] = attr[1];\n  }\n\n  return result;\n};\n/**\n * A line-level M3U8 parser event stream. It expects to receive input one\n * line at a time and performs a context-free parse of its contents. A stream\n * interpretation of a manifest can be useful if the manifest is expected to\n * be too large to fit comfortably into memory or the entirety of the input\n * is not immediately available. Otherwise, it's probably much easier to work\n * with a regular `Parser` object.\n *\n * Produces `data` events with an object that captures the parser's\n * interpretation of the input. That object has a property `tag` that is one\n * of `uri`, `comment`, or `tag`. URIs only have a single additional\n * property, `line`, which captures the entirety of the input without\n * interpretation. Comments similarly have a single additional property\n * `text` which is the input without the leading `#`.\n *\n * Tags always have a property `tagType` which is the lower-cased version of\n * the M3U8 directive without the `#EXT` or `#EXT-X-` prefix. For instance,\n * `#EXT-X-MEDIA-SEQUENCE` becomes `media-sequence` when parsed. Unrecognized\n * tags are given the tag type `unknown` and a single additional property\n * `data` with the remainder of the input.\n *\n * @class ParseStream\n * @extends Stream\n */\n\n\nclass ParseStream extends _videojs_vhs_utils_es_stream_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\n  constructor() {\n    super();\n    this.customParsers = [];\n    this.tagMappers = [];\n  }\n  /**\n   * Parses an additional line of input.\n   *\n   * @param {string} line a single line of an M3U8 file to parse\n   */\n\n\n  push(line) {\n    let match;\n    let event; // strip whitespace\n\n    line = line.trim();\n\n    if (line.length === 0) {\n      // ignore empty lines\n      return;\n    } // URIs\n\n\n    if (line[0] !== '#') {\n      this.trigger('data', {\n        type: 'uri',\n        uri: line\n      });\n      return;\n    } // map tags\n\n\n    const newLines = this.tagMappers.reduce((acc, mapper) => {\n      const mappedLine = mapper(line); // skip if unchanged\n\n      if (mappedLine === line) {\n        return acc;\n      }\n\n      return acc.concat([mappedLine]);\n    }, [line]);\n    newLines.forEach(newLine => {\n      for (let i = 0; i < this.customParsers.length; i++) {\n        if (this.customParsers[i].call(this, newLine)) {\n          return;\n        }\n      } // Comments\n\n\n      if (newLine.indexOf('#EXT') !== 0) {\n        this.trigger('data', {\n          type: 'comment',\n          text: newLine.slice(1)\n        });\n        return;\n      } // strip off any carriage returns here so the regex matching\n      // doesn't have to account for them.\n\n\n      newLine = newLine.replace('\\r', ''); // Tags\n\n      match = /^#EXTM3U/.exec(newLine);\n\n      if (match) {\n        this.trigger('data', {\n          type: 'tag',\n          tagType: 'm3u'\n        });\n        return;\n      }\n\n      match = /^#EXTINF:([0-9\\.]*)?,?(.*)?$/.exec(newLine);\n\n      if (match) {\n        event = {\n          type: 'tag',\n          tagType: 'inf'\n        };\n\n        if (match[1]) {\n          event.duration = parseFloat(match[1]);\n        }\n\n        if (match[2]) {\n          event.title = match[2];\n        }\n\n        this.trigger('data', event);\n        return;\n      }\n\n      match = /^#EXT-X-TARGETDURATION:([0-9.]*)?/.exec(newLine);\n\n      if (match) {\n        event = {\n          type: 'tag',\n          tagType: 'targetduration'\n        };\n\n        if (match[1]) {\n          event.duration = parseInt(match[1], 10);\n        }\n\n        this.trigger('data', event);\n        return;\n      }\n\n      match = /^#EXT-X-VERSION:([0-9.]*)?/.exec(newLine);\n\n      if (match) {\n        event = {\n          type: 'tag',\n          tagType: 'version'\n        };\n\n        if (match[1]) {\n          event.version = parseInt(match[1], 10);\n        }\n\n        this.trigger('data', event);\n        return;\n      }\n\n      match = /^#EXT-X-MEDIA-SEQUENCE:(\\-?[0-9.]*)?/.exec(newLine);\n\n      if (match) {\n        event = {\n          type: 'tag',\n          tagType: 'media-sequence'\n        };\n\n        if (match[1]) {\n          event.number = parseInt(match[1], 10);\n        }\n\n        this.trigger('data', event);\n        return;\n      }\n\n      match = /^#EXT-X-DISCONTINUITY-SEQUENCE:(\\-?[0-9.]*)?/.exec(newLine);\n\n      if (match) {\n        event = {\n          type: 'tag',\n          tagType: 'discontinuity-sequence'\n        };\n\n        if (match[1]) {\n          event.number = parseInt(match[1], 10);\n        }\n\n        this.trigger('data', event);\n        return;\n      }\n\n      match = /^#EXT-X-PLAYLIST-TYPE:(.*)?$/.exec(newLine);\n\n      if (match) {\n        event = {\n          type: 'tag',\n          tagType: 'playlist-type'\n        };\n\n        if (match[1]) {\n          event.playlistType = match[1];\n        }\n\n        this.trigger('data', event);\n        return;\n      }\n\n      match = /^#EXT-X-BYTERANGE:(.*)?$/.exec(newLine);\n\n      if (match) {\n        event = (0,_babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(parseByterange(match[1]), {\n          type: 'tag',\n          tagType: 'byterange'\n        });\n        this.trigger('data', event);\n        return;\n      }\n\n      match = /^#EXT-X-ALLOW-CACHE:(YES|NO)?/.exec(newLine);\n\n      if (match) {\n        event = {\n          type: 'tag',\n          tagType: 'allow-cache'\n        };\n\n        if (match[1]) {\n          event.allowed = !/NO/.test(match[1]);\n        }\n\n        this.trigger('data', event);\n        return;\n      }\n\n      match = /^#EXT-X-MAP:(.*)$/.exec(newLine);\n\n      if (match) {\n        event = {\n          type: 'tag',\n          tagType: 'map'\n        };\n\n        if (match[1]) {\n          const attributes = parseAttributes(match[1]);\n\n          if (attributes.URI) {\n            event.uri = attributes.URI;\n          }\n\n          if (attributes.BYTERANGE) {\n            event.byterange = parseByterange(attributes.BYTERANGE);\n          }\n        }\n\n        this.trigger('data', event);\n        return;\n      }\n\n      match = /^#EXT-X-STREAM-INF:(.*)$/.exec(newLine);\n\n      if (match) {\n        event = {\n          type: 'tag',\n          tagType: 'stream-inf'\n        };\n\n        if (match[1]) {\n          event.attributes = parseAttributes(match[1]);\n\n          if (event.attributes.RESOLUTION) {\n            const split = event.attributes.RESOLUTION.split('x');\n            const resolution = {};\n\n            if (split[0]) {\n              resolution.width = parseInt(split[0], 10);\n            }\n\n            if (split[1]) {\n              resolution.height = parseInt(split[1], 10);\n            }\n\n            event.attributes.RESOLUTION = resolution;\n          }\n\n          if (event.attributes.BANDWIDTH) {\n            event.attributes.BANDWIDTH = parseInt(event.attributes.BANDWIDTH, 10);\n          }\n\n          if (event.attributes['FRAME-RATE']) {\n            event.attributes['FRAME-RATE'] = parseFloat(event.attributes['FRAME-RATE']);\n          }\n\n          if (event.attributes['PROGRAM-ID']) {\n            event.attributes['PROGRAM-ID'] = parseInt(event.attributes['PROGRAM-ID'], 10);\n          }\n        }\n\n        this.trigger('data', event);\n        return;\n      }\n\n      match = /^#EXT-X-MEDIA:(.*)$/.exec(newLine);\n\n      if (match) {\n        event = {\n          type: 'tag',\n          tagType: 'media'\n        };\n\n        if (match[1]) {\n          event.attributes = parseAttributes(match[1]);\n        }\n\n        this.trigger('data', event);\n        return;\n      }\n\n      match = /^#EXT-X-ENDLIST/.exec(newLine);\n\n      if (match) {\n        this.trigger('data', {\n          type: 'tag',\n          tagType: 'endlist'\n        });\n        return;\n      }\n\n      match = /^#EXT-X-DISCONTINUITY/.exec(newLine);\n\n      if (match) {\n        this.trigger('data', {\n          type: 'tag',\n          tagType: 'discontinuity'\n        });\n        return;\n      }\n\n      match = /^#EXT-X-PROGRAM-DATE-TIME:(.*)$/.exec(newLine);\n\n      if (match) {\n        event = {\n          type: 'tag',\n          tagType: 'program-date-time'\n        };\n\n        if (match[1]) {\n          event.dateTimeString = match[1];\n          event.dateTimeObject = new Date(match[1]);\n        }\n\n        this.trigger('data', event);\n        return;\n      }\n\n      match = /^#EXT-X-KEY:(.*)$/.exec(newLine);\n\n      if (match) {\n        event = {\n          type: 'tag',\n          tagType: 'key'\n        };\n\n        if (match[1]) {\n          event.attributes = parseAttributes(match[1]); // parse the IV string into a Uint32Array\n\n          if (event.attributes.IV) {\n            if (event.attributes.IV.substring(0, 2).toLowerCase() === '0x') {\n              event.attributes.IV = event.attributes.IV.substring(2);\n            }\n\n            event.attributes.IV = event.attributes.IV.match(/.{8}/g);\n            event.attributes.IV[0] = parseInt(event.attributes.IV[0], 16);\n            event.attributes.IV[1] = parseInt(event.attributes.IV[1], 16);\n            event.attributes.IV[2] = parseInt(event.attributes.IV[2], 16);\n            event.attributes.IV[3] = parseInt(event.attributes.IV[3], 16);\n            event.attributes.IV = new Uint32Array(event.attributes.IV);\n          }\n        }\n\n        this.trigger('data', event);\n        return;\n      }\n\n      match = /^#EXT-X-START:(.*)$/.exec(newLine);\n\n      if (match) {\n        event = {\n          type: 'tag',\n          tagType: 'start'\n        };\n\n        if (match[1]) {\n          event.attributes = parseAttributes(match[1]);\n          event.attributes['TIME-OFFSET'] = parseFloat(event.attributes['TIME-OFFSET']);\n          event.attributes.PRECISE = /YES/.test(event.attributes.PRECISE);\n        }\n\n        this.trigger('data', event);\n        return;\n      }\n\n      match = /^#EXT-X-CUE-OUT-CONT:(.*)?$/.exec(newLine);\n\n      if (match) {\n        event = {\n          type: 'tag',\n          tagType: 'cue-out-cont'\n        };\n\n        if (match[1]) {\n          event.data = match[1];\n        } else {\n          event.data = '';\n        }\n\n        this.trigger('data', event);\n        return;\n      }\n\n      match = /^#EXT-X-CUE-OUT:(.*)?$/.exec(newLine);\n\n      if (match) {\n        event = {\n          type: 'tag',\n          tagType: 'cue-out'\n        };\n\n        if (match[1]) {\n          event.data = match[1];\n        } else {\n          event.data = '';\n        }\n\n        this.trigger('data', event);\n        return;\n      }\n\n      match = /^#EXT-X-CUE-IN:(.*)?$/.exec(newLine);\n\n      if (match) {\n        event = {\n          type: 'tag',\n          tagType: 'cue-in'\n        };\n\n        if (match[1]) {\n          event.data = match[1];\n        } else {\n          event.data = '';\n        }\n\n        this.trigger('data', event);\n        return;\n      }\n\n      match = /^#EXT-X-SKIP:(.*)$/.exec(newLine);\n\n      if (match && match[1]) {\n        event = {\n          type: 'tag',\n          tagType: 'skip'\n        };\n        event.attributes = parseAttributes(match[1]);\n\n        if (event.attributes.hasOwnProperty('SKIPPED-SEGMENTS')) {\n          event.attributes['SKIPPED-SEGMENTS'] = parseInt(event.attributes['SKIPPED-SEGMENTS'], 10);\n        }\n\n        if (event.attributes.hasOwnProperty('RECENTLY-REMOVED-DATERANGES')) {\n          event.attributes['RECENTLY-REMOVED-DATERANGES'] = event.attributes['RECENTLY-REMOVED-DATERANGES'].split(TAB);\n        }\n\n        this.trigger('data', event);\n        return;\n      }\n\n      match = /^#EXT-X-PART:(.*)$/.exec(newLine);\n\n      if (match && match[1]) {\n        event = {\n          type: 'tag',\n          tagType: 'part'\n        };\n        event.attributes = parseAttributes(match[1]);\n        ['DURATION'].forEach(function (key) {\n          if (event.attributes.hasOwnProperty(key)) {\n            event.attributes[key] = parseFloat(event.attributes[key]);\n          }\n        });\n        ['INDEPENDENT', 'GAP'].forEach(function (key) {\n          if (event.attributes.hasOwnProperty(key)) {\n            event.attributes[key] = /YES/.test(event.attributes[key]);\n          }\n        });\n\n        if (event.attributes.hasOwnProperty('BYTERANGE')) {\n          event.attributes.byterange = parseByterange(event.attributes.BYTERANGE);\n        }\n\n        this.trigger('data', event);\n        return;\n      }\n\n      match = /^#EXT-X-SERVER-CONTROL:(.*)$/.exec(newLine);\n\n      if (match && match[1]) {\n        event = {\n          type: 'tag',\n          tagType: 'server-control'\n        };\n        event.attributes = parseAttributes(match[1]);\n        ['CAN-SKIP-UNTIL', 'PART-HOLD-BACK', 'HOLD-BACK'].forEach(function (key) {\n          if (event.attributes.hasOwnProperty(key)) {\n            event.attributes[key] = parseFloat(event.attributes[key]);\n          }\n        });\n        ['CAN-SKIP-DATERANGES', 'CAN-BLOCK-RELOAD'].forEach(function (key) {\n          if (event.attributes.hasOwnProperty(key)) {\n            event.attributes[key] = /YES/.test(event.attributes[key]);\n          }\n        });\n        this.trigger('data', event);\n        return;\n      }\n\n      match = /^#EXT-X-PART-INF:(.*)$/.exec(newLine);\n\n      if (match && match[1]) {\n        event = {\n          type: 'tag',\n          tagType: 'part-inf'\n        };\n        event.attributes = parseAttributes(match[1]);\n        ['PART-TARGET'].forEach(function (key) {\n          if (event.attributes.hasOwnProperty(key)) {\n            event.attributes[key] = parseFloat(event.attributes[key]);\n          }\n        });\n        this.trigger('data', event);\n        return;\n      }\n\n      match = /^#EXT-X-PRELOAD-HINT:(.*)$/.exec(newLine);\n\n      if (match && match[1]) {\n        event = {\n          type: 'tag',\n          tagType: 'preload-hint'\n        };\n        event.attributes = parseAttributes(match[1]);\n        ['BYTERANGE-START', 'BYTERANGE-LENGTH'].forEach(function (key) {\n          if (event.attributes.hasOwnProperty(key)) {\n            event.attributes[key] = parseInt(event.attributes[key], 10);\n            const subkey = key === 'BYTERANGE-LENGTH' ? 'length' : 'offset';\n            event.attributes.byterange = event.attributes.byterange || {};\n            event.attributes.byterange[subkey] = event.attributes[key]; // only keep the parsed byterange object.\n\n            delete event.attributes[key];\n          }\n        });\n        this.trigger('data', event);\n        return;\n      }\n\n      match = /^#EXT-X-RENDITION-REPORT:(.*)$/.exec(newLine);\n\n      if (match && match[1]) {\n        event = {\n          type: 'tag',\n          tagType: 'rendition-report'\n        };\n        event.attributes = parseAttributes(match[1]);\n        ['LAST-MSN', 'LAST-PART'].forEach(function (key) {\n          if (event.attributes.hasOwnProperty(key)) {\n            event.attributes[key] = parseInt(event.attributes[key], 10);\n          }\n        });\n        this.trigger('data', event);\n        return;\n      } // unknown tag type\n\n\n      this.trigger('data', {\n        type: 'tag',\n        data: newLine.slice(4)\n      });\n    });\n  }\n  /**\n   * Add a parser for custom headers\n   *\n   * @param {Object}   options              a map of options for the added parser\n   * @param {RegExp}   options.expression   a regular expression to match the custom header\n   * @param {string}   options.customType   the custom type to register to the output\n   * @param {Function} [options.dataParser] function to parse the line into an object\n   * @param {boolean}  [options.segment]    should tag data be attached to the segment object\n   */\n\n\n  addParser({\n    expression,\n    customType,\n    dataParser,\n    segment\n  }) {\n    if (typeof dataParser !== 'function') {\n      dataParser = line => line;\n    }\n\n    this.customParsers.push(line => {\n      const match = expression.exec(line);\n\n      if (match) {\n        this.trigger('data', {\n          type: 'custom',\n          data: dataParser(line),\n          customType,\n          segment\n        });\n        return true;\n      }\n    });\n  }\n  /**\n   * Add a custom header mapper\n   *\n   * @param {Object}   options\n   * @param {RegExp}   options.expression   a regular expression to match the custom header\n   * @param {Function} options.map          function to translate tag into a different tag\n   */\n\n\n  addTagMapper({\n    expression,\n    map\n  }) {\n    const mapFn = line => {\n      if (expression.test(line)) {\n        return map(line);\n      }\n\n      return line;\n    };\n\n    this.tagMappers.push(mapFn);\n  }\n\n}\n\nconst camelCase = str => str.toLowerCase().replace(/-(\\w)/g, a => a[1].toUpperCase());\n\nconst camelCaseKeys = function (attributes) {\n  const result = {};\n  Object.keys(attributes).forEach(function (key) {\n    result[camelCase(key)] = attributes[key];\n  });\n  return result;\n}; // set SERVER-CONTROL hold back based upon targetDuration and partTargetDuration\n// we need this helper because defaults are based upon targetDuration and\n// partTargetDuration being set, but they may not be if SERVER-CONTROL appears before\n// target durations are set.\n\n\nconst setHoldBack = function (manifest) {\n  const {\n    serverControl,\n    targetDuration,\n    partTargetDuration\n  } = manifest;\n\n  if (!serverControl) {\n    return;\n  }\n\n  const tag = '#EXT-X-SERVER-CONTROL';\n  const hb = 'holdBack';\n  const phb = 'partHoldBack';\n  const minTargetDuration = targetDuration && targetDuration * 3;\n  const minPartDuration = partTargetDuration && partTargetDuration * 2;\n\n  if (targetDuration && !serverControl.hasOwnProperty(hb)) {\n    serverControl[hb] = minTargetDuration;\n    this.trigger('info', {\n      message: `${tag} defaulting HOLD-BACK to targetDuration * 3 (${minTargetDuration}).`\n    });\n  }\n\n  if (minTargetDuration && serverControl[hb] < minTargetDuration) {\n    this.trigger('warn', {\n      message: `${tag} clamping HOLD-BACK (${serverControl[hb]}) to targetDuration * 3 (${minTargetDuration})`\n    });\n    serverControl[hb] = minTargetDuration;\n  } // default no part hold back to part target duration * 3\n\n\n  if (partTargetDuration && !serverControl.hasOwnProperty(phb)) {\n    serverControl[phb] = partTargetDuration * 3;\n    this.trigger('info', {\n      message: `${tag} defaulting PART-HOLD-BACK to partTargetDuration * 3 (${serverControl[phb]}).`\n    });\n  } // if part hold back is too small default it to part target duration * 2\n\n\n  if (partTargetDuration && serverControl[phb] < minPartDuration) {\n    this.trigger('warn', {\n      message: `${tag} clamping PART-HOLD-BACK (${serverControl[phb]}) to partTargetDuration * 2 (${minPartDuration}).`\n    });\n    serverControl[phb] = minPartDuration;\n  }\n};\n/**\n * A parser for M3U8 files. The current interpretation of the input is\n * exposed as a property `manifest` on parser objects. It's just two lines to\n * create and parse a manifest once you have the contents available as a string:\n *\n * ```js\n * var parser = new m3u8.Parser();\n * parser.push(xhr.responseText);\n * ```\n *\n * New input can later be applied to update the manifest object by calling\n * `push` again.\n *\n * The parser attempts to create a usable manifest object even if the\n * underlying input is somewhat nonsensical. It emits `info` and `warning`\n * events during the parse if it encounters input that seems invalid or\n * requires some property of the manifest object to be defaulted.\n *\n * @class Parser\n * @extends Stream\n */\n\n\nclass Parser extends _videojs_vhs_utils_es_stream_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\n  constructor() {\n    super();\n    this.lineStream = new LineStream();\n    this.parseStream = new ParseStream();\n    this.lineStream.pipe(this.parseStream);\n    /* eslint-disable consistent-this */\n\n    const self = this;\n    /* eslint-enable consistent-this */\n\n    const uris = [];\n    let currentUri = {}; // if specified, the active EXT-X-MAP definition\n\n    let currentMap; // if specified, the active decryption key\n\n    let key;\n    let hasParts = false;\n\n    const noop = function () {};\n\n    const defaultMediaGroups = {\n      'AUDIO': {},\n      'VIDEO': {},\n      'CLOSED-CAPTIONS': {},\n      'SUBTITLES': {}\n    }; // This is the Widevine UUID from DASH IF IOP. The same exact string is\n    // used in MPDs with Widevine encrypted streams.\n\n    const widevineUuid = 'urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed'; // group segments into numbered timelines delineated by discontinuities\n\n    let currentTimeline = 0; // the manifest is empty until the parse stream begins delivering data\n\n    this.manifest = {\n      allowCache: true,\n      discontinuityStarts: [],\n      segments: []\n    }; // keep track of the last seen segment's byte range end, as segments are not required\n    // to provide the offset, in which case it defaults to the next byte after the\n    // previous segment\n\n    let lastByterangeEnd = 0; // keep track of the last seen part's byte range end.\n\n    let lastPartByterangeEnd = 0;\n    this.on('end', () => {\n      // only add preloadSegment if we don't yet have a uri for it.\n      // and we actually have parts/preloadHints\n      if (currentUri.uri || !currentUri.parts && !currentUri.preloadHints) {\n        return;\n      }\n\n      if (!currentUri.map && currentMap) {\n        currentUri.map = currentMap;\n      }\n\n      if (!currentUri.key && key) {\n        currentUri.key = key;\n      }\n\n      if (!currentUri.timeline && typeof currentTimeline === 'number') {\n        currentUri.timeline = currentTimeline;\n      }\n\n      this.manifest.preloadSegment = currentUri;\n    }); // update the manifest with the m3u8 entry from the parse stream\n\n    this.parseStream.on('data', function (entry) {\n      let mediaGroup;\n      let rendition;\n      ({\n        tag() {\n          // switch based on the tag type\n          (({\n            version() {\n              if (entry.version) {\n                this.manifest.version = entry.version;\n              }\n            },\n\n            'allow-cache'() {\n              this.manifest.allowCache = entry.allowed;\n\n              if (!('allowed' in entry)) {\n                this.trigger('info', {\n                  message: 'defaulting allowCache to YES'\n                });\n                this.manifest.allowCache = true;\n              }\n            },\n\n            byterange() {\n              const byterange = {};\n\n              if ('length' in entry) {\n                currentUri.byterange = byterange;\n                byterange.length = entry.length;\n\n                if (!('offset' in entry)) {\n                  /*\n                   * From the latest spec (as of this writing):\n                   * https://tools.ietf.org/html/draft-pantos-http-live-streaming-23#section-4.3.2.2\n                   *\n                   * Same text since EXT-X-BYTERANGE's introduction in draft 7:\n                   * https://tools.ietf.org/html/draft-pantos-http-live-streaming-07#section-3.3.1)\n                   *\n                   * \"If o [offset] is not present, the sub-range begins at the next byte\n                   * following the sub-range of the previous media segment.\"\n                   */\n                  entry.offset = lastByterangeEnd;\n                }\n              }\n\n              if ('offset' in entry) {\n                currentUri.byterange = byterange;\n                byterange.offset = entry.offset;\n              }\n\n              lastByterangeEnd = byterange.offset + byterange.length;\n            },\n\n            endlist() {\n              this.manifest.endList = true;\n            },\n\n            inf() {\n              if (!('mediaSequence' in this.manifest)) {\n                this.manifest.mediaSequence = 0;\n                this.trigger('info', {\n                  message: 'defaulting media sequence to zero'\n                });\n              }\n\n              if (!('discontinuitySequence' in this.manifest)) {\n                this.manifest.discontinuitySequence = 0;\n                this.trigger('info', {\n                  message: 'defaulting discontinuity sequence to zero'\n                });\n              }\n\n              if (entry.duration > 0) {\n                currentUri.duration = entry.duration;\n              }\n\n              if (entry.duration === 0) {\n                currentUri.duration = 0.01;\n                this.trigger('info', {\n                  message: 'updating zero segment duration to a small value'\n                });\n              }\n\n              this.manifest.segments = uris;\n            },\n\n            key() {\n              if (!entry.attributes) {\n                this.trigger('warn', {\n                  message: 'ignoring key declaration without attribute list'\n                });\n                return;\n              } // clear the active encryption key\n\n\n              if (entry.attributes.METHOD === 'NONE') {\n                key = null;\n                return;\n              }\n\n              if (!entry.attributes.URI) {\n                this.trigger('warn', {\n                  message: 'ignoring key declaration without URI'\n                });\n                return;\n              }\n\n              if (entry.attributes.KEYFORMAT === 'com.apple.streamingkeydelivery') {\n                this.manifest.contentProtection = this.manifest.contentProtection || {}; // TODO: add full support for this.\n\n                this.manifest.contentProtection['com.apple.fps.1_0'] = {\n                  attributes: entry.attributes\n                };\n                return;\n              }\n\n              if (entry.attributes.KEYFORMAT === 'com.microsoft.playready') {\n                this.manifest.contentProtection = this.manifest.contentProtection || {}; // TODO: add full support for this.\n\n                this.manifest.contentProtection['com.microsoft.playready'] = {\n                  uri: entry.attributes.URI\n                };\n                return;\n              } // check if the content is encrypted for Widevine\n              // Widevine/HLS spec: https://storage.googleapis.com/wvdocs/Widevine_DRM_HLS.pdf\n\n\n              if (entry.attributes.KEYFORMAT === widevineUuid) {\n                const VALID_METHODS = ['SAMPLE-AES', 'SAMPLE-AES-CTR', 'SAMPLE-AES-CENC'];\n\n                if (VALID_METHODS.indexOf(entry.attributes.METHOD) === -1) {\n                  this.trigger('warn', {\n                    message: 'invalid key method provided for Widevine'\n                  });\n                  return;\n                }\n\n                if (entry.attributes.METHOD === 'SAMPLE-AES-CENC') {\n                  this.trigger('warn', {\n                    message: 'SAMPLE-AES-CENC is deprecated, please use SAMPLE-AES-CTR instead'\n                  });\n                }\n\n                if (entry.attributes.URI.substring(0, 23) !== 'data:text/plain;base64,') {\n                  this.trigger('warn', {\n                    message: 'invalid key URI provided for Widevine'\n                  });\n                  return;\n                }\n\n                if (!(entry.attributes.KEYID && entry.attributes.KEYID.substring(0, 2) === '0x')) {\n                  this.trigger('warn', {\n                    message: 'invalid key ID provided for Widevine'\n                  });\n                  return;\n                } // if Widevine key attributes are valid, store them as `contentProtection`\n                // on the manifest to emulate Widevine tag structure in a DASH mpd\n\n\n                this.manifest.contentProtection = this.manifest.contentProtection || {};\n                this.manifest.contentProtection['com.widevine.alpha'] = {\n                  attributes: {\n                    schemeIdUri: entry.attributes.KEYFORMAT,\n                    // remove '0x' from the key id string\n                    keyId: entry.attributes.KEYID.substring(2)\n                  },\n                  // decode the base64-encoded PSSH box\n                  pssh: (0,_videojs_vhs_utils_es_decode_b64_to_uint8_array_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(entry.attributes.URI.split(',')[1])\n                };\n                return;\n              }\n\n              if (!entry.attributes.METHOD) {\n                this.trigger('warn', {\n                  message: 'defaulting key method to AES-128'\n                });\n              } // setup an encryption key for upcoming segments\n\n\n              key = {\n                method: entry.attributes.METHOD || 'AES-128',\n                uri: entry.attributes.URI\n              };\n\n              if (typeof entry.attributes.IV !== 'undefined') {\n                key.iv = entry.attributes.IV;\n              }\n            },\n\n            'media-sequence'() {\n              if (!isFinite(entry.number)) {\n                this.trigger('warn', {\n                  message: 'ignoring invalid media sequence: ' + entry.number\n                });\n                return;\n              }\n\n              this.manifest.mediaSequence = entry.number;\n            },\n\n            'discontinuity-sequence'() {\n              if (!isFinite(entry.number)) {\n                this.trigger('warn', {\n                  message: 'ignoring invalid discontinuity sequence: ' + entry.number\n                });\n                return;\n              }\n\n              this.manifest.discontinuitySequence = entry.number;\n              currentTimeline = entry.number;\n            },\n\n            'playlist-type'() {\n              if (!/VOD|EVENT/.test(entry.playlistType)) {\n                this.trigger('warn', {\n                  message: 'ignoring unknown playlist type: ' + entry.playlist\n                });\n                return;\n              }\n\n              this.manifest.playlistType = entry.playlistType;\n            },\n\n            map() {\n              currentMap = {};\n\n              if (entry.uri) {\n                currentMap.uri = entry.uri;\n              }\n\n              if (entry.byterange) {\n                currentMap.byterange = entry.byterange;\n              }\n\n              if (key) {\n                currentMap.key = key;\n              }\n            },\n\n            'stream-inf'() {\n              this.manifest.playlists = uris;\n              this.manifest.mediaGroups = this.manifest.mediaGroups || defaultMediaGroups;\n\n              if (!entry.attributes) {\n                this.trigger('warn', {\n                  message: 'ignoring empty stream-inf attributes'\n                });\n                return;\n              }\n\n              if (!currentUri.attributes) {\n                currentUri.attributes = {};\n              }\n\n              (0,_babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(currentUri.attributes, entry.attributes);\n            },\n\n            media() {\n              this.manifest.mediaGroups = this.manifest.mediaGroups || defaultMediaGroups;\n\n              if (!(entry.attributes && entry.attributes.TYPE && entry.attributes['GROUP-ID'] && entry.attributes.NAME)) {\n                this.trigger('warn', {\n                  message: 'ignoring incomplete or missing media group'\n                });\n                return;\n              } // find the media group, creating defaults as necessary\n\n\n              const mediaGroupType = this.manifest.mediaGroups[entry.attributes.TYPE];\n              mediaGroupType[entry.attributes['GROUP-ID']] = mediaGroupType[entry.attributes['GROUP-ID']] || {};\n              mediaGroup = mediaGroupType[entry.attributes['GROUP-ID']]; // collect the rendition metadata\n\n              rendition = {\n                default: /yes/i.test(entry.attributes.DEFAULT)\n              };\n\n              if (rendition.default) {\n                rendition.autoselect = true;\n              } else {\n                rendition.autoselect = /yes/i.test(entry.attributes.AUTOSELECT);\n              }\n\n              if (entry.attributes.LANGUAGE) {\n                rendition.language = entry.attributes.LANGUAGE;\n              }\n\n              if (entry.attributes.URI) {\n                rendition.uri = entry.attributes.URI;\n              }\n\n              if (entry.attributes['INSTREAM-ID']) {\n                rendition.instreamId = entry.attributes['INSTREAM-ID'];\n              }\n\n              if (entry.attributes.CHARACTERISTICS) {\n                rendition.characteristics = entry.attributes.CHARACTERISTICS;\n              }\n\n              if (entry.attributes.FORCED) {\n                rendition.forced = /yes/i.test(entry.attributes.FORCED);\n              } // insert the new rendition\n\n\n              mediaGroup[entry.attributes.NAME] = rendition;\n            },\n\n            discontinuity() {\n              currentTimeline += 1;\n              currentUri.discontinuity = true;\n              this.manifest.discontinuityStarts.push(uris.length);\n            },\n\n            'program-date-time'() {\n              if (typeof this.manifest.dateTimeString === 'undefined') {\n                // PROGRAM-DATE-TIME is a media-segment tag, but for backwards\n                // compatibility, we add the first occurence of the PROGRAM-DATE-TIME tag\n                // to the manifest object\n                // TODO: Consider removing this in future major version\n                this.manifest.dateTimeString = entry.dateTimeString;\n                this.manifest.dateTimeObject = entry.dateTimeObject;\n              }\n\n              currentUri.dateTimeString = entry.dateTimeString;\n              currentUri.dateTimeObject = entry.dateTimeObject;\n            },\n\n            targetduration() {\n              if (!isFinite(entry.duration) || entry.duration < 0) {\n                this.trigger('warn', {\n                  message: 'ignoring invalid target duration: ' + entry.duration\n                });\n                return;\n              }\n\n              this.manifest.targetDuration = entry.duration;\n              setHoldBack.call(this, this.manifest);\n            },\n\n            start() {\n              if (!entry.attributes || isNaN(entry.attributes['TIME-OFFSET'])) {\n                this.trigger('warn', {\n                  message: 'ignoring start declaration without appropriate attribute list'\n                });\n                return;\n              }\n\n              this.manifest.start = {\n                timeOffset: entry.attributes['TIME-OFFSET'],\n                precise: entry.attributes.PRECISE\n              };\n            },\n\n            'cue-out'() {\n              currentUri.cueOut = entry.data;\n            },\n\n            'cue-out-cont'() {\n              currentUri.cueOutCont = entry.data;\n            },\n\n            'cue-in'() {\n              currentUri.cueIn = entry.data;\n            },\n\n            'skip'() {\n              this.manifest.skip = camelCaseKeys(entry.attributes);\n              this.warnOnMissingAttributes_('#EXT-X-SKIP', entry.attributes, ['SKIPPED-SEGMENTS']);\n            },\n\n            'part'() {\n              hasParts = true; // parts are always specifed before a segment\n\n              const segmentIndex = this.manifest.segments.length;\n              const part = camelCaseKeys(entry.attributes);\n              currentUri.parts = currentUri.parts || [];\n              currentUri.parts.push(part);\n\n              if (part.byterange) {\n                if (!part.byterange.hasOwnProperty('offset')) {\n                  part.byterange.offset = lastPartByterangeEnd;\n                }\n\n                lastPartByterangeEnd = part.byterange.offset + part.byterange.length;\n              }\n\n              const partIndex = currentUri.parts.length - 1;\n              this.warnOnMissingAttributes_(`#EXT-X-PART #${partIndex} for segment #${segmentIndex}`, entry.attributes, ['URI', 'DURATION']);\n\n              if (this.manifest.renditionReports) {\n                this.manifest.renditionReports.forEach((r, i) => {\n                  if (!r.hasOwnProperty('lastPart')) {\n                    this.trigger('warn', {\n                      message: `#EXT-X-RENDITION-REPORT #${i} lacks required attribute(s): LAST-PART`\n                    });\n                  }\n                });\n              }\n            },\n\n            'server-control'() {\n              const attrs = this.manifest.serverControl = camelCaseKeys(entry.attributes);\n\n              if (!attrs.hasOwnProperty('canBlockReload')) {\n                attrs.canBlockReload = false;\n                this.trigger('info', {\n                  message: '#EXT-X-SERVER-CONTROL defaulting CAN-BLOCK-RELOAD to false'\n                });\n              }\n\n              setHoldBack.call(this, this.manifest);\n\n              if (attrs.canSkipDateranges && !attrs.hasOwnProperty('canSkipUntil')) {\n                this.trigger('warn', {\n                  message: '#EXT-X-SERVER-CONTROL lacks required attribute CAN-SKIP-UNTIL which is required when CAN-SKIP-DATERANGES is set'\n                });\n              }\n            },\n\n            'preload-hint'() {\n              // parts are always specifed before a segment\n              const segmentIndex = this.manifest.segments.length;\n              const hint = camelCaseKeys(entry.attributes);\n              const isPart = hint.type && hint.type === 'PART';\n              currentUri.preloadHints = currentUri.preloadHints || [];\n              currentUri.preloadHints.push(hint);\n\n              if (hint.byterange) {\n                if (!hint.byterange.hasOwnProperty('offset')) {\n                  // use last part byterange end or zero if not a part.\n                  hint.byterange.offset = isPart ? lastPartByterangeEnd : 0;\n\n                  if (isPart) {\n                    lastPartByterangeEnd = hint.byterange.offset + hint.byterange.length;\n                  }\n                }\n              }\n\n              const index = currentUri.preloadHints.length - 1;\n              this.warnOnMissingAttributes_(`#EXT-X-PRELOAD-HINT #${index} for segment #${segmentIndex}`, entry.attributes, ['TYPE', 'URI']);\n\n              if (!hint.type) {\n                return;\n              } // search through all preload hints except for the current one for\n              // a duplicate type.\n\n\n              for (let i = 0; i < currentUri.preloadHints.length - 1; i++) {\n                const otherHint = currentUri.preloadHints[i];\n\n                if (!otherHint.type) {\n                  continue;\n                }\n\n                if (otherHint.type === hint.type) {\n                  this.trigger('warn', {\n                    message: `#EXT-X-PRELOAD-HINT #${index} for segment #${segmentIndex} has the same TYPE ${hint.type} as preload hint #${i}`\n                  });\n                }\n              }\n            },\n\n            'rendition-report'() {\n              const report = camelCaseKeys(entry.attributes);\n              this.manifest.renditionReports = this.manifest.renditionReports || [];\n              this.manifest.renditionReports.push(report);\n              const index = this.manifest.renditionReports.length - 1;\n              const required = ['LAST-MSN', 'URI'];\n\n              if (hasParts) {\n                required.push('LAST-PART');\n              }\n\n              this.warnOnMissingAttributes_(`#EXT-X-RENDITION-REPORT #${index}`, entry.attributes, required);\n            },\n\n            'part-inf'() {\n              this.manifest.partInf = camelCaseKeys(entry.attributes);\n              this.warnOnMissingAttributes_('#EXT-X-PART-INF', entry.attributes, ['PART-TARGET']);\n\n              if (this.manifest.partInf.partTarget) {\n                this.manifest.partTargetDuration = this.manifest.partInf.partTarget;\n              }\n\n              setHoldBack.call(this, this.manifest);\n            }\n\n          })[entry.tagType] || noop).call(self);\n        },\n\n        uri() {\n          currentUri.uri = entry.uri;\n          uris.push(currentUri); // if no explicit duration was declared, use the target duration\n\n          if (this.manifest.targetDuration && !('duration' in currentUri)) {\n            this.trigger('warn', {\n              message: 'defaulting segment duration to the target duration'\n            });\n            currentUri.duration = this.manifest.targetDuration;\n          } // annotate with encryption information, if necessary\n\n\n          if (key) {\n            currentUri.key = key;\n          }\n\n          currentUri.timeline = currentTimeline; // annotate with initialization segment information, if necessary\n\n          if (currentMap) {\n            currentUri.map = currentMap;\n          } // reset the last byterange end as it needs to be 0 between parts\n\n\n          lastPartByterangeEnd = 0; // prepare for the next URI\n\n          currentUri = {};\n        },\n\n        comment() {// comments are not important for playback\n        },\n\n        custom() {\n          // if this is segment-level data attach the output to the segment\n          if (entry.segment) {\n            currentUri.custom = currentUri.custom || {};\n            currentUri.custom[entry.customType] = entry.data; // if this is manifest-level data attach to the top level manifest object\n          } else {\n            this.manifest.custom = this.manifest.custom || {};\n            this.manifest.custom[entry.customType] = entry.data;\n          }\n        }\n\n      })[entry.type].call(self);\n    });\n  }\n\n  warnOnMissingAttributes_(identifier, attributes, required) {\n    const missing = [];\n    required.forEach(function (key) {\n      if (!attributes.hasOwnProperty(key)) {\n        missing.push(key);\n      }\n    });\n\n    if (missing.length) {\n      this.trigger('warn', {\n        message: `${identifier} lacks required attribute(s): ${missing.join(', ')}`\n      });\n    }\n  }\n  /**\n   * Parse the input string and update the manifest object.\n   *\n   * @param {string} chunk a potentially incomplete portion of the manifest\n   */\n\n\n  push(chunk) {\n    this.lineStream.push(chunk);\n  }\n  /**\n   * Flush any remaining input. This can be handy if the last line of an M3U8\n   * manifest did not contain a trailing newline but the file has been\n   * completely received.\n   */\n\n\n  end() {\n    // flush any buffered input\n    this.lineStream.push('\\n');\n    this.trigger('end');\n  }\n  /**\n   * Add an additional parser for non-standard tags\n   *\n   * @param {Object}   options              a map of options for the added parser\n   * @param {RegExp}   options.expression   a regular expression to match the custom header\n   * @param {string}   options.type         the type to register to the output\n   * @param {Function} [options.dataParser] function to parse the line into an object\n   * @param {boolean}  [options.segment]    should tag data be attached to the segment object\n   */\n\n\n  addParser(options) {\n    this.parseStream.addParser(options);\n  }\n  /**\n   * Add a custom header mapper\n   *\n   * @param {Object}   options\n   * @param {RegExp}   options.expression   a regular expression to match the custom header\n   * @param {Function} options.map          function to translate tag into a different tag\n   */\n\n\n  addTagMapper(options) {\n    this.parseStream.addTagMapper(options);\n  }\n\n}\n\n\n\n\n/***/ }),\n\n/***/ \"./node_modules/@babel/runtime/helpers/esm/extends.js\":\n/*!************************************************************!*\\\n  !*** ./node_modules/@babel/runtime/helpers/esm/extends.js ***!\n  \\************************************************************/\n/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {\n\n\"use strict\";\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ _extends)\n/* harmony export */ });\nfunction _extends() {\n  _extends = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends.apply(this, arguments);\n}\n\n/***/ })\n\n/******/ \t});\n/************************************************************************/\n/******/ \t// The module cache\n/******/ \tvar __webpack_module_cache__ = {};\n/******/ \t\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/ \t\t// Check if module is in cache\n/******/ \t\tvar cachedModule = __webpack_module_cache__[moduleId];\n/******/ \t\tif (cachedModule !== undefined) {\n/******/ \t\t\treturn cachedModule.exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = __webpack_module_cache__[moduleId] = {\n/******/ \t\t\t// no module.id needed\n/******/ \t\t\t// no module.loaded needed\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/ \t\n/******/ \t\t// Execute the module function\n/******/ \t\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/ \t\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/ \t\n/************************************************************************/\n/******/ \t/* webpack/runtime/compat get default export */\n/******/ \t(() => {\n/******/ \t\t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t\t__webpack_require__.n = (module) => {\n/******/ \t\t\tvar getter = module && module.__esModule ?\n/******/ \t\t\t\t() => (module['default']) :\n/******/ \t\t\t\t() => (module);\n/******/ \t\t\t__webpack_require__.d(getter, { a: getter });\n/******/ \t\t\treturn getter;\n/******/ \t\t};\n/******/ \t})();\n/******/ \t\n/******/ \t/* webpack/runtime/define property getters */\n/******/ \t(() => {\n/******/ \t\t// define getter functions for harmony exports\n/******/ \t\t__webpack_require__.d = (exports, definition) => {\n/******/ \t\t\tfor(var key in definition) {\n/******/ \t\t\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n/******/ \t\t\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n/******/ \t\t\t\t}\n/******/ \t\t\t}\n/******/ \t\t};\n/******/ \t})();\n/******/ \t\n/******/ \t/* webpack/runtime/global */\n/******/ \t(() => {\n/******/ \t\t__webpack_require__.g = (function() {\n/******/ \t\t\tif (typeof globalThis === 'object') return globalThis;\n/******/ \t\t\ttry {\n/******/ \t\t\t\treturn this || new Function('return this')();\n/******/ \t\t\t} catch (e) {\n/******/ \t\t\t\tif (typeof window === 'object') return window;\n/******/ \t\t\t}\n/******/ \t\t})();\n/******/ \t})();\n/******/ \t\n/******/ \t/* webpack/runtime/hasOwnProperty shorthand */\n/******/ \t(() => {\n/******/ \t\t__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))\n/******/ \t})();\n/******/ \t\n/******/ \t/* webpack/runtime/make namespace object */\n/******/ \t(() => {\n/******/ \t\t// define __esModule on exports\n/******/ \t\t__webpack_require__.r = (exports) => {\n/******/ \t\t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n/******/ \t\t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n/******/ \t\t\t}\n/******/ \t\t\tObject.defineProperty(exports, '__esModule', { value: true });\n/******/ \t\t};\n/******/ \t})();\n/******/ \t\n/************************************************************************/\n/******/ \t\n/******/ \t// startup\n/******/ \t// Load entry module and return exports\n/******/ \t// This entry module is referenced by other modules so it can't be inlined\n/******/ \tvar __webpack_exports__ = __webpack_require__(\"./src/app.worker.ts\");\n/******/ \t\n/******/ })()\n;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQSxnQkFBZ0IsMEVBQVE7QUFDeEI7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLHdEQUF3RDs7QUFFeEQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsK0RBQStELEVBQUU7QUFDakU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdFQUF3RTs7QUFFeEU7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFFBQVE7OztBQUdSO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLFVBQVU7QUFDdkIsYUFBYSxVQUFVO0FBQ3ZCLGFBQWEsVUFBVTtBQUN2QixhQUFhLFVBQVU7QUFDdkIsYUFBYSxVQUFVO0FBQ3ZCOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxVQUFVO0FBQ3ZCLGFBQWEsVUFBVTtBQUN2QixhQUFhLFVBQVU7QUFDdkI7OztBQUdBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTs7QUFFSjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsS0FBSyw4Q0FBOEMsa0JBQWtCO0FBQ3ZGLEtBQUs7QUFDTDs7QUFFQTtBQUNBO0FBQ0Esa0JBQWtCLEtBQUssc0JBQXNCLGtCQUFrQiwyQkFBMkIsa0JBQWtCO0FBQzVHLEtBQUs7QUFDTDtBQUNBLElBQUk7OztBQUdKO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixLQUFLLHVEQUF1RCxtQkFBbUI7QUFDakcsS0FBSztBQUNMLElBQUk7OztBQUdKO0FBQ0E7QUFDQSxrQkFBa0IsS0FBSywyQkFBMkIsbUJBQW1CLCtCQUErQixnQkFBZ0I7QUFDcEgsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0EscUJBQXFCLHVFQUFNO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0EseUJBQXlCOztBQUV6QixvQkFBb0I7O0FBRXBCO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQSxpQkFBaUI7QUFDakIsaUJBQWlCO0FBQ2pCLDJCQUEyQjtBQUMzQjtBQUNBLE9BQU87QUFDUDs7QUFFQSwwRUFBMEU7O0FBRTFFLDZCQUE2Qjs7QUFFN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTs7QUFFQSw4QkFBOEI7O0FBRTlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsS0FBSyxHQUFHOztBQUVSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhOztBQUViO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQSxhQUFhOztBQUViO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxhQUFhOztBQUViO0FBQ0E7QUFDQSxhQUFhOztBQUViO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCOztBQUVBO0FBQ0EsYUFBYTs7QUFFYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBLGdCQUFnQjs7O0FBR2hCO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBOztBQUVBO0FBQ0EseUZBQXlGOztBQUV6RjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EseUZBQXlGOztBQUV6RjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQjs7O0FBR0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkI7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkI7O0FBRUEsK0VBQStFO0FBQy9FO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkI7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkI7QUFDQSxrQkFBa0I7QUFDbEI7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQjtBQUNuQjtBQUNBLHdCQUF3Qiw4RkFBcUI7QUFDN0M7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixnQkFBZ0I7OztBQUdoQjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxhQUFhOztBQUViO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7O0FBRUE7QUFDQSxhQUFhOztBQUViO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGFBQWE7O0FBRWI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTs7QUFFQTtBQUNBLGFBQWE7O0FBRWI7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7O0FBRWI7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQSxjQUFjLDBFQUFRO0FBQ3RCLGFBQWE7O0FBRWI7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQSxnQkFBZ0I7OztBQUdoQjtBQUNBO0FBQ0EseUVBQXlFOztBQUV6RTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQjtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsZ0JBQWdCOzs7QUFHaEI7QUFDQSxhQUFhOztBQUViO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTs7QUFFYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGFBQWE7O0FBRWI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsYUFBYTs7QUFFYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTs7QUFFYjtBQUNBO0FBQ0EsYUFBYTs7QUFFYjtBQUNBO0FBQ0EsYUFBYTs7QUFFYjtBQUNBO0FBQ0EsYUFBYTs7QUFFYjtBQUNBO0FBQ0E7QUFDQSxhQUFhOztBQUViO0FBQ0EsK0JBQStCOztBQUUvQjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0EsNERBQTRELFdBQVcsZUFBZSxhQUFhOztBQUVuRztBQUNBO0FBQ0E7QUFDQTtBQUNBLDJEQUEyRCxHQUFHO0FBQzlELHFCQUFxQjtBQUNyQjtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBLGFBQWE7O0FBRWI7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQSxhQUFhOztBQUViO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxvRUFBb0UsT0FBTyxlQUFlLGFBQWE7O0FBRXZHO0FBQ0E7QUFDQSxnQkFBZ0I7QUFDaEI7OztBQUdBLDhCQUE4Qix3Q0FBd0M7QUFDdEU7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxxREFBcUQsT0FBTyxlQUFlLGNBQWMsb0JBQW9CLFdBQVcsbUJBQW1CLEVBQUU7QUFDN0ksbUJBQW1CO0FBQ25CO0FBQ0E7QUFDQSxhQUFhOztBQUViO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUEsd0VBQXdFLE1BQU07QUFDOUUsYUFBYTs7QUFFYjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUEsV0FBVztBQUNYLFNBQVM7O0FBRVQ7QUFDQTtBQUNBLGlDQUFpQzs7QUFFakM7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsWUFBWTs7O0FBR1o7QUFDQTtBQUNBOztBQUVBLGlEQUFpRDs7QUFFakQ7QUFDQTtBQUNBLFlBQVk7OztBQUdaLG9DQUFvQzs7QUFFcEM7QUFDQSxTQUFTOztBQUVULG1CQUFtQjtBQUNuQixTQUFTOztBQUVUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOERBQThEO0FBQzlELFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxPQUFPO0FBQ1AsS0FBSztBQUNMOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBLG9CQUFvQixZQUFZLCtCQUErQixtQkFBbUI7QUFDbEYsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLFFBQVE7QUFDckI7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLFVBQVU7QUFDdkIsYUFBYSxVQUFVO0FBQ3ZCLGFBQWEsVUFBVTtBQUN2QixhQUFhLFVBQVU7QUFDdkIsYUFBYSxVQUFVO0FBQ3ZCOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLFVBQVU7QUFDdkIsYUFBYSxVQUFVO0FBQ3ZCLGFBQWEsVUFBVTtBQUN2Qjs7O0FBR0E7QUFDQTtBQUNBOztBQUVBOztBQUUyQzs7Ozs7Ozs7Ozs7Ozs7OztBQzk5QzVCO0FBQ2Y7QUFDQSxvQkFBb0Isc0JBQXNCO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7OztVQ2JBO1VBQ0E7O1VBRUE7VUFDQTtVQUNBO1VBQ0E7VUFDQTtVQUNBO1VBQ0E7VUFDQTtVQUNBO1VBQ0E7VUFDQTtVQUNBO1VBQ0E7O1VBRUE7VUFDQTs7VUFFQTtVQUNBO1VBQ0E7Ozs7O1dDdEJBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQSxpQ0FBaUMsV0FBVztXQUM1QztXQUNBOzs7OztXQ1BBO1dBQ0E7V0FDQTtXQUNBO1dBQ0EseUNBQXlDLHdDQUF3QztXQUNqRjtXQUNBO1dBQ0E7Ozs7O1dDUEE7V0FDQTtXQUNBO1dBQ0E7V0FDQSxHQUFHO1dBQ0g7V0FDQTtXQUNBLENBQUM7Ozs7O1dDUEQ7Ozs7O1dDQUE7V0FDQTtXQUNBO1dBQ0EsdURBQXVELGlCQUFpQjtXQUN4RTtXQUNBLGdEQUFnRCxhQUFhO1dBQzdEOzs7OztVRU5BO1VBQ0E7VUFDQTtVQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc3JjL2FwcC5jb250cm9sbGVyLnRzIiwid2VicGFjazovLy8uL3NyYy9hcHAud29ya2VyLnRzIiwid2VicGFjazovLy8uL3NyYy9kZWNvcmF0b3IvY29udHJvbGxlci5kZWNvcmF0b3IudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2RlY29yYXRvci9oYW5kbGVyLmRlY29yYXRvci50cyIsIndlYnBhY2s6Ly8vLi9zcmMvbW9kdWxlcy9wbGF5ZXIvcGxheWVyLnRzIiwid2VicGFjazovLy8uL3NyYy9tb2R1bGVzL3N0cmVhbS9pbnRlcmZhY2Uvc3RyZWFtLmVudW0udHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21vZHVsZXMvc3RyZWFtL2ludGVyZmFjZS9zdHJlYW0udHlwZXMudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21vZHVsZXMvc3RyZWFtL3N0cmVhbS50cyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvQHZpZGVvanMvdmhzLXV0aWxzL2VzL2RlY29kZS1iNjQtdG8tdWludDgtYXJyYXkuanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL0B2aWRlb2pzL3Zocy11dGlscy9lcy9zdHJlYW0uanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL2dsb2JhbC93aW5kb3cuanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL20zdTgtcGFyc2VyL2Rpc3QvbTN1OC1wYXJzZXIuZXMuanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2V4dGVuZHMuanMiLCJ3ZWJwYWNrOi8vL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovLy93ZWJwYWNrL3J1bnRpbWUvY29tcGF0IGdldCBkZWZhdWx0IGV4cG9ydCIsIndlYnBhY2s6Ly8vd2VicGFjay9ydW50aW1lL2RlZmluZSBwcm9wZXJ0eSBnZXR0ZXJzIiwid2VicGFjazovLy93ZWJwYWNrL3J1bnRpbWUvZ2xvYmFsIiwid2VicGFjazovLy93ZWJwYWNrL3J1bnRpbWUvaGFzT3duUHJvcGVydHkgc2hvcnRoYW5kIiwid2VicGFjazovLy93ZWJwYWNrL3J1bnRpbWUvbWFrZSBuYW1lc3BhY2Ugb2JqZWN0Iiwid2VicGFjazovLy93ZWJwYWNrL2JlZm9yZS1zdGFydHVwIiwid2VicGFjazovLy93ZWJwYWNrL3N0YXJ0dXAiLCJ3ZWJwYWNrOi8vL3dlYnBhY2svYWZ0ZXItc3RhcnR1cCJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcclxudmFyIF9fZGVjb3JhdGUgPSAodGhpcyAmJiB0aGlzLl9fZGVjb3JhdGUpIHx8IGZ1bmN0aW9uIChkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYykge1xyXG4gICAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLCByID0gYyA8IDMgPyB0YXJnZXQgOiBkZXNjID09PSBudWxsID8gZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIDogZGVzYywgZDtcclxuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5kZWNvcmF0ZSA9PT0gXCJmdW5jdGlvblwiKSByID0gUmVmbGVjdC5kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYyk7XHJcbiAgICBlbHNlIGZvciAodmFyIGkgPSBkZWNvcmF0b3JzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSBpZiAoZCA9IGRlY29yYXRvcnNbaV0pIHIgPSAoYyA8IDMgPyBkKHIpIDogYyA+IDMgPyBkKHRhcmdldCwga2V5LCByKSA6IGQodGFyZ2V0LCBrZXkpKSB8fCByO1xyXG4gICAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjtcclxufTtcclxudmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XHJcbiAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH1cclxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxyXG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcclxuICAgIH0pO1xyXG59O1xyXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XHJcbmV4cG9ydHMuQXBwQ29udHJvbGxlciA9IHZvaWQgMDtcclxuY29uc3QgY29udHJvbGxlcl9kZWNvcmF0b3JfMSA9IHJlcXVpcmUoXCIuL2RlY29yYXRvci9jb250cm9sbGVyLmRlY29yYXRvclwiKTtcclxuY29uc3QgaGFuZGxlcl9kZWNvcmF0b3JfMSA9IHJlcXVpcmUoXCIuL2RlY29yYXRvci9oYW5kbGVyLmRlY29yYXRvclwiKTtcclxubGV0IEFwcENvbnRyb2xsZXIgPSBjbGFzcyBBcHBDb250cm9sbGVyIHtcclxuICAgIGNvbnN0cnVjdG9yKGFwcFNlcnZpY2UpIHtcclxuICAgICAgICB0aGlzLmFwcFNlcnZpY2UgPSBhcHBTZXJ2aWNlO1xyXG4gICAgICAgIHRoaXMuZ2V0U2V0dGluZ3MgPSAoKSA9PiBnbG9iYWwucG9zdE1lc3NhZ2UoeyB0eXBlOiBcImdldFNldHRpbmdzXCIgfSk7XHJcbiAgICAgICAgdGhpcy5nZXRTZXR0aW5ncygpO1xyXG4gICAgfVxyXG4gICAgc2V0SW50ZWdyaXR5KGRhdGEpIHtcclxuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xyXG4gICAgICAgICAgICB0aGlzLmFwcFNlcnZpY2Uuc2V0SW50ZWdyaXR5VG9rZW4oSlNPTi5wYXJzZShkYXRhLnZhbHVlKS50b2tlbik7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBvbkNoYW5uZWwodXJsLCBvcHRpb25zKSB7XHJcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcclxuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSB5aWVsZCBnbG9iYWwucmVxdWVzdCh1cmwsIG9wdGlvbnMpO1xyXG4gICAgICAgICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkVycm9yIG9uIGNoYW5uZWwgbG9hZFwiKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25zdCB0ZXh0ID0geWllbGQgcmVzcG9uc2UudGV4dCgpO1xyXG4gICAgICAgICAgICBjb25zdCBjaGFubmVsTmFtZSA9IC9obHNcXC8oLiopLm0zdTgvZ20uZXhlYyh1cmwpIHx8IFtdO1xyXG4gICAgICAgICAgICB5aWVsZCB0aGlzLmFwcFNlcnZpY2Uuc2V0Q2hhbm5lbChjaGFubmVsTmFtZVsxXSk7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUmVzcG9uc2UodGV4dCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBvbkZldGNoKHVybCwgb3B0aW9ucykge1xyXG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGJvZHkgPSB5aWVsZCAoeWllbGQgcmVxdWVzdCh1cmwsIG9wdGlvbnMpKS50ZXh0KCk7XHJcbiAgICAgICAgICAgIGNvbnN0IHBsYXlsaXN0ID0geWllbGQgdGhpcy5hcHBTZXJ2aWNlLm9uRmV0Y2goYm9keSk7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUmVzcG9uc2UocGxheWxpc3QpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgb25DaGFubmVsUGljdHVyZSh1cmwsIG9wdGlvbnMpIHtcclxuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFJlc3BvbnNlKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBzZXRTZXR0aW5ncyhkYXRhKSB7XHJcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcclxuICAgICAgICAgICAgdGhpcy5hcHBTZXJ2aWNlLnNldFNldHRpbmdzKGRhdGEpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgc2V0UXVhbGl0eShkYXRhKSB7XHJcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcclxuICAgICAgICAgICAgdGhpcy5hcHBTZXJ2aWNlLnF1YWxpdHkgPSBkYXRhLnZhbHVlO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59O1xyXG5fX2RlY29yYXRlKFtcclxuICAgICgwLCBoYW5kbGVyX2RlY29yYXRvcl8xLk1lc3NhZ2UpKFwic2V0SW50ZWdyaXR5XCIpXHJcbl0sIEFwcENvbnRyb2xsZXIucHJvdG90eXBlLCBcInNldEludGVncml0eVwiLCBudWxsKTtcclxuX19kZWNvcmF0ZShbXHJcbiAgICAoMCwgaGFuZGxlcl9kZWNvcmF0b3JfMS5GZXRjaCkoXCJ1c2hlci50dHZudy5uZXQvYXBpL2NoYW5uZWwvaGxzL1wiLCBcInBpY3R1cmUtYnktcGljdHVyZVwiKVxyXG5dLCBBcHBDb250cm9sbGVyLnByb3RvdHlwZSwgXCJvbkNoYW5uZWxcIiwgbnVsbCk7XHJcbl9fZGVjb3JhdGUoW1xyXG4gICAgKDAsIGhhbmRsZXJfZGVjb3JhdG9yXzEuRmV0Y2gpKFwiaGxzLnR0dm53Lm5ldC92MS9wbGF5bGlzdC9cIilcclxuXSwgQXBwQ29udHJvbGxlci5wcm90b3R5cGUsIFwib25GZXRjaFwiLCBudWxsKTtcclxuX19kZWNvcmF0ZShbXHJcbiAgICAoMCwgaGFuZGxlcl9kZWNvcmF0b3JfMS5GZXRjaCkoXCJwaWN0dXJlLWJ5LXBpY3R1cmVcIilcclxuXSwgQXBwQ29udHJvbGxlci5wcm90b3R5cGUsIFwib25DaGFubmVsUGljdHVyZVwiLCBudWxsKTtcclxuX19kZWNvcmF0ZShbXHJcbiAgICAoMCwgaGFuZGxlcl9kZWNvcmF0b3JfMS5NZXNzYWdlKShcInNldFNldHRpbmdzXCIpXHJcbl0sIEFwcENvbnRyb2xsZXIucHJvdG90eXBlLCBcInNldFNldHRpbmdzXCIsIG51bGwpO1xyXG5fX2RlY29yYXRlKFtcclxuICAgICgwLCBoYW5kbGVyX2RlY29yYXRvcl8xLk1lc3NhZ2UpKFwic2V0UXVhbGl0eVwiKVxyXG5dLCBBcHBDb250cm9sbGVyLnByb3RvdHlwZSwgXCJzZXRRdWFsaXR5XCIsIG51bGwpO1xyXG5BcHBDb250cm9sbGVyID0gX19kZWNvcmF0ZShbXHJcbiAgICAoMCwgY29udHJvbGxlcl9kZWNvcmF0b3JfMS5Db250cm9sbGVyKSgpXHJcbl0sIEFwcENvbnRyb2xsZXIpO1xyXG5leHBvcnRzLkFwcENvbnRyb2xsZXIgPSBBcHBDb250cm9sbGVyO1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1kYXRhOmFwcGxpY2F0aW9uL2pzb247YmFzZTY0LGV5SjJaWEp6YVc5dUlqb3pMQ0ptYVd4bElqb2lZWEJ3TG1OdmJuUnliMnhzWlhJdWFuTWlMQ0p6YjNWeVkyVlNiMjkwSWpvaUlpd2ljMjkxY21ObGN5STZXeUl1TGk5emNtTXZZWEJ3TG1OdmJuUnliMnhzWlhJdWRITWlYU3dpYm1GdFpYTWlPbHRkTENKdFlYQndhVzVuY3lJNklqczdPenM3T3pzN096czdPenM3T3pzN08wRkJRVUVzTWtWQlFUaEVPMEZCUXpsRUxIRkZRVUVyUkR0QlFVa3ZSQ3hKUVVGaExHRkJRV0VzUjBGQk1VSXNUVUZCWVN4aFFVRmhPMGxCUjNoQ0xGbEJRVFpDTEZWQlFXdENPMUZCUVd4Q0xHVkJRVlVzUjBGQlZpeFZRVUZWTEVOQlFWRTdVVUZHTDBNc1owSkJRVmNzUjBGQlJ5eEhRVUZITEVWQlFVVXNRMEZCUXl4TlFVRk5MRU5CUVVNc1YwRkJWeXhEUVVGRExFVkJRVVVzU1VGQlNTeEZRVUZGTEdGQlFXRXNSVUZCUlN4RFFVRkRMRU5CUVVNN1VVRkhPVVFzU1VGQlNTeERRVUZETEZkQlFWY3NSVUZCUlN4RFFVRkRPMGxCUTNKQ0xFTkJRVU03U1VGSFN5eFpRVUZaTEVOQlFVTXNTVUZCVXpzN1dVRkRNVUlzU1VGQlNTeERRVUZETEZWQlFWVXNRMEZCUXl4cFFrRkJhVUlzUTBGQlF5eEpRVUZKTEVOQlFVTXNTMEZCU3l4RFFVRkRMRWxCUVVrc1EwRkJReXhMUVVGTExFTkJRVU1zUTBGQlF5eExRVUZMTEVOQlFVTXNRMEZCUXp0UlFVTnNSU3hEUVVGRE8wdEJRVUU3U1VGSFN5eFRRVUZUTEVOQlFVTXNSMEZCVnl4RlFVRkZMRTlCUVZrN08xbEJRM1pETEUxQlFVMHNVVUZCVVN4SFFVRmhMRTFCUVUwc1RVRkJUU3hEUVVGRExFOUJRVThzUTBGQlF5eEhRVUZITEVWQlFVVXNUMEZCVHl4RFFVRkRMRU5CUVVNN1dVRkRPVVFzU1VGQlNTeERRVUZETEZGQlFWRXNRMEZCUXl4RlFVRkZMRVZCUVVVN1owSkJRMmhDTEU5QlFVOHNRMEZCUXl4SFFVRkhMRU5CUVVNc2RVSkJRWFZDTEVOQlFVTXNRMEZCUXp0blFrRkRja01zVDBGQlR5eFJRVUZSTEVOQlFVTTdZVUZEYWtJN1dVRkZSQ3hOUVVGTkxFbEJRVWtzUjBGQlJ5eE5RVUZOTEZGQlFWRXNRMEZCUXl4SlFVRkpMRVZCUVVVc1EwRkJRenRaUVVOdVF5eE5RVUZOTEZkQlFWY3NSMEZCUnl4clFrRkJhMElzUTBGQlF5eEpRVUZKTEVOQlFVTXNSMEZCUnl4RFFVRkRMRWxCUVVrc1JVRkJSU3hEUVVGRE8xbEJSWFpFTEUxQlFVMHNTVUZCU1N4RFFVRkRMRlZCUVZVc1EwRkJReXhWUVVGVkxFTkJRVU1zVjBGQlZ5eERRVUZETEVOQlFVTXNRMEZCUXl4RFFVRkRMRU5CUVVNN1dVRkRha1FzVDBGQlR5eEpRVUZKTEZGQlFWRXNRMEZCUXl4SlFVRkpMRU5CUVVNc1EwRkJRenRSUVVNMVFpeERRVUZETzB0QlFVRTdTVUZIU3l4UFFVRlBMRU5CUVVNc1IwRkJWeXhGUVVGRkxFOUJRVms3TzFsQlEzSkRMRTFCUVUwc1NVRkJTU3hIUVVGWExFMUJRVTBzUTBGQlF5eE5RVUZOTEU5QlFVOHNRMEZCUXl4SFFVRkhMRVZCUVVVc1QwRkJUeXhEUVVGRExFTkJRVU1zUTBGQlF5eEpRVUZKTEVWQlFVVXNRMEZCUXp0WlFVTm9SU3hOUVVGTkxGRkJRVkVzUjBGQlJ5eE5RVUZOTEVsQlFVa3NRMEZCUXl4VlFVRlZMRU5CUVVNc1QwRkJUeXhEUVVGRExFbEJRVWtzUTBGQlF5eERRVUZETzFsQlEzSkVMRTlCUVU4c1NVRkJTU3hSUVVGUkxFTkJRVU1zVVVGQlVTeERRVUZETEVOQlFVTTdVVUZEYUVNc1EwRkJRenRMUVVGQk8wbEJSMHNzWjBKQlFXZENMRU5CUVVNc1IwRkJWeXhGUVVGRkxFOUJRVms3TzFsQlF6bERMRTlCUVU4c1NVRkJTU3hSUVVGUkxFVkJRVVVzUTBGQlF6dFJRVU40UWl4RFFVRkRPMHRCUVVFN1NVRkhTeXhYUVVGWExFTkJRVU1zU1VGQlV6czdXVUZEZWtJc1NVRkJTU3hEUVVGRExGVkJRVlVzUTBGQlF5eFhRVUZYTEVOQlFVTXNTVUZCU1N4RFFVRkRMRU5CUVVNN1VVRkRjRU1zUTBGQlF6dExRVUZCTzBsQlIwc3NWVUZCVlN4RFFVRkRMRWxCUVZNN08xbEJRM2hDTEVsQlFVa3NRMEZCUXl4VlFVRlZMRU5CUVVNc1QwRkJUeXhIUVVGSExFbEJRVWtzUTBGQlF5eExRVUZMTEVOQlFVTTdVVUZEZGtNc1EwRkJRenRMUVVGQk8wTkJRMFlzUTBGQlFUdEJRWGhEUXp0SlFVUkRMRWxCUVVFc01rSkJRVThzUlVGQlF5eGpRVUZqTEVOQlFVTTdhVVJCUjNaQ08wRkJSMFE3U1VGRVF5eEpRVUZCTEhsQ1FVRkxMRVZCUVVNc2EwTkJRV3RETEVWQlFVVXNiMEpCUVc5Q0xFTkJRVU03T0VOQllTOUVPMEZCUjBRN1NVRkVReXhKUVVGQkxIbENRVUZMTEVWQlFVTXNORUpCUVRSQ0xFTkJRVU03TkVOQlMyNURPMEZCUjBRN1NVRkVReXhKUVVGQkxIbENRVUZMTEVWQlFVTXNiMEpCUVc5Q0xFTkJRVU03Y1VSQlJ6TkNPMEZCUjBRN1NVRkVReXhKUVVGQkxESkNRVUZQTEVWQlFVTXNZVUZCWVN4RFFVRkRPMmRFUVVkMFFqdEJRVWRFTzBsQlJFTXNTVUZCUVN3eVFrRkJUeXhGUVVGRExGbEJRVmtzUTBGQlF6c3JRMEZIY2tJN1FVRXZRMVVzWVVGQllUdEpRVVI2UWl4SlFVRkJMR2xEUVVGVkxFZEJRVVU3UjBGRFFTeGhRVUZoTEVOQlowUjZRanRCUVdoRVdTeHpRMEZCWVNKOSIsIlwidXNlIHN0cmljdFwiO1xyXG52YXIgX19hd2FpdGVyID0gKHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcclxuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxyXG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XHJcbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xyXG4gICAgfSk7XHJcbn07XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuY29uc3QgYXBwX2NvbnRyb2xsZXJfMSA9IHJlcXVpcmUoXCIuL2FwcC5jb250cm9sbGVyXCIpO1xyXG5jb25zdCBwbGF5ZXJfMSA9IHJlcXVpcmUoXCIuL21vZHVsZXMvcGxheWVyL3BsYXllclwiKTtcclxuZnVuY3Rpb24gYXBwKCkge1xyXG4gICAgZ2xvYmFsLmxvZ1ByaW50ID0gKHgpID0+IGNvbnNvbGUubG9nKFwiW1B1cnBsZV06IFwiLCB4KTtcclxuICAgIGdsb2JhbC5hcHBDb250cm9sbGVyID0gbmV3IGFwcF9jb250cm9sbGVyXzEuQXBwQ29udHJvbGxlcihuZXcgcGxheWVyXzEuUGxheWVyKCkpO1xyXG4gICAgZ2xvYmFsLmxvZ1ByaW50KFwiU2NyaXB0IHJ1bm5pbmdcIik7XHJcbn1cclxuZXhwb3J0cy5kZWZhdWx0ID0gYXBwO1xyXG5nbG9iYWwucmVxdWVzdCA9IGdsb2JhbC5mZXRjaDtcclxuZ2xvYmFsLmZldGNoID0gKHVybCwgb3B0aW9ucykgPT4gX19hd2FpdGVyKHZvaWQgMCwgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XHJcbiAgICBpZiAodHlwZW9mIHVybCA9PT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSByb3V0ZXJMaXN0Lmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XHJcbiAgICAgICAgICAgIGlmICh1cmwuaW5jbHVkZXMocm91dGVyTGlzdFtpXS5tYXRjaCkgJiYgIXVybC5pbmNsdWRlcyhyb3V0ZXJMaXN0W2ldLmlnbm9yZSkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiBfX2F3YWl0ZXIodm9pZCAwLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHsgcmV0dXJuIHJlc29sdmUoeWllbGQgZ2xvYmFsLmFwcENvbnRyb2xsZXJbcm91dGVyTGlzdFtpXS5wcm9wZXJ0eUtleV0odXJsLCBvcHRpb25zKSk7IH0pKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBnbG9iYWwucmVxdWVzdC5hcHBseSh0aGlzLCBbdXJsLCBvcHRpb25zXSk7XHJcbn0pO1xyXG5nbG9iYWwuYWRkRXZlbnRMaXN0ZW5lcihcIm1lc3NhZ2VcIiwgKGUpID0+IHtcclxuICAgIGdsb2JhbC5tZXNzYWdlTGlzdC5mb3JFYWNoKCh4KSA9PiB7XHJcbiAgICAgICAgaWYgKGUuZGF0YS5mdW5jTmFtZSA9PSB4Lm1hdGNoKVxyXG4gICAgICAgICAgICBnbG9iYWwuYXBwQ29udHJvbGxlclt4LnByb3BlcnR5S2V5XShlLmRhdGEpO1xyXG4gICAgfSk7XHJcbn0pO1xyXG5hcHAoKTtcclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZGF0YTphcHBsaWNhdGlvbi9qc29uO2Jhc2U2NCxleUoyWlhKemFXOXVJam96TENKbWFXeGxJam9pWVhCd0xuZHZjbXRsY2k1cWN5SXNJbk52ZFhKalpWSnZiM1FpT2lJaUxDSnpiM1Z5WTJWeklqcGJJaTR1TDNOeVl5OWhjSEF1ZDI5eWEyVnlMblJ6SWwwc0ltNWhiV1Z6SWpwYlhTd2liV0Z3Y0dsdVozTWlPaUk3T3pzN096czdPenM3TzBGQlFVRXNjVVJCUVdsRU8wRkJRMnBFTEc5RVFVRnBSRHRCUVZWcVJDeFRRVUYzUWl4SFFVRkhPMGxCUTNwQ0xFMUJRVTBzUTBGQlF5eFJRVUZSTEVkQlFVY3NRMEZCUXl4RFFVRk5MRVZCUVVVc1JVRkJSU3hEUVVGRExFOUJRVThzUTBGQlF5eEhRVUZITEVOQlFVTXNXVUZCV1N4RlFVRkZMRU5CUVVNc1EwRkJReXhEUVVGRE8wbEJRek5FTEUxQlFVMHNRMEZCUXl4aFFVRmhMRWRCUVVjc1NVRkJTU3c0UWtGQllTeERRVUZETEVsQlFVa3NaVUZCVFN4RlFVRkZMRU5CUVVNc1EwRkJRenRKUVVWMlJDeE5RVUZOTEVOQlFVTXNVVUZCVVN4RFFVRkRMR2RDUVVGblFpeERRVUZETEVOQlFVTTdRVUZEY0VNc1EwRkJRenRCUVV4RUxITkNRVXRETzBGQlJVUXNUVUZCVFN4RFFVRkRMRTlCUVU4c1IwRkJSeXhOUVVGTkxFTkJRVU1zUzBGQlN5eERRVUZETzBGQlF6bENMRTFCUVUwc1EwRkJReXhMUVVGTExFZEJRVWNzUTBGQlR5eEhRVUZSTEVWQlFVVXNUMEZCV1N4RlFVRkZMRVZCUVVVN1NVRkRPVU1zU1VGQlNTeFBRVUZQTEVkQlFVY3NTMEZCU3l4UlFVRlJMRVZCUVVVN1VVRkRNMElzUzBGQlN5eEpRVUZKTEVOQlFVTXNSMEZCUnl4RFFVRkRMRVZCUVVVc1IwRkJSeXhIUVVGSExGVkJRVlVzUTBGQlF5eE5RVUZOTEVWQlFVVXNRMEZCUXl4SFFVRkhMRWRCUVVjc1JVRkJSU3hEUVVGRExFVkJRVVVzUlVGQlJUdFpRVU55UkN4SlFVRkpMRWRCUVVjc1EwRkJReXhSUVVGUkxFTkJRVU1zVlVGQlZTeERRVUZETEVOQlFVTXNRMEZCUXl4RFFVRkRMRXRCUVVzc1EwRkJReXhKUVVGSkxFTkJRVU1zUjBGQlJ5eERRVUZETEZGQlFWRXNRMEZCUXl4VlFVRlZMRU5CUVVNc1EwRkJReXhEUVVGRExFTkJRVU1zVFVGQlR5eERRVUZETEVWQlFVVTdaMEpCUXpkRkxFOUJRVThzU1VGQlNTeFBRVUZQTEVOQlFVTXNRMEZCVHl4UFFVRlBMRVZCUVVVc1RVRkJUU3hGUVVGRkxFVkJRVVVzYTBSQlFVTXNUMEZCUVN4UFFVRlBMRU5CUVVNc1RVRkJUU3hOUVVGTkxFTkJRVU1zWVVGQllTeERRVUZETEZWQlFWVXNRMEZCUXl4RFFVRkRMRU5CUVVNc1EwRkJReXhYUVVGWExFTkJRVU1zUTBGQlF5eEhRVUZITEVWQlFVVXNUMEZCVHl4RFFVRkRMRU5CUVVNc1EwRkJRU3hIUVVGQkxFTkJRVU1zUTBGQlF6dGhRVU0zU0R0VFFVTkdPMHRCUTBZN1NVRkRSQ3hQUVVGUExFMUJRVTBzUTBGQlF5eFBRVUZQTEVOQlFVTXNTMEZCU3l4RFFVRkRMRWxCUVVrc1JVRkJSU3hEUVVGRExFZEJRVWNzUlVGQlJTeFBRVUZQTEVOQlFVTXNRMEZCUXl4RFFVRkRPMEZCUTNCRUxFTkJRVU1zUTBGQlFTeERRVUZETzBGQlJVWXNUVUZCVFN4RFFVRkRMR2RDUVVGblFpeERRVUZETEZOQlFWTXNSVUZCUlN4RFFVRkRMRU5CUVUwc1JVRkJSU3hGUVVGRk8wbEJRelZETEUxQlFVMHNRMEZCUXl4WFFVRlhMRU5CUVVNc1QwRkJUeXhEUVVGRExFTkJRVU1zUTBGQlF5eEZRVUZGTEVWQlFVVTdVVUZETDBJc1NVRkJTU3hEUVVGRExFTkJRVU1zU1VGQlNTeERRVUZETEZGQlFWRXNTVUZCU1N4RFFVRkRMRU5CUVVNc1MwRkJTenRaUVVGRkxFMUJRVTBzUTBGQlF5eGhRVUZoTEVOQlFVTXNRMEZCUXl4RFFVRkRMRmRCUVZjc1EwRkJReXhEUVVGRExFTkJRVU1zUTBGQlF5eEpRVUZKTEVOQlFVTXNRMEZCUXp0SlFVTTVSU3hEUVVGRExFTkJRVU1zUTBGQlF6dEJRVU5NTEVOQlFVTXNRMEZCUXl4RFFVRkRPMEZCUlVnc1IwRkJSeXhGUVVGRkxFTkJRVU1pZlE9PSIsIlwidXNlIHN0cmljdFwiO1xyXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XHJcbmV4cG9ydHMuQ29udHJvbGxlciA9IHZvaWQgMDtcclxuY29uc3QgQ29udHJvbGxlciA9ICgpID0+IHtcclxuICAgIHJldHVybiAodGFyZ2V0KSA9PiB7IH07XHJcbn07XHJcbmV4cG9ydHMuQ29udHJvbGxlciA9IENvbnRyb2xsZXI7XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWRhdGE6YXBwbGljYXRpb24vanNvbjtiYXNlNjQsZXlKMlpYSnphVzl1SWpvekxDSm1hV3hsSWpvaVkyOXVkSEp2Ykd4bGNpNWtaV052Y21GMGIzSXVhbk1pTENKemIzVnlZMlZTYjI5MElqb2lJaXdpYzI5MWNtTmxjeUk2V3lJdUxpOHVMaTl6Y21NdlpHVmpiM0poZEc5eUwyTnZiblJ5YjJ4c1pYSXVaR1ZqYjNKaGRHOXlMblJ6SWwwc0ltNWhiV1Z6SWpwYlhTd2liV0Z3Y0dsdVozTWlPaUk3T3p0QlFVRlBMRTFCUVUwc1ZVRkJWU3hIUVVGSExFZEJRVzFDTEVWQlFVVTdTVUZETjBNc1QwRkJUeXhEUVVGRExFMUJRVTBzUlVGQlJTeEZRVUZGTEVkQlFVVXNRMEZCUXl4RFFVRkRPMEZCUTNoQ0xFTkJRVU1zUTBGQlF6dEJRVVpYTEZGQlFVRXNWVUZCVlN4alFVVnlRaUo5IiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuZXhwb3J0cy5NZXNzYWdlID0gZXhwb3J0cy5GZXRjaCA9IHZvaWQgMDtcclxuY29uc3QgRmV0Y2ggPSAobWF0Y2gsIGlnbm9yZSA9IG51bGwpID0+IHtcclxuICAgIHJldHVybiAodGFyZ2V0LCBwcm9wZXJ0eUtleSkgPT4ge1xyXG4gICAgICAgIGlmICghZ2xvYmFsLnJvdXRlckxpc3QpXHJcbiAgICAgICAgICAgIGdsb2JhbC5yb3V0ZXJMaXN0ID0gW107XHJcbiAgICAgICAgZ2xvYmFsLnJvdXRlckxpc3QucHVzaCh7IHByb3BlcnR5S2V5OiBwcm9wZXJ0eUtleSwgbWF0Y2g6IG1hdGNoLCBpZ25vcmU6IGlnbm9yZSB9KTtcclxuICAgIH07XHJcbn07XHJcbmV4cG9ydHMuRmV0Y2ggPSBGZXRjaDtcclxuY29uc3QgTWVzc2FnZSA9IChtYXRjaCkgPT4ge1xyXG4gICAgcmV0dXJuICh0YXJnZXQsIHByb3BlcnR5S2V5KSA9PiB7XHJcbiAgICAgICAgaWYgKCFnbG9iYWwubWVzc2FnZUxpc3QpXHJcbiAgICAgICAgICAgIGdsb2JhbC5tZXNzYWdlTGlzdCA9IFtdO1xyXG4gICAgICAgIGdsb2JhbC5tZXNzYWdlTGlzdC5wdXNoKHsgcHJvcGVydHlLZXk6IHByb3BlcnR5S2V5LCBtYXRjaDogbWF0Y2ggfSk7XHJcbiAgICB9O1xyXG59O1xyXG5leHBvcnRzLk1lc3NhZ2UgPSBNZXNzYWdlO1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1kYXRhOmFwcGxpY2F0aW9uL2pzb247YmFzZTY0LGV5SjJaWEp6YVc5dUlqb3pMQ0ptYVd4bElqb2lhR0Z1Wkd4bGNpNWtaV052Y21GMGIzSXVhbk1pTENKemIzVnlZMlZTYjI5MElqb2lJaXdpYzI5MWNtTmxjeUk2V3lJdUxpOHVMaTl6Y21NdlpHVmpiM0poZEc5eUwyaGhibVJzWlhJdVpHVmpiM0poZEc5eUxuUnpJbDBzSW01aGJXVnpJanBiWFN3aWJXRndjR2x1WjNNaU9pSTdPenRCUVVGUExFMUJRVTBzUzBGQlN5eEhRVUZITEVOQlFVTXNTMEZCWVN4RlFVRkZMRk5CUVhkQ0xFbEJRVWtzUlVGQmJVSXNSVUZCUlR0SlFVTndSaXhQUVVGUExFTkJRVU1zVFVGQlRTeEZRVUZGTEZkQlFWY3NSVUZCUlN4RlFVRkZPMUZCUXpkQ0xFbEJRVWtzUTBGQlF5eE5RVUZOTEVOQlFVTXNWVUZCVlR0WlFVRkZMRTFCUVUwc1EwRkJReXhWUVVGVkxFZEJRVWNzUlVGQlJTeERRVUZETzFGQlF5OURMRTFCUVUwc1EwRkJReXhWUVVGVkxFTkJRVU1zU1VGQlNTeERRVUZETEVWQlFVVXNWMEZCVnl4RlFVRkZMRmRCUVhGQ0xFVkJRVVVzUzBGQlN5eEZRVUZGTEV0QlFVc3NSVUZCUlN4TlFVRk5MRVZCUVVVc1RVRkJUU3hGUVVGRkxFTkJRVU1zUTBGQlF6dEpRVU12Uml4RFFVRkRMRU5CUVVNN1FVRkRTaXhEUVVGRExFTkJRVU03UVVGTVZ5eFJRVUZCTEV0QlFVc3NVMEZMYUVJN1FVRkZTeXhOUVVGTkxFOUJRVThzUjBGQlJ5eERRVUZETEV0QlFXRXNSVUZCYlVJc1JVRkJSVHRKUVVONFJDeFBRVUZQTEVOQlFVTXNUVUZCVFN4RlFVRkZMRmRCUVZjc1JVRkJSU3hGUVVGRk8xRkJRemRDTEVsQlFVa3NRMEZCUXl4TlFVRk5MRU5CUVVNc1YwRkJWenRaUVVGRkxFMUJRVTBzUTBGQlF5eFhRVUZYTEVkQlFVY3NSVUZCUlN4RFFVRkRPMUZCUTJwRUxFMUJRVTBzUTBGQlF5eFhRVUZYTEVOQlFVTXNTVUZCU1N4RFFVRkRMRVZCUVVVc1YwRkJWeXhGUVVGRkxGZEJRWEZDTEVWQlFVVXNTMEZCU3l4RlFVRkZMRXRCUVVzc1JVRkJSU3hEUVVGRExFTkJRVU03U1VGRGFFWXNRMEZCUXl4RFFVRkRPMEZCUTBvc1EwRkJReXhEUVVGRE8wRkJURmNzVVVGQlFTeFBRVUZQTEZkQlMyeENJbjA9IiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbnZhciBfX2F3YWl0ZXIgPSAodGhpcyAmJiB0aGlzLl9fYXdhaXRlcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xyXG4gICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9XHJcbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cclxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XHJcbiAgICB9KTtcclxufTtcclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG5leHBvcnRzLlBsYXllciA9IHZvaWQgMDtcclxuY29uc3Qgc3RyZWFtXzEgPSByZXF1aXJlKFwiLi4vc3RyZWFtL3N0cmVhbVwiKTtcclxuY29uc3Qgc3RyZWFtX2VudW1fMSA9IHJlcXVpcmUoXCIuLi9zdHJlYW0vaW50ZXJmYWNlL3N0cmVhbS5lbnVtXCIpO1xyXG5jb25zdCBtM3U4X3BhcnNlcl8xID0gcmVxdWlyZShcIm0zdTgtcGFyc2VyXCIpO1xyXG5jbGFzcyBQbGF5ZXIge1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgdGhpcy5pbnRlZ3JpdHlUb2tlbiA9IFwiXCI7IC8vdGhlIGludGVncml0eSB0b2tlblxyXG4gICAgICAgIHRoaXMuc3RyZWFtTGlzdCA9IFtdOyAvL3RoZSBsaXN0IG9mIHN0cmVhbXMgdGhhdCBhcmUgY3VycmVudGx5IGJlaW5nIHBsYXllZFxyXG4gICAgICAgIHRoaXMuYWN0dWFsQ2hhbm5lbCA9IFwiXCI7IC8vdGhlIGNoYW5uZWxcclxuICAgICAgICB0aGlzLnBsYXlpbmdBZHMgPSBmYWxzZTsgLy9pZiB0aGUgc3RyZWFtIGlzIHBsYXlpbmcgYWRzXHJcbiAgICAgICAgdGhpcy5xdWFsaXR5ID0gXCJcIjsgLy90aGUgcXVhbGl0eSBvZiB0aGUgc3RyZWFtXHJcbiAgICAgICAgdGhpcy5nZXRRdWFsaXR5ID0gKCkgPT4gZ2xvYmFsLnBvc3RNZXNzYWdlKHsgdHlwZTogXCJnZXRRdWFsaXR5XCIgfSk7XHJcbiAgICAgICAgdGhpcy5nZXRTZXR0aW5ncyA9ICgpID0+IGdsb2JhbC5wb3N0TWVzc2FnZSh7IHR5cGU6IFwiZ2V0U2V0dGluZ3NcIiB9KTtcclxuICAgICAgICB0aGlzLnBhdXNlID0gKCkgPT4gZ2xvYmFsLnBvc3RNZXNzYWdlKHsgdHlwZTogXCJwYXVzZVwiIH0pO1xyXG4gICAgICAgIHRoaXMucGxheSA9ICgpID0+IGdsb2JhbC5wb3N0TWVzc2FnZSh7IHR5cGU6IFwicGxheVwiIH0pO1xyXG4gICAgICAgIHRoaXMuc2V0U2V0dGluZ3MgPSAoc2V0dGluZykgPT4ge1xyXG4gICAgICAgICAgICB2YXIgX2EsIF9iLCBfYywgX2QsIF9lO1xyXG4gICAgICAgICAgICB0aGlzLnNldHRpbmcgPSBzZXR0aW5nO1xyXG4gICAgICAgICAgICBpZiAoKChfYSA9IHRoaXMuc2V0dGluZykgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnRvZ2dsZVByb3h5KSAmJiAoKF9iID0gdGhpcy5zZXR0aW5nKSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2IucHJveHlVcmwpKVxyXG4gICAgICAgICAgICAgICAgKF9kID0gKF9jID0gdGhpcy5jdXJyZW50U3RyZWFtKCkpID09PSBudWxsIHx8IF9jID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYy50dW5uZWxMaXN0KSA9PT0gbnVsbCB8fCBfZCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2QucHVzaCgoX2UgPSB0aGlzLnNldHRpbmcpID09PSBudWxsIHx8IF9lID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfZS5wcm94eVVybCk7XHJcbiAgICAgICAgICAgIGxvZ1ByaW50KFwiU2V0dGluZ3MgbG9hZGVkXCIpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5zZXRJbnRlZ3JpdHlUb2tlbiA9IChpbnRlZ3JpdHlUb2tlbikgPT4gdGhpcy5pbnRlZ3JpdHlUb2tlbiA9IGludGVncml0eVRva2VuO1xyXG4gICAgICAgIHRoaXMucGF1c2VBbmRQbGF5ID0gKCkgPT4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xyXG4gICAgICAgICAgICB0aGlzLnBhdXNlKCk7XHJcbiAgICAgICAgICAgIHlpZWxkIG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCAxMDAwKSk7XHJcbiAgICAgICAgICAgIHRoaXMucGxheSgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMub25TdGFydEFkcyA9ICgpID0+IHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJhZHMgc3RhcnRlZFwiKTtcclxuICAgICAgICAgICAgdGhpcy5wYXVzZUFuZFBsYXkoKTtcclxuICAgICAgICAgICAgdGhpcy5wYXVzZUFuZFBsYXkoKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMub25FbmRBZHMgPSAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiYWRzIGVuZGVkXCIpO1xyXG4gICAgICAgICAgICB0aGlzLnBhdXNlQW5kUGxheSgpO1xyXG4gICAgICAgICAgICB0aGlzLnBhdXNlQW5kUGxheSgpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5pc0FkcyA9ICh4LCBhbGxvd0NoYW5nZSA9IGZhbHNlKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGFkcyA9IHRoaXMuaGFzQWRzKHgpO1xyXG4gICAgICAgICAgICBpZiAoIWFsbG93Q2hhbmdlKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGFkcztcclxuICAgICAgICAgICAgaWYgKHRoaXMucGxheWluZ0FkcyA9PSBmYWxzZSAmJiB0aGlzLnBsYXlpbmdBZHMgIT0gYWRzKVxyXG4gICAgICAgICAgICAgICAgdGhpcy5vblN0YXJ0QWRzKCk7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnBsYXlpbmdBZHMgPT0gdHJ1ZSAmJiB0aGlzLnBsYXlpbmdBZHMgIT0gYWRzKVxyXG4gICAgICAgICAgICAgICAgdGhpcy5vbkVuZEFkcygpO1xyXG4gICAgICAgICAgICB0aGlzLnBsYXlpbmdBZHMgPSBhZHM7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnBsYXlpbmdBZHM7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmhhc0FkcyA9ICh4KSA9PiAoeCA9PT0gbnVsbCB8fCB4ID09PSB2b2lkIDAgPyB2b2lkIDAgOiB4LnRvU3RyaW5nKCkuaW5jbHVkZXMoXCJzdGl0Y2hlZFwiKSkgfHwgKHggPT09IG51bGwgfHwgeCA9PT0gdm9pZCAwID8gdm9pZCAwIDogeC50b1N0cmluZygpLmluY2x1ZGVzKFwiQW1hem9uXCIpKSB8fCAoeCA9PT0gbnVsbCB8fCB4ID09PSB2b2lkIDAgPyB2b2lkIDAgOiB4LnRvU3RyaW5nKCkuaW5jbHVkZXMoXCJEQ01cIikpO1xyXG4gICAgICAgIHRoaXMuY3VycmVudFN0cmVhbSA9IChjaGFubmVsID0gdGhpcy5hY3R1YWxDaGFubmVsKSA9PiB7XHJcbiAgICAgICAgICAgIHZhciBfYTtcclxuICAgICAgICAgICAgcmV0dXJuIChfYSA9IHRoaXMuc3RyZWFtTGlzdCkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmZpbmQoKHgpID0+IHguY2hhbm5lbE5hbWUgPT09IGNoYW5uZWwpO1xyXG4gICAgICAgIH07XHJcbiAgICB9XHJcbiAgICBpc1doaXRlbGlzdCgpIHtcclxuICAgICAgICB2YXIgX2EsIF9iO1xyXG4gICAgICAgIHJldHVybiAoKF9iID0gKF9hID0gdGhpcy5zZXR0aW5nKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Eud2hpdGVsaXN0KSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2IuaW5jbHVkZXModGhpcy5hY3R1YWxDaGFubmVsKSkgfHwgZmFsc2U7XHJcbiAgICB9XHJcbiAgICBvbkZldGNoKHRleHQpIHtcclxuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5pc1doaXRlbGlzdCgpKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRleHQ7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5pc0Fkcyh0ZXh0LCB0cnVlKSlcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLm1lcmdlTTN1OENvbnRlbnRzKFt0ZXh0XSk7XHJcbiAgICAgICAgICAgIGxldCBkdW1wID0gW107XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFN0cmVhbSgpLmNyZWF0ZVN0cmVhbUFjY2VzcyhzdHJlYW1fZW51bV8xLlN0cmVhbVR5cGUuRlJPTlRQQUdFLCB0aGlzLmludGVncml0eVRva2VuKTtcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50U3RyZWFtKCkuY3JlYXRlU3RyZWFtQWNjZXNzKHN0cmVhbV9lbnVtXzEuU3RyZWFtVHlwZS5QSUNUVVJFLCB0aGlzLmludGVncml0eVRva2VuKTtcclxuICAgICAgICAgICAgY29uc3QgZnJvbnRwYWdlID0geWllbGQgdGhpcy5mZXRjaG0zdThCeVN0cmVhbVR5cGUoc3RyZWFtX2VudW1fMS5TdHJlYW1UeXBlLkZST05UUEFHRSk7XHJcbiAgICAgICAgICAgIC8vIGlmIChmcm9udHBhZ2UuZGF0YSkgcmV0dXJuIHRoaXMubWVyZ2VNM3U4Q29udGVudHMoW2Zyb250cGFnZS5kYXRhLCAuLi5kdW1wXSk7XHJcbiAgICAgICAgICAgIGR1bXAgPSBkdW1wLmNvbmNhdChmcm9udHBhZ2UuZHVtcCk7XHJcbiAgICAgICAgICAgIGNvbnN0IHBpY3R1cmUgPSB5aWVsZCB0aGlzLmZldGNobTN1OEJ5U3RyZWFtVHlwZShzdHJlYW1fZW51bV8xLlN0cmVhbVR5cGUuUElDVFVSRSk7XHJcbiAgICAgICAgICAgIC8vIGlmIChleHRlcm5hbC5kYXRhKSByZXR1cm4gdGhpcy5tZXJnZU0zdThDb250ZW50cyhbZXh0ZXJuYWwuZGF0YSwgLi4uZHVtcF0pO1xyXG4gICAgICAgICAgICBkdW1wID0gZHVtcC5jb25jYXQocGljdHVyZS5kdW1wKTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJBbGwgc3RyZWFtIHR5cGVzIGZhaWxlZFwiKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMubWVyZ2VNM3U4Q29udGVudHMoW3RleHQsIC4uLmR1bXBdKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIGdlbmVyYXRlTTN1OChtYW5pZmVzdCkge1xyXG4gICAgICAgIGxldCBtM3U4Q29udGVudCA9IGAjRVhUTTNVXFxuYDtcclxuICAgICAgICBpZiAobWFuaWZlc3QudGFyZ2V0RHVyYXRpb24pIHtcclxuICAgICAgICAgICAgbTN1OENvbnRlbnQgKz0gYCNFWFQtWC1UQVJHRVREVVJBVElPTjoke21hbmlmZXN0LnRhcmdldER1cmF0aW9ufVxcbmA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChtYW5pZmVzdC5tZWRpYVNlcXVlbmNlKSB7XHJcbiAgICAgICAgICAgIG0zdThDb250ZW50ICs9IGAjRVhULVgtTUVESUEtU0VRVUVOQ0U6JHttYW5pZmVzdC5tZWRpYVNlcXVlbmNlfVxcbmA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChtYW5pZmVzdC5zZWdtZW50cykge1xyXG4gICAgICAgICAgICBtYW5pZmVzdC5zZWdtZW50cy5mb3JFYWNoKChzZWdtZW50KSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoc2VnbWVudC5kdXJhdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIG0zdThDb250ZW50ICs9IGAjRVhUSU5GOiR7c2VnbWVudC5kdXJhdGlvbn1gO1xyXG4gICAgICAgICAgICAgICAgICAgIG0zdThDb250ZW50ICs9IGBcXG5gO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgbTN1OENvbnRlbnQgKz0gYCR7c2VnbWVudC51cml9XFxuYDtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBtM3U4Q29udGVudDtcclxuICAgIH1cclxuICAgIG1lcmdlTTN1OENvbnRlbnRzKGNvbnRldWRvc00zdTgpIHtcclxuICAgICAgICBjb25zdCBtYW5pZmVzdG9zID0gY29udGV1ZG9zTTN1OC5tYXAoKGNvbnRldWRvKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGFuYWxpc2Fkb3IgPSBuZXcgbTN1OF9wYXJzZXJfMS5QYXJzZXIoKTtcclxuICAgICAgICAgICAgYW5hbGlzYWRvci5wdXNoKGNvbnRldWRvKTtcclxuICAgICAgICAgICAgYW5hbGlzYWRvci5lbmQoKTtcclxuICAgICAgICAgICAgLy8gZXh0cmFjdCB0aXRsZXMgZnJvbSAjRVhUSU5GIHRhZ3MgaW4gZWFjaCBzZWdtZW50XHJcbiAgICAgICAgICAgIGNvbnN0IG1hbmlmZXN0ID0gYW5hbGlzYWRvci5tYW5pZmVzdDtcclxuICAgICAgICAgICAgaWYgKG1hbmlmZXN0LnNlZ21lbnRzKSB7XHJcbiAgICAgICAgICAgICAgICBtYW5pZmVzdC5zZWdtZW50cy5mb3JFYWNoKChzZWdtZW50KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gRmluZCB0aGUgI0VYVElORiB0YWcgYXNzb2NpYXRlZCB3aXRoIHRoZSBjdXJyZW50IHNlZ21lbnRcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBleHRpbmZUYWdSZWdleCA9IG5ldyBSZWdFeHAoYCNFWFRJTkY6KFswLTkuXSopPyw/KC4qKSg/OlxcbnxcXHJcXG4pJHtzZWdtZW50LnVyaX1gKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBtYXRjaCA9IGNvbnRldWRvLm1hdGNoKGV4dGluZlRhZ1JlZ2V4KTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobWF0Y2gpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VnbWVudC50aXRsZSA9IG1hdGNoWzJdID8gbWF0Y2hbMl0udHJpbSgpIDogXCJcIjtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gbWFuaWZlc3Q7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY29uc3QgbWFuaWZlc3RvUHJpbmNpcGFsID0gbWFuaWZlc3Rvc1swXTtcclxuICAgICAgICBjb25zdCBtYW5pZmVzdG9zU3Vwb3J0ZSA9IG1hbmlmZXN0b3Muc2xpY2UoMSk7XHJcbiAgICAgICAgaWYgKG1hbmlmZXN0b1ByaW5jaXBhbC5zZWdtZW50cykge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIlNlZ21lbnRvcyBlbmNvbnRyYWRvcyBubyBtYW5pZmVzdG8gcHJpbmNpcGFsOlwiLCBtYW5pZmVzdG9QcmluY2lwYWwuc2VnbWVudHMubGVuZ3RoKTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJNYW5pZmVzdG9zIGRlIHN1cG9ydGUgZW5jb250cmFkb3M6XCIsIG1hbmlmZXN0b3NTdXBvcnRlLmxlbmd0aCk7XHJcbiAgICAgICAgICAgIGxldCBzZWdtZW50UmVtb3ZlZCA9IDA7XHJcbiAgICAgICAgICAgIC8vIFBlcmNvcnJlciBvcyBzZWdtZW50b3MgZG8gbWFuaWZlc3RvIHByaW5jaXBhbCBlIHByZWVuY2hlciBhcyBsYWN1bmFzIGNvbSBvcyBzZWdtZW50b3MgZG8gbWFuaWZlc3RvIGRlIHN1cG9ydGVcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBtYW5pZmVzdG9QcmluY2lwYWwuc2VnbWVudHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHNlZ21lbnRvUHJpbmNpcGFsID0gbWFuaWZlc3RvUHJpbmNpcGFsLnNlZ21lbnRzW2ldO1xyXG4gICAgICAgICAgICAgICAgbGV0IGlzQ2hhbmdlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaGFzQWRzKHNlZ21lbnRvUHJpbmNpcGFsLnRpdGxlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIG1hbmlmZXN0b3NTdXBvcnRlLmZvckVhY2goKG1hbmlmZXN0b1N1cG9ydGUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9hO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBFbmNvbnRyZSBvIHByaW1laXJvIHNlZ21lbnRvIGRlIHN1cG9ydGUgcXVlIE7Dg08gY29udGVuaGEgbyB0w610dWxvIFwiQW1hem9uXCIgZSB0ZW5oYSB1bSB0ZW1wbyBzZW1lbGhhbnRlIGFvIHNlZ21lbnRvUHJpbmNpcGFsIChpZ25vcmFuZG8gbWlsaXNzZWd1bmRvcylcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VnbWVudG9TdXBvcnRlID0gKF9hID0gbWFuaWZlc3RvU3Vwb3J0ZSA9PT0gbnVsbCB8fCBtYW5pZmVzdG9TdXBvcnRlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBtYW5pZmVzdG9TdXBvcnRlLnNlZ21lbnRzKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuZmluZCgoc2VnKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5oYXNBZHMoc2VnLnRpdGxlKSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBkYXRhUHJpbmNpcGFsID0gbmV3IERhdGUoc2VnbWVudG9QcmluY2lwYWwuZGF0ZVRpbWVTdHJpbmcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZGF0YVN1cG9ydGUgPSBuZXcgRGF0ZShzZWcuZGF0ZVRpbWVTdHJpbmcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVByaW5jaXBhbC5zZXRNaWxsaXNlY29uZHMoMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhU3Vwb3J0ZS5zZXRNaWxsaXNlY29uZHMoMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGF0YVByaW5jaXBhbC5nZXRUaW1lKCkgPT09IGRhdGFTdXBvcnRlLmdldFRpbWUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZWdtZW50b1N1cG9ydGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFN1YnN0aXR1YSBvIHNlZ21lbnRvIHByaW5jaXBhbCBwZWxvIHNlZ21lbnRvIGRlIHN1cG9ydGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hbmlmZXN0b1ByaW5jaXBhbC5zZWdtZW50c1tpXSA9IHNlZ21lbnRvU3Vwb3J0ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzQ2hhbmdlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAvLyBTZSBvIHNlZ21lbnRvIHByaW5jaXBhbCBhaW5kYSBjb250aXZlciBvIHTDrXR1bG8gXCJBbWF6b25cIiwgcmVtb3ZhLW9cclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWlzQ2hhbmdlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBtYW5pZmVzdG9QcmluY2lwYWwuc2VnbWVudHMuc3BsaWNlKGksIDEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpLS07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlZ21lbnRSZW1vdmVkKys7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiU2VnbWVudG8gY29tIGFkcyByZW1vdmlkb3M6XCIsIHNlZ21lbnRSZW1vdmVkKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gQ3JpYXIgdW1hIG5vdmEgbGlzdGEgZGUgcmVwcm9kdcOnw6NvIE0zVTggY29tIG9zIHNlZ21lbnRvcyBtZXNjbGFkb3NcclxuICAgICAgICBjb25zdCBjb250ZXVkb00zdThNZXNjbGFkbyA9IHRoaXMuZ2VuZXJhdGVNM3U4KG1hbmlmZXN0b1ByaW5jaXBhbCk7XHJcbiAgICAgICAgLy8gY29uc29sZS5sb2coXCJDb250ZcO6ZG8gTTNVOCBtZXNjbGFkbzpcIiwgY29udGV1ZG9NM3U4TWVzY2xhZG8pO1xyXG4gICAgICAgIHJldHVybiBjb250ZXVkb00zdThNZXNjbGFkbztcclxuICAgIH1cclxuICAgIGZldGNobTN1OEJ5U3RyZWFtVHlwZShhY2Nlc3NUeXBlKSB7XHJcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcclxuICAgICAgICAgICAgbG9nUHJpbnQoXCJTdHJlYW0gVHlwZTogXCIgKyBhY2Nlc3NUeXBlKTtcclxuICAgICAgICAgICAgbGV0IGR1bXAgPSBbXTtcclxuICAgICAgICAgICAgbGV0IHNlcnZlcnMgPSB0aGlzLmN1cnJlbnRTdHJlYW0oKS5nZXRTdHJlYW1CeVN0cmVhbVR5cGUoYWNjZXNzVHlwZSk7XHJcbiAgICAgICAgICAgIGZvciAoY29uc3Qgc2VydmVyIG9mIHNlcnZlcnMpIHtcclxuICAgICAgICAgICAgICAgIC8vZmlsdGVyIHNlcnZlciB1cmwgYnkgcXVhbGl0eSBvciBiZXN0cXVhbGl0eVxyXG4gICAgICAgICAgICAgICAgY29uc3Qgc3RyZWFtVXJsID0gc2VydmVyLmZpbmRCeVF1YWxpdHkodGhpcy5xdWFsaXR5KSB8fCBzZXJ2ZXIuYmVzdFF1YWxpdHkoKTtcclxuICAgICAgICAgICAgICAgIC8vdHJ5IGdldCBtM3U4IGNvbnRlbnQgYW5kIHJldHVybiBpZiBkb24ndCBoYXZlIGFkcy5cclxuICAgICAgICAgICAgICAgIGNvbnN0IHRleHQgPSB5aWVsZCAoeWllbGQgZ2xvYmFsLnJlcXVlc3Qoc3RyZWFtVXJsID09PSBudWxsIHx8IHN0cmVhbVVybCA9PT0gdm9pZCAwID8gdm9pZCAwIDogc3RyZWFtVXJsLnVybCkpLnRleHQoKTtcclxuICAgICAgICAgICAgICAgIGR1bXAucHVzaCh0ZXh0KTtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzQWRzKHRleHQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbG9nUHJpbnQoXCJTdHJlYW0gVHlwZTogXCIgKyBhY2Nlc3NUeXBlICsgXCIgLSBBZHMgZm91bmRcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50U3RyZWFtKCkucmVtb3ZlU2VydmVyKHNlcnZlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4geyBkYXRhOiB0ZXh0LCBkdW1wOiBkdW1wIH07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHsgZGF0YTogbnVsbCwgZHVtcDogZHVtcCB9O1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgc2V0Q2hhbm5lbChjaGFubmVsTmFtZSkge1xyXG4gICAgICAgIGxvZ1ByaW50KFwiTG9hZGluZyBjaGFubmVsXCIsIGNoYW5uZWxOYW1lKTtcclxuICAgICAgICB0aGlzLmFjdHVhbENoYW5uZWwgPSBjaGFubmVsTmFtZTtcclxuICAgICAgICBjb25zdCBjdXJyZW50U3RyZWFtID0gbmV3IHN0cmVhbV8xLlN0cmVhbSh0aGlzLmFjdHVhbENoYW5uZWwpO1xyXG4gICAgICAgIHRoaXMuc3RyZWFtTGlzdC5wdXNoKGN1cnJlbnRTdHJlYW0pO1xyXG4gICAgfVxyXG59XHJcbmV4cG9ydHMuUGxheWVyID0gUGxheWVyO1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1kYXRhOmFwcGxpY2F0aW9uL2pzb247YmFzZTY0LGV5SjJaWEp6YVc5dUlqb3pMQ0ptYVd4bElqb2ljR3hoZVdWeUxtcHpJaXdpYzI5MWNtTmxVbTl2ZENJNklpSXNJbk52ZFhKalpYTWlPbHNpTGk0dkxpNHZMaTR2YzNKakwyMXZaSFZzWlhNdmNHeGhlV1Z5TDNCc1lYbGxjaTUwY3lKZExDSnVZVzFsY3lJNlcxMHNJbTFoY0hCcGJtZHpJam9pT3pzN096czdPenM3T3pzN1FVRkJRU3cyUTBGQk1FTTdRVUZGTVVNc2FVVkJRVFpFTzBGQlJUZEVMRFpEUVVGeFF6dEJRVVZ5UXl4TlFVRmhMRTFCUVUwN1NVRkJia0k3VVVGRFJTeHRRa0ZCWXl4SFFVRkhMRVZCUVVVc1EwRkJReXhEUVVGRExIRkNRVUZ4UWp0UlFVVXhReXhsUVVGVkxFZEJRV0VzUlVGQlJTeERRVUZETEVOQlFVTXNjVVJCUVhGRU8xRkJRMmhHTEd0Q1FVRmhMRWRCUVZjc1JVRkJSU3hEUVVGRExFTkJRVU1zWVVGQllUdFJRVU42UXl4bFFVRlZMRWRCUVVjc1MwRkJTeXhEUVVGRExFTkJRVU1zT0VKQlFUaENPMUZCUld4RUxGbEJRVThzUjBGQlZ5eEZRVUZGTEVOQlFVTXNRMEZCUXl3eVFrRkJNa0k3VVVGRmFrUXNaVUZCVlN4SFFVRkhMRWRCUVVjc1JVRkJSU3hEUVVGRExFMUJRVTBzUTBGQlF5eFhRVUZYTEVOQlFVTXNSVUZCUlN4SlFVRkpMRVZCUVVVc1dVRkJXU3hGUVVGRkxFTkJRVU1zUTBGQlF6dFJRVU01UkN4blFrRkJWeXhIUVVGSExFZEJRVWNzUlVGQlJTeERRVUZETEUxQlFVMHNRMEZCUXl4WFFVRlhMRU5CUVVNc1JVRkJSU3hKUVVGSkxFVkJRVVVzWVVGQllTeEZRVUZGTEVOQlFVTXNRMEZCUXp0UlFVTm9SU3hWUVVGTExFZEJRVWNzUjBGQlJ5eEZRVUZGTEVOQlFVTXNUVUZCVFN4RFFVRkRMRmRCUVZjc1EwRkJReXhGUVVGRkxFbEJRVWtzUlVGQlJTeFBRVUZQTEVWQlFVVXNRMEZCUXl4RFFVRkRPMUZCUTNCRUxGTkJRVWtzUjBGQlJ5eEhRVUZITEVWQlFVVXNRMEZCUXl4TlFVRk5MRU5CUVVNc1YwRkJWeXhEUVVGRExFVkJRVVVzU1VGQlNTeEZRVUZGTEUxQlFVMHNSVUZCUlN4RFFVRkRMRU5CUVVNN1VVRkZiRVFzWjBKQlFWY3NSMEZCUnl4RFFVRkRMRTlCUVdkQ0xFVkJRVVVzUlVGQlJUczdXVUZEYWtNc1NVRkJTU3hEUVVGRExFOUJRVThzUjBGQlJ5eFBRVUZQTEVOQlFVTTdXVUZEZGtJc1NVRkJTU3hEUVVGQkxFMUJRVUVzU1VGQlNTeERRVUZETEU5QlFVOHNNRU5CUVVVc1YwRkJWeXhOUVVGSkxFMUJRVUVzU1VGQlNTeERRVUZETEU5QlFVOHNNRU5CUVVVc1VVRkJVU3hEUVVGQk8yZENRVUZGTEUxQlFVRXNUVUZCUVN4SlFVRkpMRU5CUVVNc1lVRkJZU3hGUVVGRkxEQkRRVUZGTEZWQlFWVXNNRU5CUVVVc1NVRkJTU3hEUVVGRExFMUJRVUVzU1VGQlNTeERRVUZETEU5QlFVOHNNRU5CUVVVc1VVRkJVU3hEUVVGRExFTkJRVU03V1VGRGVFZ3NVVUZCVVN4RFFVRkRMR2xDUVVGcFFpeERRVUZETEVOQlFVTTdVVUZET1VJc1EwRkJReXhEUVVGRE8xRkJSVVlzYzBKQlFXbENMRWRCUVVjc1EwRkJReXhqUVVGelFpeEZRVUZGTEVWQlFVVXNRMEZCUXl4SlFVRkpMRU5CUVVNc1kwRkJZeXhIUVVGSExHTkJRV01zUTBGQlF6dFJRVVZ5Uml4cFFrRkJXU3hIUVVGSExFZEJRVk1zUlVGQlJUdFpRVU40UWl4SlFVRkpMRU5CUVVNc1MwRkJTeXhGUVVGRkxFTkJRVU03V1VGRFlpeE5RVUZOTEVsQlFVa3NUMEZCVHl4RFFVRkRMRTlCUVU4c1EwRkJReXhGUVVGRkxFTkJRVU1zVlVGQlZTeERRVUZETEU5QlFVOHNSVUZCUlN4SlFVRkpMRU5CUVVNc1EwRkJReXhEUVVGRE8xbEJRM2hFTEVsQlFVa3NRMEZCUXl4SlFVRkpMRVZCUVVVc1EwRkJRenRSUVVOa0xFTkJRVU1zUTBGQlFTeERRVUZETzFGQlJVWXNaVUZCVlN4SFFVRkhMRWRCUVVjc1JVRkJSVHRaUVVOb1FpeFBRVUZQTEVOQlFVTXNSMEZCUnl4RFFVRkRMR0ZCUVdFc1EwRkJReXhEUVVGRE8xbEJRek5DTEVsQlFVa3NRMEZCUXl4WlFVRlpMRVZCUVVVc1EwRkJRenRaUVVOd1FpeEpRVUZKTEVOQlFVTXNXVUZCV1N4RlFVRkZMRU5CUVVNN1VVRkRkRUlzUTBGQlF5eERRVUZETzFGQlEwWXNZVUZCVVN4SFFVRkhMRWRCUVVjc1JVRkJSVHRaUVVOa0xFOUJRVThzUTBGQlF5eEhRVUZITEVOQlFVTXNWMEZCVnl4RFFVRkRMRU5CUVVNN1dVRkRla0lzU1VGQlNTeERRVUZETEZsQlFWa3NSVUZCUlN4RFFVRkRPMWxCUTNCQ0xFbEJRVWtzUTBGQlF5eFpRVUZaTEVWQlFVVXNRMEZCUXp0UlFVTjBRaXhEUVVGRExFTkJRVU03VVVGRlJpeFZRVUZMTEVkQlFVY3NRMEZCUXl4RFFVRlRMRVZCUVVVc1kwRkJkVUlzUzBGQlN5eEZRVUZGTEVWQlFVVTdXVUZEYkVRc1RVRkJUU3hIUVVGSExFZEJRVWNzU1VGQlNTeERRVUZETEUxQlFVMHNRMEZCUXl4RFFVRkRMRU5CUVVNc1EwRkJRenRaUVVNelFpeEpRVUZKTEVOQlFVTXNWMEZCVnp0blFrRkJSU3hQUVVGUExFZEJRVWNzUTBGQlF6dFpRVU0zUWl4SlFVRkpMRWxCUVVrc1EwRkJReXhWUVVGVkxFbEJRVWtzUzBGQlN5eEpRVUZKTEVsQlFVa3NRMEZCUXl4VlFVRlZMRWxCUVVrc1IwRkJSenRuUWtGQlJTeEpRVUZKTEVOQlFVTXNWVUZCVlN4RlFVRkZMRU5CUVVNN1dVRkRNVVVzU1VGQlNTeEpRVUZKTEVOQlFVTXNWVUZCVlN4SlFVRkpMRWxCUVVrc1NVRkJTU3hKUVVGSkxFTkJRVU1zVlVGQlZTeEpRVUZKTEVkQlFVYzdaMEpCUVVVc1NVRkJTU3hEUVVGRExGRkJRVkVzUlVGQlJTeERRVUZETzFsQlEzWkZMRWxCUVVrc1EwRkJReXhWUVVGVkxFZEJRVWNzUjBGQlJ5eERRVUZETzFsQlJYUkNMRTlCUVU4c1NVRkJTU3hEUVVGRExGVkJRVlVzUTBGQlF6dFJRVU42UWl4RFFVRkRMRU5CUVVNN1VVRkZSaXhYUVVGTkxFZEJRVWNzUTBGQlF5eERRVUZUTEVWQlFVVXNSVUZCUlN4RFFVRkRMRU5CUVVFc1EwRkJReXhoUVVGRUxFTkJRVU1zZFVKQlFVUXNRMEZCUXl4RFFVRkZMRkZCUVZFc1IwRkJSeXhSUVVGUkxFTkJRVU1zVlVGQlZTeERRVUZETEUxQlFVa3NRMEZCUXl4aFFVRkVMRU5CUVVNc2RVSkJRVVFzUTBGQlF5eERRVUZGTEZGQlFWRXNSMEZCUnl4UlFVRlJMRU5CUVVNc1VVRkJVU3hEUVVGRExFTkJRVUVzUzBGQlNTeERRVUZETEdGQlFVUXNRMEZCUXl4MVFrRkJSQ3hEUVVGRExFTkJRVVVzVVVGQlVTeEhRVUZITEZGQlFWRXNRMEZCUXl4TFFVRkxMRU5CUVVNc1EwRkJRU3hEUVVGRE8xRkJSV2hKTEd0Q1FVRmhMRWRCUVVjc1EwRkJReXhWUVVGclFpeEpRVUZKTEVOQlFVTXNZVUZCWVN4RlFVRlZMRVZCUVVVN08xbEJReTlFTEU5QlFVOHNUVUZCUVN4SlFVRkpMRU5CUVVNc1ZVRkJWU3d3UTBGQlJTeEpRVUZKTEVOQlFVTXNRMEZCUXl4RFFVRlRMRVZCUVVVc1JVRkJSU3hEUVVGRExFTkJRVU1zUTBGQlF5eFhRVUZYTEV0QlFVc3NUMEZCVHl4RFFVRkZMRU5CUVVNN1VVRkRNVVVzUTBGQlF5eERRVUZETzBsQmJVdEtMRU5CUVVNN1NVRnFTME1zVjBGQlZ6czdVVUZEVkN4UFFVRlBMRU5CUVVFc1RVRkJRU3hOUVVGQkxFbEJRVWtzUTBGQlF5eFBRVUZQTERCRFFVRkZMRk5CUVZNc01FTkJRVVVzVVVGQlVTeERRVUZETEVsQlFVa3NRMEZCUXl4aFFVRmhMRU5CUVVNc1MwRkJTU3hMUVVGTExFTkJRVU03U1VGRGVFVXNRMEZCUXp0SlFVVkxMRTlCUVU4c1EwRkJReXhKUVVGWk96dFpRVU40UWl4SlFVRkpMRWxCUVVrc1EwRkJReXhYUVVGWExFVkJRVVU3WjBKQlFVVXNUMEZCVHl4SlFVRkpMRU5CUVVNN1dVRkRjRU1zU1VGQlNTeERRVUZETEVsQlFVa3NRMEZCUXl4TFFVRkxMRU5CUVVNc1NVRkJTU3hGUVVGRkxFbEJRVWtzUTBGQlF6dG5Ra0ZCUlN4UFFVRlBMRWxCUVVrc1EwRkJReXhwUWtGQmFVSXNRMEZCUXl4RFFVRkRMRWxCUVVrc1EwRkJReXhEUVVGRExFTkJRVU03V1VGRmJrVXNTVUZCU1N4SlFVRkpMRWRCUVdFc1JVRkJSU3hEUVVGRE8xbEJSWGhDTEVsQlFVa3NRMEZCUXl4aFFVRmhMRVZCUVVVc1EwRkJReXhyUWtGQmEwSXNRMEZCUXl4M1FrRkJWU3hEUVVGRExGTkJRVk1zUlVGQlJTeEpRVUZKTEVOQlFVTXNZMEZCWXl4RFFVRkRMRU5CUVVNN1dVRkRia1lzU1VGQlNTeERRVUZETEdGQlFXRXNSVUZCUlN4RFFVRkRMR3RDUVVGclFpeERRVUZETEhkQ1FVRlZMRU5CUVVNc1QwRkJUeXhGUVVGRkxFbEJRVWtzUTBGQlF5eGpRVUZqTEVOQlFVTXNRMEZCUXp0WlFVVnFSaXhOUVVGTkxGTkJRVk1zUjBGQlJ5eE5RVUZOTEVsQlFVa3NRMEZCUXl4eFFrRkJjVUlzUTBGQlF5eDNRa0ZCVlN4RFFVRkRMRk5CUVZNc1EwRkJReXhEUVVGRE8xbEJRM3BGTEdkR1FVRm5SanRaUVVOb1JpeEpRVUZKTEVkQlFVY3NTVUZCU1N4RFFVRkRMRTFCUVUwc1EwRkJReXhUUVVGVExFTkJRVU1zU1VGQlNTeERRVUZETEVOQlFVTTdXVUZGYmtNc1RVRkJUU3hQUVVGUExFZEJRVWNzVFVGQlRTeEpRVUZKTEVOQlFVTXNjVUpCUVhGQ0xFTkJRVU1zZDBKQlFWVXNRMEZCUXl4UFFVRlBMRU5CUVVNc1EwRkJRenRaUVVOeVJTdzRSVUZCT0VVN1dVRkRPVVVzU1VGQlNTeEhRVUZITEVsQlFVa3NRMEZCUXl4TlFVRk5MRU5CUVVNc1QwRkJUeXhEUVVGRExFbEJRVWtzUTBGQlF5eERRVUZETzFsQlJXcERMRTlCUVU4c1EwRkJReXhIUVVGSExFTkJRVU1zZVVKQlFYbENMRU5CUVVNc1EwRkJRenRaUVVWMlF5eFBRVUZQTEVsQlFVa3NRMEZCUXl4cFFrRkJhVUlzUTBGQlF5eERRVUZETEVsQlFVa3NSVUZCUlN4SFFVRkhMRWxCUVVrc1EwRkJReXhEUVVGRExFTkJRVU03VVVGRGFrUXNRMEZCUXp0TFFVRkJPMGxCUlVRc1dVRkJXU3hEUVVGRExGRkJRV0U3VVVGRGVFSXNTVUZCU1N4WFFVRlhMRWRCUVVjc1YwRkJWeXhEUVVGRE8xRkJSVGxDTEVsQlFVa3NVVUZCVVN4RFFVRkRMR05CUVdNc1JVRkJSVHRaUVVNelFpeFhRVUZYTEVsQlFVa3NlVUpCUVhsQ0xGRkJRVkVzUTBGQlF5eGpRVUZqTEVsQlFVa3NRMEZCUXp0VFFVTnlSVHRSUVVWRUxFbEJRVWtzVVVGQlVTeERRVUZETEdGQlFXRXNSVUZCUlR0WlFVTXhRaXhYUVVGWExFbEJRVWtzZVVKQlFYbENMRkZCUVZFc1EwRkJReXhoUVVGaExFbEJRVWtzUTBGQlF6dFRRVU53UlR0UlFVVkVMRWxCUVVrc1VVRkJVU3hEUVVGRExGRkJRVkVzUlVGQlJUdFpRVU55UWl4UlFVRlJMRU5CUVVNc1VVRkJVU3hEUVVGRExFOUJRVThzUTBGQlF5eERRVUZETEU5QlFWa3NSVUZCUlN4RlFVRkZPMmRDUVVONlF5eEpRVUZKTEU5QlFVOHNRMEZCUXl4UlFVRlJMRVZCUVVVN2IwSkJRM0JDTEZkQlFWY3NTVUZCU1N4WFFVRlhMRTlCUVU4c1EwRkJReXhSUVVGUkxFVkJRVVVzUTBGQlF6dHZRa0ZETjBNc1YwRkJWeXhKUVVGSkxFbEJRVWtzUTBGQlF6dHBRa0ZEY2tJN1owSkJRMFFzVjBGQlZ5eEpRVUZKTEVkQlFVY3NUMEZCVHl4RFFVRkRMRWRCUVVjc1NVRkJTU3hEUVVGRE8xbEJRM0JETEVOQlFVTXNRMEZCUXl4RFFVRkRPMU5CUTBvN1VVRkZSQ3hQUVVGUExGZEJRVmNzUTBGQlF6dEpRVU55UWl4RFFVRkRPMGxCUlVRc2FVSkJRV2xDTEVOQlFVTXNZVUZCZFVJN1VVRkRka01zVFVGQlRTeFZRVUZWTEVkQlFVY3NZVUZCWVN4RFFVRkRMRWRCUVVjc1EwRkJReXhEUVVGRExGRkJRVkVzUlVGQlJTeEZRVUZGTzFsQlEyaEVMRTFCUVUwc1ZVRkJWU3hIUVVGSExFbEJRVWtzYjBKQlFVMHNSVUZCUlN4RFFVRkRPMWxCUldoRExGVkJRVlVzUTBGQlF5eEpRVUZKTEVOQlFVTXNVVUZCVVN4RFFVRkRMRU5CUVVNN1dVRkRNVUlzVlVGQlZTeERRVUZETEVkQlFVY3NSVUZCUlN4RFFVRkRPMWxCUldwQ0xHMUVRVUZ0UkR0WlFVTnVSQ3hOUVVGTkxGRkJRVkVzUjBGQlJ5eFZRVUZWTEVOQlFVTXNVVUZCVVN4RFFVRkRPMWxCUTNKRExFbEJRVWtzVVVGQlVTeERRVUZETEZGQlFWRXNSVUZCUlR0blFrRkRja0lzVVVGQlVTeERRVUZETEZGQlFWRXNRMEZCUXl4UFFVRlBMRU5CUVVNc1EwRkJReXhQUVVGWkxFVkJRVVVzUlVGQlJUdHZRa0ZEZWtNc01rUkJRVEpFTzI5Q1FVTXpSQ3hOUVVGTkxHTkJRV01zUjBGQlJ5eEpRVUZKTEUxQlFVMHNRMEZCUXl4elEwRkJjME1zVDBGQlR5eERRVUZETEVkQlFVY3NSVUZCUlN4RFFVRkRMRU5CUVVNN2IwSkJRM1pHTEUxQlFVMHNTMEZCU3l4SFFVRkhMRkZCUVZFc1EwRkJReXhMUVVGTExFTkJRVU1zWTBGQll5eERRVUZETEVOQlFVTTdiMEpCUlRkRExFbEJRVWtzUzBGQlN5eEZRVUZGTzNkQ1FVTlVMRTlCUVU4c1EwRkJReXhMUVVGTExFZEJRVWNzUzBGQlN5eERRVUZETEVOQlFVTXNRMEZCUXl4RFFVRkRMRU5CUVVNc1EwRkJReXhMUVVGTExFTkJRVU1zUTBGQlF5eERRVUZETEVOQlFVTXNTVUZCU1N4RlFVRkZMRU5CUVVNc1EwRkJReXhEUVVGRExFVkJRVVVzUTBGQlF6dHhRa0ZEYWtRN1owSkJRMGdzUTBGQlF5eERRVUZETEVOQlFVTTdZVUZEU2p0WlFVVkVMRTlCUVU4c1VVRkJVU3hEUVVGRE8xRkJRMnhDTEVOQlFVTXNRMEZCUXl4RFFVRkRPMUZCUlVnc1RVRkJUU3hyUWtGQmEwSXNSMEZCUnl4VlFVRlZMRU5CUVVNc1EwRkJReXhEUVVGRExFTkJRVU03VVVGRGVrTXNUVUZCVFN4cFFrRkJhVUlzUjBGQlJ5eFZRVUZWTEVOQlFVTXNTMEZCU3l4RFFVRkRMRU5CUVVNc1EwRkJReXhEUVVGRE8xRkJSVGxETEVsQlFVa3NhMEpCUVd0Q0xFTkJRVU1zVVVGQlVTeEZRVUZGTzFsQlF5OUNMRTlCUVU4c1EwRkJReXhIUVVGSExFTkJRVU1zSzBOQlFTdERMRVZCUVVVc2EwSkJRV3RDTEVOQlFVTXNVVUZCVVN4RFFVRkRMRTFCUVUwc1EwRkJReXhEUVVGRE8xbEJRMnBITEU5QlFVOHNRMEZCUXl4SFFVRkhMRU5CUVVNc2IwTkJRVzlETEVWQlFVVXNhVUpCUVdsQ0xFTkJRVU1zVFVGQlRTeERRVUZETEVOQlFVTTdXVUZGTlVVc1NVRkJTU3hqUVVGakxFZEJRVWNzUTBGQlF5eERRVUZETzFsQlJYWkNMR2RJUVVGblNEdFpRVU5vU0N4TFFVRkxMRWxCUVVrc1EwRkJReXhIUVVGSExFTkJRVU1zUlVGQlJTeERRVUZETEVkQlFVY3NhMEpCUVd0Q0xFTkJRVU1zVVVGQlVTeERRVUZETEUxQlFVMHNSVUZCUlN4RFFVRkRMRVZCUVVVc1JVRkJSVHRuUWtGRE0wUXNUVUZCVFN4cFFrRkJhVUlzUjBGQlJ5eHJRa0ZCYTBJc1EwRkJReXhSUVVGUkxFTkJRVU1zUTBGQlF5eERRVUZETEVOQlFVTTdaMEpCUlhwRUxFbEJRVWtzVTBGQlV5eEhRVUZITEV0QlFVc3NRMEZCUXp0blFrRkZkRUlzU1VGQlNTeEpRVUZKTEVOQlFVTXNUVUZCVFN4RFFVRkRMR2xDUVVGcFFpeERRVUZETEV0QlFVc3NRMEZCUXl4RlFVRkZPMjlDUVVONFF5eHBRa0ZCYVVJc1EwRkJReXhQUVVGUExFTkJRVU1zUTBGQlF5eG5Ra0ZCWjBJc1JVRkJSU3hGUVVGRk96dDNRa0ZETjBNc2QwcEJRWGRLTzNkQ1FVTjRTaXhOUVVGTkxHVkJRV1VzUjBGQlJ5eE5RVUZCTEdkQ1FVRm5RaXhoUVVGb1FpeG5Ra0ZCWjBJc2RVSkJRV2hDTEdkQ1FVRm5RaXhEUVVGRkxGRkJRVkVzTUVOQlFVVXNTVUZCU1N4RFFVRkRMRU5CUVVNc1IwRkJVU3hGUVVGRkxFVkJRVVU3TkVKQlEzQkZMRWxCUVVrc1NVRkJTU3hEUVVGRExFMUJRVTBzUTBGQlF5eEhRVUZITEVOQlFVTXNTMEZCU3l4RFFVRkRPMmREUVVGRkxFOUJRVThzUzBGQlN5eERRVUZET3pSQ1FVVjZReXhOUVVGTkxHRkJRV0VzUjBGQlJ5eEpRVUZKTEVsQlFVa3NRMEZCUXl4cFFrRkJhVUlzUTBGQlF5eGpRVUZqTEVOQlFVTXNRMEZCUXpzMFFrRkRha1VzVFVGQlRTeFhRVUZYTEVkQlFVY3NTVUZCU1N4SlFVRkpMRU5CUVVNc1IwRkJSeXhEUVVGRExHTkJRV01zUTBGQlF5eERRVUZET3pSQ1FVTnFSQ3hoUVVGaExFTkJRVU1zWlVGQlpTeERRVUZETEVOQlFVTXNRMEZCUXl4RFFVRkRPelJDUVVOcVF5eFhRVUZYTEVOQlFVTXNaVUZCWlN4RFFVRkRMRU5CUVVNc1EwRkJReXhEUVVGRE96UkNRVVV2UWl4UFFVRlBMR0ZCUVdFc1EwRkJReXhQUVVGUExFVkJRVVVzUzBGQlN5eFhRVUZYTEVOQlFVTXNUMEZCVHl4RlFVRkZMRU5CUVVNN2QwSkJRek5FTEVOQlFVTXNRMEZCUXl4RFFVRkRPM2RDUVVWSUxFbEJRVWtzWlVGQlpTeEZRVUZGT3pSQ1FVTnVRaXd3UkVGQk1FUTdORUpCUXpGRUxHdENRVUZyUWl4RFFVRkRMRkZCUVZFc1EwRkJReXhEUVVGRExFTkJRVU1zUjBGQlJ5eGxRVUZsTEVOQlFVTTdORUpCUTJwRUxGTkJRVk1zUjBGQlJ5eEpRVUZKTEVOQlFVTTdlVUpCUTJ4Q08yOUNRVU5JTEVOQlFVTXNRMEZCUXl4RFFVRkRPMjlDUVVWSUxIRkZRVUZ4UlR0dlFrRkRja1VzU1VGQlNTeERRVUZETEZOQlFWTXNSVUZCUlR0M1FrRkRaQ3hyUWtGQmEwSXNRMEZCUXl4UlFVRlJMRU5CUVVNc1RVRkJUU3hEUVVGRExFTkJRVU1zUlVGQlJTeERRVUZETEVOQlFVTXNRMEZCUXp0M1FrRkRla01zUTBGQlF5eEZRVUZGTEVOQlFVTTdkMEpCUTBvc1kwRkJZeXhGUVVGRkxFTkJRVU03Y1VKQlEyeENPMmxDUVVWR08yRkJRMFk3V1VGRlJDeFBRVUZQTEVOQlFVTXNSMEZCUnl4RFFVRkRMRFpDUVVFMlFpeEZRVUZGTEdOQlFXTXNRMEZCUXl4RFFVRkRPMU5CUXpWRU8xRkJSVVFzY1VWQlFYRkZPMUZCUTNKRkxFMUJRVTBzYjBKQlFXOUNMRWRCUVVjc1NVRkJTU3hEUVVGRExGbEJRVmtzUTBGQlF5eHJRa0ZCYTBJc1EwRkJReXhEUVVGRE8xRkJRMjVGTEdkRlFVRm5SVHRSUVVOb1JTeFBRVUZQTEc5Q1FVRnZRaXhEUVVGRE8wbEJRemxDTEVOQlFVTTdTVUZGU3l4eFFrRkJjVUlzUTBGQlF5eFZRVUZ6UWpzN1dVRkRhRVFzVVVGQlVTeERRVUZETEdWQlFXVXNSMEZCUnl4VlFVRlZMRU5CUVVNc1EwRkJRenRaUVVWMlF5eEpRVUZKTEVsQlFVa3NSMEZCWVN4RlFVRkZMRU5CUVVNN1dVRkRlRUlzU1VGQlNTeFBRVUZQTEVkQlFXRXNTVUZCU1N4RFFVRkRMR0ZCUVdFc1JVRkJSU3hEUVVGRExIRkNRVUZ4UWl4RFFVRkRMRlZCUVZVc1EwRkJReXhEUVVGRE8xbEJSUzlGTEV0QlFVc3NUVUZCVFN4TlFVRk5MRWxCUVVrc1QwRkJUeXhGUVVGRk8yZENRVU0xUWl3MlEwRkJOa003WjBKQlF6ZERMRTFCUVUwc1UwRkJVeXhIUVVGSExFMUJRVTBzUTBGQlF5eGhRVUZoTEVOQlFVTXNTVUZCU1N4RFFVRkRMRTlCUVU4c1EwRkJReXhKUVVGSkxFMUJRVTBzUTBGQlF5eFhRVUZYTEVWQlFVVXNRMEZCUXp0blFrRkZOMFVzYjBSQlFXOUVPMmRDUVVOd1JDeE5RVUZOTEVsQlFVa3NSMEZCVnl4TlFVRk5MRU5CUVVNc1RVRkJUU3hOUVVGTkxFTkJRVU1zVDBGQlR5eERRVUZETEZOQlFWTXNZVUZCVkN4VFFVRlRMSFZDUVVGVUxGTkJRVk1zUTBGQlJTeEhRVUZITEVOQlFVTXNRMEZCUXl4RFFVRkRMRWxCUVVrc1JVRkJSU3hEUVVGRE8yZENRVU42UlN4SlFVRkpMRU5CUVVNc1NVRkJTU3hEUVVGRExFbEJRVWtzUTBGQlF5eERRVUZETzJkQ1FVTm9RaXhKUVVGSkxFbEJRVWtzUTBGQlF5eExRVUZMTEVOQlFVTXNTVUZCU1N4RFFVRkRMRVZCUVVVN2IwSkJRM0JDTEZGQlFWRXNRMEZCUXl4bFFVRmxMRWRCUVVjc1ZVRkJWU3hIUVVGSExHTkJRV01zUTBGQlF5eERRVUZETzI5Q1FVTjRSQ3hKUVVGSkxFTkJRVU1zWVVGQllTeEZRVUZGTEVOQlFVTXNXVUZCV1N4RFFVRkRMRTFCUVUwc1EwRkJReXhEUVVGRE8yOUNRVU14UXl4VFFVRlRPMmxDUVVOV08yZENRVVZFTEU5QlFVOHNSVUZCUlN4SlFVRkpMRVZCUVVVc1NVRkJTU3hGUVVGRkxFbEJRVWtzUlVGQlJTeEpRVUZKTEVWQlFVVXNRMEZCUXp0aFFVTnVRenRaUVVWRUxFOUJRVThzUlVGQlJTeEpRVUZKTEVWQlFVVXNTVUZCU1N4RlFVRkZMRWxCUVVrc1JVRkJSU3hKUVVGSkxFVkJRVVVzUTBGQlF6dFJRVU53UXl4RFFVRkRPMHRCUVVFN1NVRkZSQ3hWUVVGVkxFTkJRVU1zVjBGQmJVSTdVVUZETlVJc1VVRkJVU3hEUVVGRExHbENRVUZwUWl4RlFVRkZMRmRCUVZjc1EwRkJReXhEUVVGRE8xRkJRM3BETEVsQlFVa3NRMEZCUXl4aFFVRmhMRWRCUVVjc1YwRkJWeXhEUVVGRE8xRkJSV3BETEUxQlFVMHNZVUZCWVN4SFFVRkhMRWxCUVVrc1pVRkJUU3hEUVVGRExFbEJRVWtzUTBGQlF5eGhRVUZoTEVOQlFVTXNRMEZCUXp0UlFVTnlSQ3hKUVVGSkxFTkJRVU1zVlVGQlZTeERRVUZETEVsQlFVa3NRMEZCUXl4aFFVRmhMRU5CUVVNc1EwRkJRenRKUVVOMFF5eERRVUZETzBOQlEwWTdRVUY0VGtRc2QwSkJkMDVESW4wPSIsIlwidXNlIHN0cmljdFwiO1xyXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XHJcbmV4cG9ydHMuU3RyZWFtVHlwZSA9IHZvaWQgMDtcclxudmFyIFN0cmVhbVR5cGU7XHJcbihmdW5jdGlvbiAoU3RyZWFtVHlwZSkge1xyXG4gICAgU3RyZWFtVHlwZVtcIlBJQ1RVUkVcIl0gPSBcInBpY3R1cmUtaW4tcGljdHVyZVwiO1xyXG4gICAgU3RyZWFtVHlwZVtcIlRIVU5ERVJET01FXCJdID0gXCJ0aHVuZGVyZG9tZVwiO1xyXG4gICAgU3RyZWFtVHlwZVtcIkVNQkVEXCJdID0gXCJlbWJlZFwiO1xyXG4gICAgU3RyZWFtVHlwZVtcIkZST05UUEFHRVwiXSA9IFwiZnJvbnRwYWdlXCI7XHJcbiAgICBTdHJlYW1UeXBlW1wiU0lURVwiXSA9IFwic2l0ZVwiO1xyXG4gICAgU3RyZWFtVHlwZVtcIkVYVEVSTkFMXCJdID0gXCJleHRlcm5hbFwiO1xyXG4gICAgU3RyZWFtVHlwZVtcIkROU1wiXSA9IFwiZG5zXCI7XHJcbn0pKFN0cmVhbVR5cGUgPSBleHBvcnRzLlN0cmVhbVR5cGUgfHwgKGV4cG9ydHMuU3RyZWFtVHlwZSA9IHt9KSk7XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWRhdGE6YXBwbGljYXRpb24vanNvbjtiYXNlNjQsZXlKMlpYSnphVzl1SWpvekxDSm1hV3hsSWpvaWMzUnlaV0Z0TG1WdWRXMHVhbk1pTENKemIzVnlZMlZTYjI5MElqb2lJaXdpYzI5MWNtTmxjeUk2V3lJdUxpOHVMaTh1TGk4dUxpOXpjbU12Ylc5a2RXeGxjeTl6ZEhKbFlXMHZhVzUwWlhKbVlXTmxMM04wY21WaGJTNWxiblZ0TG5SeklsMHNJbTVoYldWeklqcGJYU3dpYldGd2NHbHVaM01pT2lJN096dEJRVUZCTEVsQlFWa3NWVUZSV0R0QlFWSkVMRmRCUVZrc1ZVRkJWVHRKUVVOd1FpdzBRMEZCT0VJc1EwRkJRVHRKUVVNNVFpeDVRMEZCTWtJc1EwRkJRVHRKUVVNelFpdzJRa0ZCWlN4RFFVRkJPMGxCUTJZc2NVTkJRWFZDTEVOQlFVRTdTVUZEZGtJc01rSkJRV0VzUTBGQlFUdEpRVU5pTEcxRFFVRnhRaXhEUVVGQk8wbEJRM0pDTEhsQ1FVRlhMRU5CUVVFN1FVRkRZaXhEUVVGRExFVkJVbGNzVlVGQlZTeEhRVUZXTEd0Q1FVRlZMRXRCUVZZc2EwSkJRVlVzVVVGUmNrSWlmUT09IiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuZXhwb3J0cy5TZXJ2ZXIgPSBleHBvcnRzLlN0cmVhbVVybCA9IHZvaWQgMDtcclxuY2xhc3MgU3RyZWFtVXJsIHtcclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHRoaXMudXJsID0gXCJcIjtcclxuICAgICAgICB0aGlzLnF1YWxpdHkgPSBcIlwiO1xyXG4gICAgfVxyXG59XHJcbmV4cG9ydHMuU3RyZWFtVXJsID0gU3RyZWFtVXJsO1xyXG5jbGFzcyBTZXJ2ZXIge1xyXG4gICAgY29uc3RydWN0b3IocGFydGlhbCkge1xyXG4gICAgICAgIHRoaXMuYmVzdFF1YWxpdHkgPSAoKSA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnVybExpc3RbMF07XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmZpbmRCeVF1YWxpdHkgPSAocXVhbGl0eSkgPT4gdGhpcy51cmxMaXN0LmZpbmQoKHgpID0+IHgucXVhbGl0eSA9PSBxdWFsaXR5KTtcclxuICAgICAgICBPYmplY3QuYXNzaWduKHRoaXMsIHBhcnRpYWwpO1xyXG4gICAgfVxyXG59XHJcbmV4cG9ydHMuU2VydmVyID0gU2VydmVyO1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1kYXRhOmFwcGxpY2F0aW9uL2pzb247YmFzZTY0LGV5SjJaWEp6YVc5dUlqb3pMQ0ptYVd4bElqb2ljM1J5WldGdExuUjVjR1Z6TG1weklpd2ljMjkxY21ObFVtOXZkQ0k2SWlJc0luTnZkWEpqWlhNaU9sc2lMaTR2TGk0dkxpNHZMaTR2YzNKakwyMXZaSFZzWlhNdmMzUnlaV0Z0TDJsdWRHVnlabUZqWlM5emRISmxZVzB1ZEhsd1pYTXVkSE1pWFN3aWJtRnRaWE1pT2x0ZExDSnRZWEJ3YVc1bmN5STZJanM3TzBGQlFVRXNUVUZCWVN4VFFVRlRPMGxCUVhSQ08xRkJRMFVzVVVGQlJ5eEhRVUZYTEVWQlFVVXNRMEZCUXp0UlFVTnFRaXhaUVVGUExFZEJRVmNzUlVGQlJTeERRVUZETzBsQlEzWkNMRU5CUVVNN1EwRkJRVHRCUVVoRUxEaENRVWRETzBGQlEwUXNUVUZCWVN4TlFVRk5PMGxCVldwQ0xGbEJRVmtzVDBGQmQwSTdVVUZNY0VNc1owSkJRVmNzUjBGQlJ5eEhRVUZITEVWQlFVVTdXVUZEYWtJc1QwRkJUeXhKUVVGSkxFTkJRVU1zVDBGQlR5eERRVUZETEVOQlFVTXNRMEZCUXl4RFFVRkRPMUZCUTNwQ0xFTkJRVU1zUTBGQlF6dFJRVU5HTEd0Q1FVRmhMRWRCUVVjc1EwRkJReXhQUVVGbExFVkJRVVVzUlVGQlJTeERRVUZETEVsQlFVa3NRMEZCUXl4UFFVRlBMRU5CUVVNc1NVRkJTU3hEUVVGRExFTkJRVU1zUTBGQlF5eEZRVUZGTEVWQlFVVXNRMEZCUXl4RFFVRkRMRU5CUVVNc1QwRkJUeXhKUVVGSkxFOUJRVThzUTBGQlF5eERRVUZETzFGQlIyeEdMRTFCUVUwc1EwRkJReXhOUVVGTkxFTkJRVU1zU1VGQlNTeEZRVUZGTEU5QlFVOHNRMEZCUXl4RFFVRkRPMGxCUXk5Q0xFTkJRVU03UTBGRFJqdEJRV0pFTEhkQ1FXRkRJbjA9IiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbnZhciBfX2F3YWl0ZXIgPSAodGhpcyAmJiB0aGlzLl9fYXdhaXRlcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xyXG4gICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9XHJcbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cclxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XHJcbiAgICB9KTtcclxufTtcclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG5leHBvcnRzLlN0cmVhbSA9IHZvaWQgMDtcclxuY29uc3Qgc3RyZWFtX2VudW1fMSA9IHJlcXVpcmUoXCIuL2ludGVyZmFjZS9zdHJlYW0uZW51bVwiKTtcclxuY29uc3Qgc3RyZWFtX3R5cGVzXzEgPSByZXF1aXJlKFwiLi9pbnRlcmZhY2Uvc3RyZWFtLnR5cGVzXCIpO1xyXG5jbGFzcyBTdHJlYW0ge1xyXG4gICAgY29uc3RydWN0b3IoY2hhbm5lbE5hbWUpIHtcclxuICAgICAgICB0aGlzLnNlcnZlckxpc3QgPSBbXTsgLy90aGUgbGlzdCBvZiBzZXJ2ZXJzIGxpbmtzIG0zdThcclxuICAgICAgICB0aGlzLmludGVncml0eVRva2VuID0gXCJcIjsgLy90aGUgaW50ZWdyaXR5IHRva2VuXHJcbiAgICAgICAgdGhpcy50dW5uZWxMaXN0ID0gW1wiaHR0cHM6Ly9ldTEuanVwdGVyLmdhL2NoYW5uZWwve2NoYW5uZWxuYW1lfVwiLCBcImh0dHBzOi8vZXUyLmp1cHRlci5nYS9jaGFubmVsL3tjaGFubmVsbmFtZX1cIl07XHJcbiAgICAgICAgdGhpcy50dW5uZWxMaXN0SGxzID0gW1wiaHR0cHM6Ly9ldTEuanVwdGVyLmdhL2NoYW5uZWwvaGxzL3tjaGFubmVsbmFtZX1cIl07XHJcbiAgICAgICAgdGhpcy5jaGFubmVsTmFtZSA9IGNoYW5uZWxOYW1lO1xyXG4gICAgfVxyXG4gICAgcmVtb3ZlU2VydmVyKHNlcnZlcikge1xyXG4gICAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy5zZXJ2ZXJMaXN0LmluZGV4T2Yoc2VydmVyKTtcclxuICAgICAgICBpZiAoaW5kZXggPiAtMSlcclxuICAgICAgICAgICAgdGhpcy5zZXJ2ZXJMaXN0LnNwbGljZShpbmRleCwgMSk7XHJcbiAgICB9XHJcbiAgICAvL2FkZCBtM3U4IGxpbmtzIHdpdGggcXVhbGl0eSB0byB0aGUgbGlzdCBvZiBzZXJ2ZXJzXHJcbiAgICBjcmVhdGVTZXJ2ZXIodGV4dCwgdHlwZSA9IFwibG9jYWxcIiwgc2lnID0gdHJ1ZSkge1xyXG4gICAgICAgIGNvbnN0IHF1YWxpdHlVcmxTcGxpdCA9IFtdO1xyXG4gICAgICAgIGxldCBjYXB0dXJlQXJyYXk7XHJcbiAgICAgICAgY29uc3QgUkVHRVggPSAvTkFNRT1cIigoPzpcXFMrXFxzK1xcUyt8XFxTKykpXCIsQVVUTyg/Ol58XFxTK1xccyspKD86XnxcXFMrXFxzKykoaHR0cHM6XFwvXFwvdmlkZW8oXFxTKykubTN1OCkvZztcclxuICAgICAgICB3aGlsZSAoKGNhcHR1cmVBcnJheSA9IFJFR0VYLmV4ZWModGV4dCkpICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHF1YWxpdHlVcmxTcGxpdC5wdXNoKHsgcXVhbGl0eTogY2FwdHVyZUFycmF5WzFdLCB1cmw6IGNhcHR1cmVBcnJheVsyXSB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3Qgc3RyZWFtTGlzdCA9IG5ldyBzdHJlYW1fdHlwZXNfMS5TZXJ2ZXIoeyB0eXBlOiB0eXBlLCB1cmxMaXN0OiBxdWFsaXR5VXJsU3BsaXQsIHNpZzogc2lnIH0pO1xyXG4gICAgICAgIHRoaXMuc2VydmVyTGlzdC5wdXNoKHN0cmVhbUxpc3QpO1xyXG4gICAgfVxyXG4gICAgLy9hZGQgYSBuZXcgcGxheWVyIHN0cmVhbSBleHRlcm5hbFxyXG4gICAgbG9jYWxSZXF1ZXN0KHBsYXllclR5cGUsIGNvbXBsZXRlID0gdHJ1ZSkge1xyXG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBxdWVyeSA9ICdxdWVyeSBQbGF5YmFja0FjY2Vzc1Rva2VuX1RlbXBsYXRlKCRsb2dpbjogU3RyaW5nISwgJGlzTGl2ZTogQm9vbGVhbiEsICR2b2RJRDogSUQhLCAkaXNWb2Q6IEJvb2xlYW4hLCAkcGxheWVyVHlwZTogU3RyaW5nISkgeyBzdHJlYW1QbGF5YmFja0FjY2Vzc1Rva2VuKGNoYW5uZWxOYW1lOiAkbG9naW4sIHBhcmFtczoge3BsYXRmb3JtOiBcIndlYlwiLCBwbGF5ZXJCYWNrZW5kOiBcIm1lZGlhcGxheWVyXCIsIHBsYXllclR5cGU6ICRwbGF5ZXJUeXBlfSkgQGluY2x1ZGUoaWY6ICRpc0xpdmUpIHsgdmFsdWUgc2lnbmF0dXJlIF9fdHlwZW5hbWUgfSB2aWRlb1BsYXliYWNrQWNjZXNzVG9rZW4oaWQ6ICR2b2RJRCwgcGFyYW1zOiB7cGxhdGZvcm06IFwid2ViXCIsIHBsYXllckJhY2tlbmQ6IFwibWVkaWFwbGF5ZXJcIiwgcGxheWVyVHlwZTogJHBsYXllclR5cGV9KSBAaW5jbHVkZShpZjogJGlzVm9kKSB7IHZhbHVlIHNpZ25hdHVyZSBfX3R5cGVuYW1lIH19JztcclxuICAgICAgICAgICAgICAgIGNvbnN0IGJvZHkgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgb3BlcmF0aW9uTmFtZTogXCJQbGF5YmFja0FjY2Vzc1Rva2VuX1RlbXBsYXRlXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgcXVlcnk6IHF1ZXJ5LFxyXG4gICAgICAgICAgICAgICAgICAgIHZhcmlhYmxlczoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpc0xpdmU6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2luOiB0aGlzLmNoYW5uZWxOYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpc1ZvZDogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZvZElEOiBcIlwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwbGF5ZXJUeXBlOiBwbGF5ZXJUeXBlLFxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZ3FsID0geWllbGQgZ2xvYmFsLnJlcXVlc3QoXCJodHRwczovL2dxbC50d2l0Y2gudHYvZ3FsXCIsIHtcclxuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsgXCJIb3N0XCI6IFwiZ3FsLnR3aXRjaC50dlwiLCBcIkNsaWVudC1JRFwiOiBcImtpbW5lNzhreDNuY3g2YnJnbzRtdjZ3a2k1aDFrb1wiIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoYm9keSksXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHN0cmVhbURhdGFBY2Nlc3MgPSB5aWVsZCBncWwuanNvbigpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcGFyYW1zID0gXCJhbGxvd19zb3VyY2U9dHJ1ZSZmYXN0X2JyZWFkPXRydWUmcD1cIiArXHJcbiAgICAgICAgICAgICAgICAgICAgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMWU3KSArXHJcbiAgICAgICAgICAgICAgICAgICAgXCImcGxheWVyX2JhY2tlbmQ9bWVkaWFwbGF5ZXImcGxheWxpc3RfaW5jbHVkZV9mcmFtZXJhdGU9dHJ1ZSZyZWFzc2lnbm1lbnRzX3N1cHBvcnRlZD1mYWxzZSZzaWc9XCIgK1xyXG4gICAgICAgICAgICAgICAgICAgIHN0cmVhbURhdGFBY2Nlc3MuZGF0YS5zdHJlYW1QbGF5YmFja0FjY2Vzc1Rva2VuLnNpZ25hdHVyZSArXHJcbiAgICAgICAgICAgICAgICAgICAgXCImc3VwcG9ydGVkX2NvZGVjcz1hdmMxJnRva2VuPVwiICtcclxuICAgICAgICAgICAgICAgICAgICBzdHJlYW1EYXRhQWNjZXNzLmRhdGEuc3RyZWFtUGxheWJhY2tBY2Nlc3NUb2tlbi52YWx1ZTtcclxuICAgICAgICAgICAgICAgIGlmICghY29tcGxldGUpXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBhcmFtcztcclxuICAgICAgICAgICAgICAgIGNvbnN0IHRleHQgPSB5aWVsZCAoeWllbGQgZ2xvYmFsLnJlcXVlc3QoXCJodHRwczovL3VzaGVyLnR0dm53Lm5ldC9hcGkvY2hhbm5lbC9obHMvXCIgKyB0aGlzLmNoYW5uZWxOYW1lICsgXCIubTN1OD9cIiArIHBhcmFtcykpLnRleHQoKTtcclxuICAgICAgICAgICAgICAgIGxvZ1ByaW50KFwiU2VydmVyIGxvYWRlZCBcIiArIHBsYXllclR5cGUpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jcmVhdGVTZXJ2ZXIodGV4dCwgcGxheWVyVHlwZSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGV4dDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAgICAgbG9nUHJpbnQoZSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJcIjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgLy9hZGQgYSBuZXcgcGxheWVyIHN0cmVhbSBleHRlcm5hbFxyXG4gICAgcmVxdWVzdFBpY3R1cmVJblBpY3R1cmUoaW50ZWdyaXR5VG9rZW4pIHtcclxuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcXVlcnkgPSAncXVlcnkgUGxheWJhY2tBY2Nlc3NUb2tlbl9UZW1wbGF0ZSgkbG9naW46IFN0cmluZyEsICRpc0xpdmU6IEJvb2xlYW4hLCAkdm9kSUQ6IElEISwgJGlzVm9kOiBCb29sZWFuISwgJHBsYXllclR5cGU6IFN0cmluZyEpIHsgc3RyZWFtUGxheWJhY2tBY2Nlc3NUb2tlbihjaGFubmVsTmFtZTogJGxvZ2luLCBwYXJhbXM6IHtwbGF0Zm9ybTogXCJ3ZWJcIiwgcGxheWVyQmFja2VuZDogXCJtZWRpYXBsYXllclwiLCBwbGF5ZXJUeXBlOiAkcGxheWVyVHlwZX0pIEBpbmNsdWRlKGlmOiAkaXNMaXZlKSB7IHZhbHVlIHNpZ25hdHVyZSBfX3R5cGVuYW1lIH0gdmlkZW9QbGF5YmFja0FjY2Vzc1Rva2VuKGlkOiAkdm9kSUQsIHBhcmFtczoge3BsYXRmb3JtOiBcIndlYlwiLCBwbGF5ZXJCYWNrZW5kOiBcIm1lZGlhcGxheWVyXCIsIHBsYXllclR5cGU6ICRwbGF5ZXJUeXBlfSkgQGluY2x1ZGUoaWY6ICRpc1ZvZCkgeyB2YWx1ZSBzaWduYXR1cmUgX190eXBlbmFtZSB9fSc7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBib2R5ID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIG9wZXJhdGlvbk5hbWU6IFwiUGxheWJhY2tBY2Nlc3NUb2tlbl9UZW1wbGF0ZVwiLFxyXG4gICAgICAgICAgICAgICAgICAgIHF1ZXJ5OiBxdWVyeSxcclxuICAgICAgICAgICAgICAgICAgICB2YXJpYWJsZXM6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaXNMaXZlOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2dpbjogdGhpcy5jaGFubmVsTmFtZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgaXNWb2Q6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2b2RJRDogXCJcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGxheWVyVHlwZTogXCJwaWN0dXJlLWJ5LXBpY3R1cmVcIixcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGdxbCA9IHlpZWxkIGdsb2JhbC5yZXF1ZXN0KFwiaHR0cHM6Ly9ncWwudHdpdGNoLnR2L2dxbFwiLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgICAgICAgICAgICAgICBoZWFkZXJzOiB7IFwiSG9zdFwiOiBcImdxbC50d2l0Y2gudHZcIiwgXCJDbGllbnQtSURcIjogXCJraW1uZTc4a3gzbmN4NmJyZ280bXY2d2tpNWgxa29cIiB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGJvZHkpLFxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBzdHJlYW1EYXRhQWNjZXNzID0geWllbGQgZ3FsLmpzb24oKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHBhcmFtcyA9IFwiYWxsb3dfc291cmNlPXRydWUmZmFzdF9icmVhZD10cnVlJnA9XCIgK1xyXG4gICAgICAgICAgICAgICAgICAgIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDFlNykgK1xyXG4gICAgICAgICAgICAgICAgICAgIFwiJnBsYXllcl9iYWNrZW5kPW1lZGlhcGxheWVyJnBsYXlsaXN0X2luY2x1ZGVfZnJhbWVyYXRlPXRydWUmcmVhc3NpZ25tZW50c19zdXBwb3J0ZWQ9ZmFsc2Umc2lnPVwiICtcclxuICAgICAgICAgICAgICAgICAgICBzdHJlYW1EYXRhQWNjZXNzLmRhdGEuc3RyZWFtUGxheWJhY2tBY2Nlc3NUb2tlbi5zaWduYXR1cmUgK1xyXG4gICAgICAgICAgICAgICAgICAgIFwiJnN1cHBvcnRlZF9jb2RlY3M9YXZjMSZ0b2tlbj1cIiArXHJcbiAgICAgICAgICAgICAgICAgICAgc3RyZWFtRGF0YUFjY2Vzcy5kYXRhLnN0cmVhbVBsYXliYWNrQWNjZXNzVG9rZW4udmFsdWU7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ZXh0ID0geWllbGQgKHlpZWxkIGdsb2JhbC5yZXF1ZXN0KFwiaHR0cHM6Ly91c2hlci50dHZudy5uZXQvYXBpL2NoYW5uZWwvaGxzL1wiICsgdGhpcy5jaGFubmVsTmFtZSArIFwiLm0zdTg/XCIgKyBwYXJhbXMpKS50ZXh0KCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNyZWF0ZVNlcnZlcih0ZXh0LCBzdHJlYW1fZW51bV8xLlN0cmVhbVR5cGUuUElDVFVSRSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGV4dDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAgICAgbG9nUHJpbnQoZSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJcIjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgLy9hZGQgYSBuZXcgcGxheWVyIHN0cmVhbSBleHRlcm5hbFxyXG4gICAgZXh0ZXJuYWxSZXF1ZXN0KCkge1xyXG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XHJcbiAgICAgICAgICAgIGxvZ1ByaW50KFwiRXh0ZXJuYWwgU2VydmVyOiBMb2FkaW5nXCIpO1xyXG4gICAgICAgICAgICBjb25zdCB1cmxzID0gdGhpcy50dW5uZWxMaXN0Lm1hcCgoeCkgPT4geC5yZXBsYWNlKFwie2NoYW5uZWxuYW1lfVwiLCB0aGlzLmNoYW5uZWxOYW1lKSk7XHJcbiAgICAgICAgICAgIHVybHMuZm9yRWFjaCgoY3VycmVudFR1bm5lbCkgPT4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xyXG4gICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IHlpZWxkIGdsb2JhbC5yZXF1ZXN0KGN1cnJlbnRUdW5uZWwpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghcmVzcG9uc2Uub2spXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvZ1ByaW50KFwiU2VydmVyIHByb3h5IHJldHVybiBlcnJvclwiLCBjdXJyZW50VHVubmVsLCByZXNwb25zZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jcmVhdGVTZXJ2ZXIoeWllbGQgcmVzcG9uc2UudGV4dCgpLCBzdHJlYW1fZW51bV8xLlN0cmVhbVR5cGUuRVhURVJOQUwpO1xyXG4gICAgICAgICAgICAgICAgICAgIGxvZ1ByaW50KFwiRXh0ZXJuYWwgU2VydmVyOiBPS1wiKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbG9nUHJpbnQoXCJTZXJ2ZXIgcHJveHkgcmV0dXJuIGVycm9yXCIsIGN1cnJlbnRUdW5uZWwsIGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgLy9hZGQgYSBuZXcgcGxheWVyIHN0cmVhbSBleHRlcm5hbFxyXG4gICAgZXh0ZXJuYWxSZXF1ZXN0MigpIHtcclxuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xyXG4gICAgICAgICAgICBsb2dQcmludChcIkV4dGVybmFsIFNlcnZlciAyOiBMb2FkaW5nXCIpO1xyXG4gICAgICAgICAgICBjb25zdCB1cmwgPSB0aGlzLnR1bm5lbExpc3RIbHNbMF0ucmVwbGFjZShcIntjaGFubmVsbmFtZX1cIiwgdGhpcy5jaGFubmVsTmFtZSk7XHJcbiAgICAgICAgICAgIGNvbnN0IHBhcmFtcyA9IHlpZWxkIHRoaXMubG9jYWxSZXF1ZXN0KHN0cmVhbV9lbnVtXzEuU3RyZWFtVHlwZS5TSVRFLCBmYWxzZSk7XHJcbiAgICAgICAgICAgIGNvbnN0IG0zdTggPSB5aWVsZCBmZXRjaCh1cmwsIHsgbWV0aG9kOiBcIlBPU1RcIiwgYm9keTogcGFyYW1zIH0pO1xyXG4gICAgICAgICAgICBpZiAoIW0zdTgub2spIHtcclxuICAgICAgICAgICAgICAgIGxvZ1ByaW50KFwiU2VydmVyIHByb3h5IHJldHVybiBlcnJvclwiLCB0aGlzLnR1bm5lbExpc3RIbHNbMF0sIG0zdTgpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN0IHRleHQgPSB5aWVsZCBtM3U4LnRleHQoKTtcclxuICAgICAgICAgICAgdGhpcy5jcmVhdGVTZXJ2ZXIodGV4dCwgc3RyZWFtX2VudW1fMS5TdHJlYW1UeXBlLkVYVEVSTkFMKTtcclxuICAgICAgICAgICAgbG9nUHJpbnQoXCJFeHRlcm5hbCBTZXJ2ZXIgMjogT0tcIik7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICAvL2NyZWF0ZSBhIG5ldyBzdHJlYW0gYWNjZXNzXHJcbiAgICBjcmVhdGVTdHJlYW1BY2Nlc3Moc3RyZWFtLCBpbnRlZ3JpdHlUb2tlbikge1xyXG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XHJcbiAgICAgICAgICAgIGlmIChzdHJlYW0gPT0gc3RyZWFtX2VudW1fMS5TdHJlYW1UeXBlLkVYVEVSTkFMKSB7XHJcbiAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLmV4dGVybmFsUmVxdWVzdDIoKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoc3RyZWFtID09IHN0cmVhbV9lbnVtXzEuU3RyZWFtVHlwZS5QSUNUVVJFKSB7XHJcbiAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLnJlcXVlc3RQaWN0dXJlSW5QaWN0dXJlKGludGVncml0eVRva2VuKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB5aWVsZCB0aGlzLmxvY2FsUmVxdWVzdChzdHJlYW0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgZ2V0U3RyZWFtQnlTdHJlYW1UeXBlKGFjY2Vzc1R5cGUpIHtcclxuICAgICAgICAvL2ZpbHRlciBhbGwgc2VydmVyIGJ5IHR5cGVcclxuICAgICAgICBjb25zdCBzZXJ2ZXJzID0gdGhpcy5zZXJ2ZXJMaXN0LmZpbHRlcigoeCkgPT4geC50eXBlID09IGFjY2Vzc1R5cGUpO1xyXG4gICAgICAgIGlmICghc2VydmVycylcclxuICAgICAgICAgICAgcmV0dXJuIFtdO1xyXG4gICAgICAgIHJldHVybiBzZXJ2ZXJzO1xyXG4gICAgfVxyXG59XHJcbmV4cG9ydHMuU3RyZWFtID0gU3RyZWFtO1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1kYXRhOmFwcGxpY2F0aW9uL2pzb247YmFzZTY0LGV5SjJaWEp6YVc5dUlqb3pMQ0ptYVd4bElqb2ljM1J5WldGdExtcHpJaXdpYzI5MWNtTmxVbTl2ZENJNklpSXNJbk52ZFhKalpYTWlPbHNpTGk0dkxpNHZMaTR2YzNKakwyMXZaSFZzWlhNdmMzUnlaV0Z0TDNOMGNtVmhiUzUwY3lKZExDSnVZVzFsY3lJNlcxMHNJbTFoY0hCcGJtZHpJam9pT3pzN096czdPenM3T3pzN1FVRkJRU3g1UkVGQmNVUTdRVUZEY2tRc01rUkJRVFpFTzBGQlJUZEVMRTFCUVdFc1RVRkJUVHRKUVZGcVFpeFpRVUZaTEZkQlFXMUNPMUZCVUM5Q0xHVkJRVlVzUjBGQllTeEZRVUZGTEVOQlFVTXNRMEZCUXl4blEwRkJaME03VVVGTE0wUXNiVUpCUVdNc1IwRkJSeXhGUVVGRkxFTkJRVU1zUTBGQlF5eHhRa0ZCY1VJN1VVRkhlRU1zU1VGQlNTeERRVUZETEZWQlFWVXNSMEZCUnl4RFFVRkRMRFpEUVVFMlF5eEZRVUZGTERaRFFVRTJReXhEUVVGRExFTkJRVU03VVVGRGFrZ3NTVUZCU1N4RFFVRkRMR0ZCUVdFc1IwRkJSeXhEUVVGRExHbEVRVUZwUkN4RFFVRkRMRU5CUVVNN1VVRkRla1VzU1VGQlNTeERRVUZETEZkQlFWY3NSMEZCUnl4WFFVRlhMRU5CUVVNN1NVRkRha01zUTBGQlF6dEpRVVZFTEZsQlFWa3NRMEZCUXl4TlFVRmpPMUZCUTNwQ0xFMUJRVTBzUzBGQlN5eEhRVUZITEVsQlFVa3NRMEZCUXl4VlFVRlZMRU5CUVVNc1QwRkJUeXhEUVVGRExFMUJRVTBzUTBGQlF5eERRVUZETzFGQlF6bERMRWxCUVVrc1MwRkJTeXhIUVVGSExFTkJRVU1zUTBGQlF6dFpRVUZGTEVsQlFVa3NRMEZCUXl4VlFVRlZMRU5CUVVNc1RVRkJUU3hEUVVGRExFdEJRVXNzUlVGQlJTeERRVUZETEVOQlFVTXNRMEZCUXp0SlFVTnVSQ3hEUVVGRE8wbEJSVVFzYjBSQlFXOUVPMGxCUTNCRUxGbEJRVmtzUTBGQlF5eEpRVUZaTEVWQlFVVXNTVUZCU1N4SFFVRkhMRTlCUVU4c1JVRkJSU3hIUVVGSExFZEJRVWNzU1VGQlNUdFJRVU51UkN4TlFVRk5MR1ZCUVdVc1IwRkJaMElzUlVGQlJTeERRVUZETzFGQlEzaERMRWxCUVVrc1dVRkJiME1zUTBGQlF6dFJRVVY2UXl4TlFVRk5MRXRCUVVzc1IwRkJSeXh4UmtGQmNVWXNRMEZCUXp0UlFVVndSeXhQUVVGUExFTkJRVU1zV1VGQldTeEhRVUZITEV0QlFVc3NRMEZCUXl4SlFVRkpMRU5CUVVNc1NVRkJTU3hEUVVGRExFTkJRVU1zUzBGQlN5eEpRVUZKTEVWQlFVVTdXVUZEYWtRc1pVRkJaU3hEUVVGRExFbEJRVWtzUTBGQlF5eEZRVUZGTEU5QlFVOHNSVUZCUlN4WlFVRlpMRU5CUVVNc1EwRkJReXhEUVVGRExFVkJRVVVzUjBGQlJ5eEZRVUZGTEZsQlFWa3NRMEZCUXl4RFFVRkRMRU5CUVVNc1JVRkJSU3hEUVVGRExFTkJRVU03VTBGRE1VVTdVVUZGUkN4TlFVRk5MRlZCUVZVc1IwRkJWeXhKUVVGSkxIRkNRVUZOTEVOQlFVTXNSVUZCUlN4SlFVRkpMRVZCUVVVc1NVRkJTU3hGUVVGRkxFOUJRVThzUlVGQlJTeGxRVUZsTEVWQlFVVXNSMEZCUnl4RlFVRkZMRWRCUVVjc1JVRkJSU3hEUVVGRExFTkJRVU03VVVGRE1VWXNTVUZCU1N4RFFVRkRMRlZCUVZVc1EwRkJReXhKUVVGSkxFTkJRVU1zVlVGQlZTeERRVUZETEVOQlFVTTdTVUZEYmtNc1EwRkJRenRKUVVWRUxHdERRVUZyUXp0SlFVTTFRaXhaUVVGWkxFTkJRVU1zVlVGQmEwSXNSVUZCUlN4UlFVRlJMRWRCUVVjc1NVRkJTVHM3V1VGRGNFUXNTVUZCU1R0blFrRkRSaXhOUVVGTkxFdEJRVXNzUjBGRFZDeHBaVUZCYVdVc1EwRkJRenRuUWtGRGNHVXNUVUZCVFN4SlFVRkpMRWRCUVVjN2IwSkJRMWdzWVVGQllTeEZRVUZGTERoQ1FVRTRRanR2UWtGRE4wTXNTMEZCU3l4RlFVRkZMRXRCUVVzN2IwSkJRMW9zVTBGQlV5eEZRVUZGTzNkQ1FVTlVMRTFCUVUwc1JVRkJSU3hKUVVGSk8zZENRVU5hTEV0QlFVc3NSVUZCUlN4SlFVRkpMRU5CUVVNc1YwRkJWenQzUWtGRGRrSXNTMEZCU3l4RlFVRkZMRXRCUVVzN2QwSkJRMW9zUzBGQlN5eEZRVUZGTEVWQlFVVTdkMEpCUTFRc1ZVRkJWU3hGUVVGRkxGVkJRVlU3Y1VKQlEzWkNPMmxDUVVOR0xFTkJRVU03WjBKQlJVWXNUVUZCVFN4SFFVRkhMRWRCUVVjc1RVRkJUU3hOUVVGTkxFTkJRVU1zVDBGQlR5eERRVUZETERKQ1FVRXlRaXhGUVVGRk8yOUNRVU0xUkN4TlFVRk5MRVZCUVVVc1RVRkJUVHR2UWtGRFpDeFBRVUZQTEVWQlFVVXNSVUZCUlN4TlFVRk5MRVZCUVVVc1pVRkJaU3hGUVVGRkxGZEJRVmNzUlVGQlJTeG5RMEZCWjBNc1JVRkJSVHR2UWtGRGJrWXNTVUZCU1N4RlFVRkZMRWxCUVVrc1EwRkJReXhUUVVGVExFTkJRVU1zU1VGQlNTeERRVUZETzJsQ1FVTXpRaXhEUVVGRExFTkJRVU03WjBKQlEwZ3NUVUZCVFN4blFrRkJaMElzUjBGQlVTeE5RVUZOTEVkQlFVY3NRMEZCUXl4SlFVRkpMRVZCUVVVc1EwRkJRenRuUWtGRkwwTXNUVUZCVFN4TlFVRk5MRWRCUTFZc2MwTkJRWE5ETzI5Q1FVTjBReXhKUVVGSkxFTkJRVU1zUzBGQlN5eERRVUZETEVsQlFVa3NRMEZCUXl4TlFVRk5MRVZCUVVVc1IwRkJSeXhIUVVGSExFTkJRVU03YjBKQlF5OUNMR2RIUVVGblJ6dHZRa0ZEYUVjc1owSkJRV2RDTEVOQlFVTXNTVUZCU1N4RFFVRkRMSGxDUVVGNVFpeERRVUZETEZOQlFWTTdiMEpCUTNwRUxDdENRVUVyUWp0dlFrRkRMMElzWjBKQlFXZENMRU5CUVVNc1NVRkJTU3hEUVVGRExIbENRVUY1UWl4RFFVRkRMRXRCUVVzc1EwRkJRenRuUWtGRmVFUXNTVUZCU1N4RFFVRkRMRkZCUVZFN2IwSkJRVVVzVDBGQlR5eE5RVUZOTEVOQlFVTTdaMEpCUlRkQ0xFMUJRVTBzU1VGQlNTeEhRVUZITEUxQlFVMHNRMEZCUXl4TlFVRk5MRTFCUVUwc1EwRkJReXhQUVVGUExFTkJRVU1zTUVOQlFUQkRMRWRCUVVjc1NVRkJTU3hEUVVGRExGZEJRVmNzUjBGQlJ5eFJRVUZSTEVkQlFVY3NUVUZCVFN4RFFVRkRMRU5CUVVNc1EwRkJReXhKUVVGSkxFVkJRVVVzUTBGQlF6dG5Ra0ZGY0Vrc1VVRkJVU3hEUVVGRExHZENRVUZuUWl4SFFVRkhMRlZCUVZVc1EwRkJReXhEUVVGRE8yZENRVVY0UXl4SlFVRkpMRU5CUVVNc1dVRkJXU3hEUVVGRExFbEJRVWtzUlVGQlJTeFZRVUZWTEVOQlFVTXNRMEZCUXp0blFrRkZjRU1zVDBGQlR5eEpRVUZKTEVOQlFVTTdZVUZEWWp0WlFVRkRMRTlCUVU4c1EwRkJReXhGUVVGRk8yZENRVU5XTEZGQlFWRXNRMEZCUXl4RFFVRkRMRU5CUVVNc1EwRkJRenRuUWtGRFdpeFBRVUZQTEVWQlFVVXNRMEZCUXp0aFFVTllPMUZCUTBnc1EwRkJRenRMUVVGQk8wbEJSVVFzYTBOQlFXdERPMGxCUXpWQ0xIVkNRVUYxUWl4RFFVRkRMR05CUVhOQ096dFpRVU5zUkN4SlFVRkpPMmRDUVVOR0xFMUJRVTBzUzBGQlN5eEhRVU5VTEdsbFFVRnBaU3hEUVVGRE8yZENRVU53WlN4TlFVRk5MRWxCUVVrc1IwRkJSenR2UWtGRFdDeGhRVUZoTEVWQlFVVXNPRUpCUVRoQ08yOUNRVU0zUXl4TFFVRkxMRVZCUVVVc1MwRkJTenR2UWtGRFdpeFRRVUZUTEVWQlFVVTdkMEpCUTFRc1RVRkJUU3hGUVVGRkxFbEJRVWs3ZDBKQlExb3NTMEZCU3l4RlFVRkZMRWxCUVVrc1EwRkJReXhYUVVGWE8zZENRVU4yUWl4TFFVRkxMRVZCUVVVc1MwRkJTenQzUWtGRFdpeExRVUZMTEVWQlFVVXNSVUZCUlR0M1FrRkRWQ3hWUVVGVkxFVkJRVVVzYjBKQlFXOUNPM0ZDUVVOcVF6dHBRa0ZEUml4RFFVRkRPMmRDUVVWR0xFMUJRVTBzUjBGQlJ5eEhRVUZITEUxQlFVMHNUVUZCVFN4RFFVRkRMRTlCUVU4c1EwRkJReXd5UWtGQk1rSXNSVUZCUlR0dlFrRkROVVFzVFVGQlRTeEZRVUZGTEUxQlFVMDdiMEpCUTJRc1QwRkJUeXhGUVVGRkxFVkJRVVVzVFVGQlRTeEZRVUZGTEdWQlFXVXNSVUZCUlN4WFFVRlhMRVZCUVVVc1owTkJRV2RETEVWQlFVVTdiMEpCUTI1R0xFbEJRVWtzUlVGQlJTeEpRVUZKTEVOQlFVTXNVMEZCVXl4RFFVRkRMRWxCUVVrc1EwRkJRenRwUWtGRE0wSXNRMEZCUXl4RFFVRkRPMmRDUVVOSUxFMUJRVTBzWjBKQlFXZENMRWRCUVZFc1RVRkJUU3hIUVVGSExFTkJRVU1zU1VGQlNTeEZRVUZGTEVOQlFVTTdaMEpCUlM5RExFMUJRVTBzVFVGQlRTeEhRVU5XTEhORFFVRnpRenR2UWtGRGRFTXNTVUZCU1N4RFFVRkRMRXRCUVVzc1EwRkJReXhKUVVGSkxFTkJRVU1zVFVGQlRTeEZRVUZGTEVkQlFVY3NSMEZCUnl4RFFVRkRPMjlDUVVNdlFpeG5SMEZCWjBjN2IwSkJRMmhITEdkQ1FVRm5RaXhEUVVGRExFbEJRVWtzUTBGQlF5eDVRa0ZCZVVJc1EwRkJReXhUUVVGVE8yOUNRVU42UkN3clFrRkJLMEk3YjBKQlF5OUNMR2RDUVVGblFpeERRVUZETEVsQlFVa3NRMEZCUXl4NVFrRkJlVUlzUTBGQlF5eExRVUZMTEVOQlFVTTdaMEpCUlhoRUxFMUJRVTBzU1VGQlNTeEhRVUZITEUxQlFVMHNRMEZCUXl4TlFVRk5MRTFCUVUwc1EwRkJReXhQUVVGUExFTkJRVU1zTUVOQlFUQkRMRWRCUVVjc1NVRkJTU3hEUVVGRExGZEJRVmNzUjBGQlJ5eFJRVUZSTEVkQlFVY3NUVUZCVFN4RFFVRkRMRU5CUVVNc1EwRkJReXhKUVVGSkxFVkJRVVVzUTBGQlF6dG5Ra0ZGY0Vrc1NVRkJTU3hEUVVGRExGbEJRVmtzUTBGQlF5eEpRVUZKTEVWQlFVVXNkMEpCUVZVc1EwRkJReXhQUVVGUExFTkJRVU1zUTBGQlF6dG5Ra0ZGTlVNc1QwRkJUeXhKUVVGSkxFTkJRVU03WVVGRFlqdFpRVUZETEU5QlFVOHNRMEZCUXl4RlFVRkZPMmRDUVVOV0xGRkJRVkVzUTBGQlF5eERRVUZETEVOQlFVTXNRMEZCUXp0blFrRkRXaXhQUVVGUExFVkJRVVVzUTBGQlF6dGhRVU5ZTzFGQlEwZ3NRMEZCUXp0TFFVRkJPMGxCUlVRc2EwTkJRV3RETzBsQlF6VkNMR1ZCUVdVN08xbEJRMjVDTEZGQlFWRXNRMEZCUXl3d1FrRkJNRUlzUTBGQlF5eERRVUZETzFsQlJYSkRMRTFCUVUwc1NVRkJTU3hIUVVGSExFbEJRVWtzUTBGQlF5eFZRVUZWTEVOQlFVTXNSMEZCUnl4RFFVRkRMRU5CUVVNc1EwRkJReXhGUVVGRkxFVkJRVVVzUTBGQlF5eERRVUZETEVOQlFVTXNUMEZCVHl4RFFVRkRMR1ZCUVdVc1JVRkJSU3hKUVVGSkxFTkJRVU1zVjBGQlZ5eERRVUZETEVOQlFVTXNRMEZCUXp0WlFVVjBSaXhKUVVGSkxFTkJRVU1zVDBGQlR5eERRVUZETEVOQlFVOHNZVUZCWVN4RlFVRkZMRVZCUVVVN1owSkJRMjVETEVsQlFVazdiMEpCUTBZc1RVRkJUU3hSUVVGUkxFZEJRV0VzVFVGQlRTeE5RVUZOTEVOQlFVTXNUMEZCVHl4RFFVRkRMR0ZCUVdFc1EwRkJReXhEUVVGRE8yOUNRVU12UkN4SlFVRkpMRU5CUVVNc1VVRkJVU3hEUVVGRExFVkJRVVU3ZDBKQlFVVXNVVUZCVVN4RFFVRkRMREpDUVVFeVFpeEZRVUZGTEdGQlFXRXNSVUZCUlN4UlFVRlJMRU5CUVVNc1EwRkJRenR2UWtGRmFrWXNTVUZCU1N4RFFVRkRMRmxCUVZrc1EwRkJReXhOUVVGTkxGRkJRVkVzUTBGQlF5eEpRVUZKTEVWQlFVVXNSVUZCUlN4M1FrRkJWU3hEUVVGRExGRkJRVkVzUTBGQlF5eERRVUZETzI5Q1FVTTVSQ3hSUVVGUkxFTkJRVU1zY1VKQlFYRkNMRU5CUVVNc1EwRkJRenR2UWtGRGFFTXNUMEZCVHl4SlFVRkpMRU5CUVVNN2FVSkJRMkk3WjBKQlFVTXNUMEZCVHl4RFFVRkRMRVZCUVVVN2IwSkJRMVlzVVVGQlVTeERRVUZETERKQ1FVRXlRaXhGUVVGRkxHRkJRV0VzUlVGQlJTeERRVUZETEVOQlFVTXNRMEZCUXp0dlFrRkRlRVFzVDBGQlR5eExRVUZMTEVOQlFVTTdhVUpCUTJRN1dVRkRTQ3hEUVVGRExFTkJRVUVzUTBGQlF5eERRVUZETzFGQlEwd3NRMEZCUXp0TFFVRkJPMGxCUlVRc2EwTkJRV3RETzBsQlF6VkNMR2RDUVVGblFqczdXVUZEY0VJc1VVRkJVU3hEUVVGRExEUkNRVUUwUWl4RFFVRkRMRU5CUVVNN1dVRkZka01zVFVGQlRTeEhRVUZITEVkQlFVY3NTVUZCU1N4RFFVRkRMR0ZCUVdFc1EwRkJReXhEUVVGRExFTkJRVU1zUTBGQlF5eFBRVUZQTEVOQlFVTXNaVUZCWlN4RlFVRkZMRWxCUVVrc1EwRkJReXhYUVVGWExFTkJRVU1zUTBGQlF6dFpRVU0zUlN4TlFVRk5MRTFCUVUwc1IwRkJSeXhOUVVGTkxFbEJRVWtzUTBGQlF5eFpRVUZaTEVOQlFVTXNkMEpCUVZVc1EwRkJReXhKUVVGSkxFVkJRVVVzUzBGQlN5eERRVUZETEVOQlFVTTdXVUZETDBRc1RVRkJUU3hKUVVGSkxFZEJRVWNzVFVGQlRTeExRVUZMTEVOQlFVTXNSMEZCUnl4RlFVRkZMRVZCUVVVc1RVRkJUU3hGUVVGRkxFMUJRVTBzUlVGQlJTeEpRVUZKTEVWQlFVVXNUVUZCVFN4RlFVRkZMRU5CUVVNc1EwRkJRenRaUVVWb1JTeEpRVUZKTEVOQlFVTXNTVUZCU1N4RFFVRkRMRVZCUVVVc1JVRkJSVHRuUWtGRFdpeFJRVUZSTEVOQlFVTXNNa0pCUVRKQ0xFVkJRVVVzU1VGQlNTeERRVUZETEdGQlFXRXNRMEZCUXl4RFFVRkRMRU5CUVVNc1JVRkJSU3hKUVVGSkxFTkJRVU1zUTBGQlF6dG5Ra0ZEYmtVc1QwRkJUenRoUVVOU08xbEJSVVFzVFVGQlRTeEpRVUZKTEVkQlFVY3NUVUZCVFN4SlFVRkpMRU5CUVVNc1NVRkJTU3hGUVVGRkxFTkJRVU03V1VGRkwwSXNTVUZCU1N4RFFVRkRMRmxCUVZrc1EwRkJReXhKUVVGSkxFVkJRVVVzZDBKQlFWVXNRMEZCUXl4UlFVRlJMRU5CUVVNc1EwRkJRenRaUVVVM1F5eFJRVUZSTEVOQlFVTXNkVUpCUVhWQ0xFTkJRVU1zUTBGQlF6dFJRVU53UXl4RFFVRkRPMHRCUVVFN1NVRkZSQ3cwUWtGQk5FSTdTVUZEZEVJc2EwSkJRV3RDTEVOQlFVTXNUVUZCYTBJc1JVRkJSU3hqUVVGelFqczdXVUZEYWtVc1NVRkJTU3hOUVVGTkxFbEJRVWtzZDBKQlFWVXNRMEZCUXl4UlFVRlJMRVZCUVVVN1owSkJRMnBETEUxQlFVMHNTVUZCU1N4RFFVRkRMR2RDUVVGblFpeEZRVUZGTEVOQlFVTTdaMEpCUXpsQ0xFOUJRVTg3WVVGRFVqdFpRVVZFTEVsQlFVa3NUVUZCVFN4SlFVRkpMSGRDUVVGVkxFTkJRVU1zVDBGQlR5eEZRVUZGTzJkQ1FVTm9ReXhOUVVGTkxFbEJRVWtzUTBGQlF5eDFRa0ZCZFVJc1EwRkJReXhqUVVGakxFTkJRVU1zUTBGQlF6dG5Ra0ZEYmtRc1QwRkJUenRoUVVOU08xbEJSVVFzVFVGQlRTeEpRVUZKTEVOQlFVTXNXVUZCV1N4RFFVRkRMRTFCUVUwc1EwRkJReXhEUVVGRE8xRkJRMnhETEVOQlFVTTdTMEZCUVR0SlFVVkVMSEZDUVVGeFFpeERRVUZETEZWQlFYTkNPMUZCUXpGRExESkNRVUV5UWp0UlFVTXpRaXhOUVVGTkxFOUJRVThzUjBGQlJ5eEpRVUZKTEVOQlFVTXNWVUZCVlN4RFFVRkRMRTFCUVUwc1EwRkJReXhEUVVGRExFTkJRVU1zUlVGQlJTeEZRVUZGTEVOQlFVTXNRMEZCUXl4RFFVRkRMRWxCUVVrc1NVRkJTU3hWUVVGVkxFTkJRVU1zUTBGQlF6dFJRVU53UlN4SlFVRkpMRU5CUVVNc1QwRkJUenRaUVVGRkxFOUJRVThzUlVGQlJTeERRVUZETzFGQlJYaENMRTlCUVU4c1QwRkJUeXhEUVVGRE8wbEJRMnBDTEVOQlFVTTdRMEZEUmp0QlFUTk1SQ3gzUWtFeVRFTWlmUT09IiwiaW1wb3J0IHdpbmRvdyBmcm9tICdnbG9iYWwvd2luZG93JztcblxudmFyIGF0b2IgPSBmdW5jdGlvbiBhdG9iKHMpIHtcbiAgcmV0dXJuIHdpbmRvdy5hdG9iID8gd2luZG93LmF0b2IocykgOiBCdWZmZXIuZnJvbShzLCAnYmFzZTY0JykudG9TdHJpbmcoJ2JpbmFyeScpO1xufTtcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZGVjb2RlQjY0VG9VaW50OEFycmF5KGI2NFRleHQpIHtcbiAgdmFyIGRlY29kZWRTdHJpbmcgPSBhdG9iKGI2NFRleHQpO1xuICB2YXIgYXJyYXkgPSBuZXcgVWludDhBcnJheShkZWNvZGVkU3RyaW5nLmxlbmd0aCk7XG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBkZWNvZGVkU3RyaW5nLmxlbmd0aDsgaSsrKSB7XG4gICAgYXJyYXlbaV0gPSBkZWNvZGVkU3RyaW5nLmNoYXJDb2RlQXQoaSk7XG4gIH1cblxuICByZXR1cm4gYXJyYXk7XG59IiwiLyoqXG4gKiBAZmlsZSBzdHJlYW0uanNcbiAqL1xuXG4vKipcbiAqIEEgbGlnaHR3ZWlnaHQgcmVhZGFibGUgc3RyZWFtIGltcGxlbWVudGlvbiB0aGF0IGhhbmRsZXMgZXZlbnQgZGlzcGF0Y2hpbmcuXG4gKlxuICogQGNsYXNzIFN0cmVhbVxuICovXG52YXIgU3RyZWFtID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gU3RyZWFtKCkge1xuICAgIHRoaXMubGlzdGVuZXJzID0ge307XG4gIH1cbiAgLyoqXG4gICAqIEFkZCBhIGxpc3RlbmVyIGZvciBhIHNwZWNpZmllZCBldmVudCB0eXBlLlxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gdHlwZSB0aGUgZXZlbnQgbmFtZVxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBsaXN0ZW5lciB0aGUgY2FsbGJhY2sgdG8gYmUgaW52b2tlZCB3aGVuIGFuIGV2ZW50IG9mXG4gICAqIHRoZSBzcGVjaWZpZWQgdHlwZSBvY2N1cnNcbiAgICovXG5cblxuICB2YXIgX3Byb3RvID0gU3RyZWFtLnByb3RvdHlwZTtcblxuICBfcHJvdG8ub24gPSBmdW5jdGlvbiBvbih0eXBlLCBsaXN0ZW5lcikge1xuICAgIGlmICghdGhpcy5saXN0ZW5lcnNbdHlwZV0pIHtcbiAgICAgIHRoaXMubGlzdGVuZXJzW3R5cGVdID0gW107XG4gICAgfVxuXG4gICAgdGhpcy5saXN0ZW5lcnNbdHlwZV0ucHVzaChsaXN0ZW5lcik7XG4gIH1cbiAgLyoqXG4gICAqIFJlbW92ZSBhIGxpc3RlbmVyIGZvciBhIHNwZWNpZmllZCBldmVudCB0eXBlLlxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gdHlwZSB0aGUgZXZlbnQgbmFtZVxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBsaXN0ZW5lciAgYSBmdW5jdGlvbiBwcmV2aW91c2x5IHJlZ2lzdGVyZWQgZm9yIHRoaXNcbiAgICogdHlwZSBvZiBldmVudCB0aHJvdWdoIGBvbmBcbiAgICogQHJldHVybiB7Ym9vbGVhbn0gaWYgd2UgY291bGQgdHVybiBpdCBvZmYgb3Igbm90XG4gICAqL1xuICA7XG5cbiAgX3Byb3RvLm9mZiA9IGZ1bmN0aW9uIG9mZih0eXBlLCBsaXN0ZW5lcikge1xuICAgIGlmICghdGhpcy5saXN0ZW5lcnNbdHlwZV0pIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICB2YXIgaW5kZXggPSB0aGlzLmxpc3RlbmVyc1t0eXBlXS5pbmRleE9mKGxpc3RlbmVyKTsgLy8gVE9ETzogd2hpY2ggaXMgYmV0dGVyP1xuICAgIC8vIEluIFZpZGVvLmpzIHdlIHNsaWNlIGxpc3RlbmVyIGZ1bmN0aW9uc1xuICAgIC8vIG9uIHRyaWdnZXIgc28gdGhhdCBpdCBkb2VzIG5vdCBtZXNzIHVwIHRoZSBvcmRlclxuICAgIC8vIHdoaWxlIHdlIGxvb3AgdGhyb3VnaC5cbiAgICAvL1xuICAgIC8vIEhlcmUgd2Ugc2xpY2Ugb24gb2ZmIHNvIHRoYXQgdGhlIGxvb3AgaW4gdHJpZ2dlclxuICAgIC8vIGNhbiBjb250aW51ZSB1c2luZyBpdCdzIG9sZCByZWZlcmVuY2UgdG8gbG9vcCB3aXRob3V0XG4gICAgLy8gbWVzc2luZyB1cCB0aGUgb3JkZXIuXG5cbiAgICB0aGlzLmxpc3RlbmVyc1t0eXBlXSA9IHRoaXMubGlzdGVuZXJzW3R5cGVdLnNsaWNlKDApO1xuICAgIHRoaXMubGlzdGVuZXJzW3R5cGVdLnNwbGljZShpbmRleCwgMSk7XG4gICAgcmV0dXJuIGluZGV4ID4gLTE7XG4gIH1cbiAgLyoqXG4gICAqIFRyaWdnZXIgYW4gZXZlbnQgb2YgdGhlIHNwZWNpZmllZCB0eXBlIG9uIHRoaXMgc3RyZWFtLiBBbnkgYWRkaXRpb25hbFxuICAgKiBhcmd1bWVudHMgdG8gdGhpcyBmdW5jdGlvbiBhcmUgcGFzc2VkIGFzIHBhcmFtZXRlcnMgdG8gZXZlbnQgbGlzdGVuZXJzLlxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gdHlwZSB0aGUgZXZlbnQgbmFtZVxuICAgKi9cbiAgO1xuXG4gIF9wcm90by50cmlnZ2VyID0gZnVuY3Rpb24gdHJpZ2dlcih0eXBlKSB7XG4gICAgdmFyIGNhbGxiYWNrcyA9IHRoaXMubGlzdGVuZXJzW3R5cGVdO1xuXG4gICAgaWYgKCFjYWxsYmFja3MpIHtcbiAgICAgIHJldHVybjtcbiAgICB9IC8vIFNsaWNpbmcgdGhlIGFyZ3VtZW50cyBvbiBldmVyeSBpbnZvY2F0aW9uIG9mIHRoaXMgbWV0aG9kXG4gICAgLy8gY2FuIGFkZCBhIHNpZ25pZmljYW50IGFtb3VudCBvZiBvdmVyaGVhZC4gQXZvaWQgdGhlXG4gICAgLy8gaW50ZXJtZWRpYXRlIG9iamVjdCBjcmVhdGlvbiBmb3IgdGhlIGNvbW1vbiBjYXNlIG9mIGFcbiAgICAvLyBzaW5nbGUgY2FsbGJhY2sgYXJndW1lbnRcblxuXG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDIpIHtcbiAgICAgIHZhciBsZW5ndGggPSBjYWxsYmFja3MubGVuZ3RoO1xuXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7XG4gICAgICAgIGNhbGxiYWNrc1tpXS5jYWxsKHRoaXMsIGFyZ3VtZW50c1sxXSk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhciBhcmdzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKTtcbiAgICAgIHZhciBfbGVuZ3RoID0gY2FsbGJhY2tzLmxlbmd0aDtcblxuICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IF9sZW5ndGg7ICsrX2kpIHtcbiAgICAgICAgY2FsbGJhY2tzW19pXS5hcHBseSh0aGlzLCBhcmdzKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgLyoqXG4gICAqIERlc3Ryb3lzIHRoZSBzdHJlYW0gYW5kIGNsZWFucyB1cC5cbiAgICovXG4gIDtcblxuICBfcHJvdG8uZGlzcG9zZSA9IGZ1bmN0aW9uIGRpc3Bvc2UoKSB7XG4gICAgdGhpcy5saXN0ZW5lcnMgPSB7fTtcbiAgfVxuICAvKipcbiAgICogRm9yd2FyZHMgYWxsIGBkYXRhYCBldmVudHMgb24gdGhpcyBzdHJlYW0gdG8gdGhlIGRlc3RpbmF0aW9uIHN0cmVhbS4gVGhlXG4gICAqIGRlc3RpbmF0aW9uIHN0cmVhbSBzaG91bGQgcHJvdmlkZSBhIG1ldGhvZCBgcHVzaGAgdG8gcmVjZWl2ZSB0aGUgZGF0YVxuICAgKiBldmVudHMgYXMgdGhleSBhcnJpdmUuXG4gICAqXG4gICAqIEBwYXJhbSB7U3RyZWFtfSBkZXN0aW5hdGlvbiB0aGUgc3RyZWFtIHRoYXQgd2lsbCByZWNlaXZlIGFsbCBgZGF0YWAgZXZlbnRzXG4gICAqIEBzZWUgaHR0cDovL25vZGVqcy5vcmcvYXBpL3N0cmVhbS5odG1sI3N0cmVhbV9yZWFkYWJsZV9waXBlX2Rlc3RpbmF0aW9uX29wdGlvbnNcbiAgICovXG4gIDtcblxuICBfcHJvdG8ucGlwZSA9IGZ1bmN0aW9uIHBpcGUoZGVzdGluYXRpb24pIHtcbiAgICB0aGlzLm9uKCdkYXRhJywgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgIGRlc3RpbmF0aW9uLnB1c2goZGF0YSk7XG4gICAgfSk7XG4gIH07XG5cbiAgcmV0dXJuIFN0cmVhbTtcbn0oKTtcblxuZXhwb3J0IHsgU3RyZWFtIGFzIGRlZmF1bHQgfTsiLCJ2YXIgd2luO1xuXG5pZiAodHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgIHdpbiA9IHdpbmRvdztcbn0gZWxzZSBpZiAodHlwZW9mIGdsb2JhbCAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgIHdpbiA9IGdsb2JhbDtcbn0gZWxzZSBpZiAodHlwZW9mIHNlbGYgIT09IFwidW5kZWZpbmVkXCIpe1xuICAgIHdpbiA9IHNlbGY7XG59IGVsc2Uge1xuICAgIHdpbiA9IHt9O1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHdpbjtcbiIsIi8qISBAbmFtZSBtM3U4LXBhcnNlciBAdmVyc2lvbiA2LjAuMCBAbGljZW5zZSBBcGFjaGUtMi4wICovXG5pbXBvcnQgU3RyZWFtIGZyb20gJ0B2aWRlb2pzL3Zocy11dGlscy9lcy9zdHJlYW0uanMnO1xuaW1wb3J0IF9leHRlbmRzIGZyb20gJ0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXh0ZW5kcyc7XG5pbXBvcnQgZGVjb2RlQjY0VG9VaW50OEFycmF5IGZyb20gJ0B2aWRlb2pzL3Zocy11dGlscy9lcy9kZWNvZGUtYjY0LXRvLXVpbnQ4LWFycmF5LmpzJztcblxuLyoqXG4gKiBAZmlsZSBtM3U4L2xpbmUtc3RyZWFtLmpzXG4gKi9cbi8qKlxuICogQSBzdHJlYW0gdGhhdCBidWZmZXJzIHN0cmluZyBpbnB1dCBhbmQgZ2VuZXJhdGVzIGEgYGRhdGFgIGV2ZW50IGZvciBlYWNoXG4gKiBsaW5lLlxuICpcbiAqIEBjbGFzcyBMaW5lU3RyZWFtXG4gKiBAZXh0ZW5kcyBTdHJlYW1cbiAqL1xuXG5jbGFzcyBMaW5lU3RyZWFtIGV4dGVuZHMgU3RyZWFtIHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoKTtcbiAgICB0aGlzLmJ1ZmZlciA9ICcnO1xuICB9XG4gIC8qKlxuICAgKiBBZGQgbmV3IGRhdGEgdG8gYmUgcGFyc2VkLlxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gZGF0YSB0aGUgdGV4dCB0byBwcm9jZXNzXG4gICAqL1xuXG5cbiAgcHVzaChkYXRhKSB7XG4gICAgbGV0IG5leHROZXdsaW5lO1xuICAgIHRoaXMuYnVmZmVyICs9IGRhdGE7XG4gICAgbmV4dE5ld2xpbmUgPSB0aGlzLmJ1ZmZlci5pbmRleE9mKCdcXG4nKTtcblxuICAgIGZvciAoOyBuZXh0TmV3bGluZSA+IC0xOyBuZXh0TmV3bGluZSA9IHRoaXMuYnVmZmVyLmluZGV4T2YoJ1xcbicpKSB7XG4gICAgICB0aGlzLnRyaWdnZXIoJ2RhdGEnLCB0aGlzLmJ1ZmZlci5zdWJzdHJpbmcoMCwgbmV4dE5ld2xpbmUpKTtcbiAgICAgIHRoaXMuYnVmZmVyID0gdGhpcy5idWZmZXIuc3Vic3RyaW5nKG5leHROZXdsaW5lICsgMSk7XG4gICAgfVxuICB9XG5cbn1cblxuY29uc3QgVEFCID0gU3RyaW5nLmZyb21DaGFyQ29kZSgweDA5KTtcblxuY29uc3QgcGFyc2VCeXRlcmFuZ2UgPSBmdW5jdGlvbiAoYnl0ZXJhbmdlU3RyaW5nKSB7XG4gIC8vIG9wdGlvbmFsbHkgbWF0Y2ggYW5kIGNhcHR1cmUgMCsgZGlnaXRzIGJlZm9yZSBgQGBcbiAgLy8gb3B0aW9uYWxseSBtYXRjaCBhbmQgY2FwdHVyZSAwKyBkaWdpdHMgYWZ0ZXIgYEBgXG4gIGNvbnN0IG1hdGNoID0gLyhbMC05Ll0qKT9APyhbMC05Ll0qKT8vLmV4ZWMoYnl0ZXJhbmdlU3RyaW5nIHx8ICcnKTtcbiAgY29uc3QgcmVzdWx0ID0ge307XG5cbiAgaWYgKG1hdGNoWzFdKSB7XG4gICAgcmVzdWx0Lmxlbmd0aCA9IHBhcnNlSW50KG1hdGNoWzFdLCAxMCk7XG4gIH1cblxuICBpZiAobWF0Y2hbMl0pIHtcbiAgICByZXN1bHQub2Zmc2V0ID0gcGFyc2VJbnQobWF0Y2hbMl0sIDEwKTtcbiAgfVxuXG4gIHJldHVybiByZXN1bHQ7XG59O1xuLyoqXG4gKiBcImZvcmdpdmluZ1wiIGF0dHJpYnV0ZSBsaXN0IHBzdWVkby1ncmFtbWFyOlxuICogYXR0cmlidXRlcyAtPiBrZXl2YWx1ZSAoJywnIGtleXZhbHVlKSpcbiAqIGtleXZhbHVlICAgLT4ga2V5ICc9JyB2YWx1ZVxuICoga2V5ICAgICAgICAtPiBbXj1dKlxuICogdmFsdWUgICAgICAtPiAnXCInIFteXCJdKiAnXCInIHwgW14sXSpcbiAqL1xuXG5cbmNvbnN0IGF0dHJpYnV0ZVNlcGFyYXRvciA9IGZ1bmN0aW9uICgpIHtcbiAgY29uc3Qga2V5ID0gJ1tePV0qJztcbiAgY29uc3QgdmFsdWUgPSAnXCJbXlwiXSpcInxbXixdKic7XG4gIGNvbnN0IGtleXZhbHVlID0gJyg/OicgKyBrZXkgKyAnKT0oPzonICsgdmFsdWUgKyAnKSc7XG4gIHJldHVybiBuZXcgUmVnRXhwKCcoPzpefCwpKCcgKyBrZXl2YWx1ZSArICcpJyk7XG59O1xuLyoqXG4gKiBQYXJzZSBhdHRyaWJ1dGVzIGZyb20gYSBsaW5lIGdpdmVuIHRoZSBzZXBhcmF0b3JcbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gYXR0cmlidXRlcyB0aGUgYXR0cmlidXRlIGxpbmUgdG8gcGFyc2VcbiAqL1xuXG5cbmNvbnN0IHBhcnNlQXR0cmlidXRlcyA9IGZ1bmN0aW9uIChhdHRyaWJ1dGVzKSB7XG4gIGNvbnN0IHJlc3VsdCA9IHt9O1xuXG4gIGlmICghYXR0cmlidXRlcykge1xuICAgIHJldHVybiByZXN1bHQ7XG4gIH0gLy8gc3BsaXQgdGhlIHN0cmluZyB1c2luZyBhdHRyaWJ1dGVzIGFzIHRoZSBzZXBhcmF0b3JcblxuXG4gIGNvbnN0IGF0dHJzID0gYXR0cmlidXRlcy5zcGxpdChhdHRyaWJ1dGVTZXBhcmF0b3IoKSk7XG4gIGxldCBpID0gYXR0cnMubGVuZ3RoO1xuICBsZXQgYXR0cjtcblxuICB3aGlsZSAoaS0tKSB7XG4gICAgLy8gZmlsdGVyIG91dCB1bm1hdGNoZWQgcG9ydGlvbnMgb2YgdGhlIHN0cmluZ1xuICAgIGlmIChhdHRyc1tpXSA9PT0gJycpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH0gLy8gc3BsaXQgdGhlIGtleSBhbmQgdmFsdWVcblxuXG4gICAgYXR0ciA9IC8oW149XSopPSguKikvLmV4ZWMoYXR0cnNbaV0pLnNsaWNlKDEpOyAvLyB0cmltIHdoaXRlc3BhY2UgYW5kIHJlbW92ZSBvcHRpb25hbCBxdW90ZXMgYXJvdW5kIHRoZSB2YWx1ZVxuXG4gICAgYXR0clswXSA9IGF0dHJbMF0ucmVwbGFjZSgvXlxccyt8XFxzKyQvZywgJycpO1xuICAgIGF0dHJbMV0gPSBhdHRyWzFdLnJlcGxhY2UoL15cXHMrfFxccyskL2csICcnKTtcbiAgICBhdHRyWzFdID0gYXR0clsxXS5yZXBsYWNlKC9eWydcIl0oLiopWydcIl0kL2csICckMScpO1xuICAgIHJlc3VsdFthdHRyWzBdXSA9IGF0dHJbMV07XG4gIH1cblxuICByZXR1cm4gcmVzdWx0O1xufTtcbi8qKlxuICogQSBsaW5lLWxldmVsIE0zVTggcGFyc2VyIGV2ZW50IHN0cmVhbS4gSXQgZXhwZWN0cyB0byByZWNlaXZlIGlucHV0IG9uZVxuICogbGluZSBhdCBhIHRpbWUgYW5kIHBlcmZvcm1zIGEgY29udGV4dC1mcmVlIHBhcnNlIG9mIGl0cyBjb250ZW50cy4gQSBzdHJlYW1cbiAqIGludGVycHJldGF0aW9uIG9mIGEgbWFuaWZlc3QgY2FuIGJlIHVzZWZ1bCBpZiB0aGUgbWFuaWZlc3QgaXMgZXhwZWN0ZWQgdG9cbiAqIGJlIHRvbyBsYXJnZSB0byBmaXQgY29tZm9ydGFibHkgaW50byBtZW1vcnkgb3IgdGhlIGVudGlyZXR5IG9mIHRoZSBpbnB1dFxuICogaXMgbm90IGltbWVkaWF0ZWx5IGF2YWlsYWJsZS4gT3RoZXJ3aXNlLCBpdCdzIHByb2JhYmx5IG11Y2ggZWFzaWVyIHRvIHdvcmtcbiAqIHdpdGggYSByZWd1bGFyIGBQYXJzZXJgIG9iamVjdC5cbiAqXG4gKiBQcm9kdWNlcyBgZGF0YWAgZXZlbnRzIHdpdGggYW4gb2JqZWN0IHRoYXQgY2FwdHVyZXMgdGhlIHBhcnNlcidzXG4gKiBpbnRlcnByZXRhdGlvbiBvZiB0aGUgaW5wdXQuIFRoYXQgb2JqZWN0IGhhcyBhIHByb3BlcnR5IGB0YWdgIHRoYXQgaXMgb25lXG4gKiBvZiBgdXJpYCwgYGNvbW1lbnRgLCBvciBgdGFnYC4gVVJJcyBvbmx5IGhhdmUgYSBzaW5nbGUgYWRkaXRpb25hbFxuICogcHJvcGVydHksIGBsaW5lYCwgd2hpY2ggY2FwdHVyZXMgdGhlIGVudGlyZXR5IG9mIHRoZSBpbnB1dCB3aXRob3V0XG4gKiBpbnRlcnByZXRhdGlvbi4gQ29tbWVudHMgc2ltaWxhcmx5IGhhdmUgYSBzaW5nbGUgYWRkaXRpb25hbCBwcm9wZXJ0eVxuICogYHRleHRgIHdoaWNoIGlzIHRoZSBpbnB1dCB3aXRob3V0IHRoZSBsZWFkaW5nIGAjYC5cbiAqXG4gKiBUYWdzIGFsd2F5cyBoYXZlIGEgcHJvcGVydHkgYHRhZ1R5cGVgIHdoaWNoIGlzIHRoZSBsb3dlci1jYXNlZCB2ZXJzaW9uIG9mXG4gKiB0aGUgTTNVOCBkaXJlY3RpdmUgd2l0aG91dCB0aGUgYCNFWFRgIG9yIGAjRVhULVgtYCBwcmVmaXguIEZvciBpbnN0YW5jZSxcbiAqIGAjRVhULVgtTUVESUEtU0VRVUVOQ0VgIGJlY29tZXMgYG1lZGlhLXNlcXVlbmNlYCB3aGVuIHBhcnNlZC4gVW5yZWNvZ25pemVkXG4gKiB0YWdzIGFyZSBnaXZlbiB0aGUgdGFnIHR5cGUgYHVua25vd25gIGFuZCBhIHNpbmdsZSBhZGRpdGlvbmFsIHByb3BlcnR5XG4gKiBgZGF0YWAgd2l0aCB0aGUgcmVtYWluZGVyIG9mIHRoZSBpbnB1dC5cbiAqXG4gKiBAY2xhc3MgUGFyc2VTdHJlYW1cbiAqIEBleHRlbmRzIFN0cmVhbVxuICovXG5cblxuY2xhc3MgUGFyc2VTdHJlYW0gZXh0ZW5kcyBTdHJlYW0ge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlcigpO1xuICAgIHRoaXMuY3VzdG9tUGFyc2VycyA9IFtdO1xuICAgIHRoaXMudGFnTWFwcGVycyA9IFtdO1xuICB9XG4gIC8qKlxuICAgKiBQYXJzZXMgYW4gYWRkaXRpb25hbCBsaW5lIG9mIGlucHV0LlxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gbGluZSBhIHNpbmdsZSBsaW5lIG9mIGFuIE0zVTggZmlsZSB0byBwYXJzZVxuICAgKi9cblxuXG4gIHB1c2gobGluZSkge1xuICAgIGxldCBtYXRjaDtcbiAgICBsZXQgZXZlbnQ7IC8vIHN0cmlwIHdoaXRlc3BhY2VcblxuICAgIGxpbmUgPSBsaW5lLnRyaW0oKTtcblxuICAgIGlmIChsaW5lLmxlbmd0aCA9PT0gMCkge1xuICAgICAgLy8gaWdub3JlIGVtcHR5IGxpbmVzXG4gICAgICByZXR1cm47XG4gICAgfSAvLyBVUklzXG5cblxuICAgIGlmIChsaW5lWzBdICE9PSAnIycpIHtcbiAgICAgIHRoaXMudHJpZ2dlcignZGF0YScsIHtcbiAgICAgICAgdHlwZTogJ3VyaScsXG4gICAgICAgIHVyaTogbGluZVxuICAgICAgfSk7XG4gICAgICByZXR1cm47XG4gICAgfSAvLyBtYXAgdGFnc1xuXG5cbiAgICBjb25zdCBuZXdMaW5lcyA9IHRoaXMudGFnTWFwcGVycy5yZWR1Y2UoKGFjYywgbWFwcGVyKSA9PiB7XG4gICAgICBjb25zdCBtYXBwZWRMaW5lID0gbWFwcGVyKGxpbmUpOyAvLyBza2lwIGlmIHVuY2hhbmdlZFxuXG4gICAgICBpZiAobWFwcGVkTGluZSA9PT0gbGluZSkge1xuICAgICAgICByZXR1cm4gYWNjO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gYWNjLmNvbmNhdChbbWFwcGVkTGluZV0pO1xuICAgIH0sIFtsaW5lXSk7XG4gICAgbmV3TGluZXMuZm9yRWFjaChuZXdMaW5lID0+IHtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5jdXN0b21QYXJzZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmICh0aGlzLmN1c3RvbVBhcnNlcnNbaV0uY2FsbCh0aGlzLCBuZXdMaW5lKSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgfSAvLyBDb21tZW50c1xuXG5cbiAgICAgIGlmIChuZXdMaW5lLmluZGV4T2YoJyNFWFQnKSAhPT0gMCkge1xuICAgICAgICB0aGlzLnRyaWdnZXIoJ2RhdGEnLCB7XG4gICAgICAgICAgdHlwZTogJ2NvbW1lbnQnLFxuICAgICAgICAgIHRleHQ6IG5ld0xpbmUuc2xpY2UoMSlcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH0gLy8gc3RyaXAgb2ZmIGFueSBjYXJyaWFnZSByZXR1cm5zIGhlcmUgc28gdGhlIHJlZ2V4IG1hdGNoaW5nXG4gICAgICAvLyBkb2Vzbid0IGhhdmUgdG8gYWNjb3VudCBmb3IgdGhlbS5cblxuXG4gICAgICBuZXdMaW5lID0gbmV3TGluZS5yZXBsYWNlKCdcXHInLCAnJyk7IC8vIFRhZ3NcblxuICAgICAgbWF0Y2ggPSAvXiNFWFRNM1UvLmV4ZWMobmV3TGluZSk7XG5cbiAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICB0aGlzLnRyaWdnZXIoJ2RhdGEnLCB7XG4gICAgICAgICAgdHlwZTogJ3RhZycsXG4gICAgICAgICAgdGFnVHlwZTogJ20zdSdcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgbWF0Y2ggPSAvXiNFWFRJTkY6KFswLTlcXC5dKik/LD8oLiopPyQvLmV4ZWMobmV3TGluZSk7XG5cbiAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICBldmVudCA9IHtcbiAgICAgICAgICB0eXBlOiAndGFnJyxcbiAgICAgICAgICB0YWdUeXBlOiAnaW5mJ1xuICAgICAgICB9O1xuXG4gICAgICAgIGlmIChtYXRjaFsxXSkge1xuICAgICAgICAgIGV2ZW50LmR1cmF0aW9uID0gcGFyc2VGbG9hdChtYXRjaFsxXSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAobWF0Y2hbMl0pIHtcbiAgICAgICAgICBldmVudC50aXRsZSA9IG1hdGNoWzJdO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy50cmlnZ2VyKCdkYXRhJywgZXZlbnQpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIG1hdGNoID0gL14jRVhULVgtVEFSR0VURFVSQVRJT046KFswLTkuXSopPy8uZXhlYyhuZXdMaW5lKTtcblxuICAgICAgaWYgKG1hdGNoKSB7XG4gICAgICAgIGV2ZW50ID0ge1xuICAgICAgICAgIHR5cGU6ICd0YWcnLFxuICAgICAgICAgIHRhZ1R5cGU6ICd0YXJnZXRkdXJhdGlvbidcbiAgICAgICAgfTtcblxuICAgICAgICBpZiAobWF0Y2hbMV0pIHtcbiAgICAgICAgICBldmVudC5kdXJhdGlvbiA9IHBhcnNlSW50KG1hdGNoWzFdLCAxMCk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnRyaWdnZXIoJ2RhdGEnLCBldmVudCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgbWF0Y2ggPSAvXiNFWFQtWC1WRVJTSU9OOihbMC05Ll0qKT8vLmV4ZWMobmV3TGluZSk7XG5cbiAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICBldmVudCA9IHtcbiAgICAgICAgICB0eXBlOiAndGFnJyxcbiAgICAgICAgICB0YWdUeXBlOiAndmVyc2lvbidcbiAgICAgICAgfTtcblxuICAgICAgICBpZiAobWF0Y2hbMV0pIHtcbiAgICAgICAgICBldmVudC52ZXJzaW9uID0gcGFyc2VJbnQobWF0Y2hbMV0sIDEwKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMudHJpZ2dlcignZGF0YScsIGV2ZW50KTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBtYXRjaCA9IC9eI0VYVC1YLU1FRElBLVNFUVVFTkNFOihcXC0/WzAtOS5dKik/Ly5leGVjKG5ld0xpbmUpO1xuXG4gICAgICBpZiAobWF0Y2gpIHtcbiAgICAgICAgZXZlbnQgPSB7XG4gICAgICAgICAgdHlwZTogJ3RhZycsXG4gICAgICAgICAgdGFnVHlwZTogJ21lZGlhLXNlcXVlbmNlJ1xuICAgICAgICB9O1xuXG4gICAgICAgIGlmIChtYXRjaFsxXSkge1xuICAgICAgICAgIGV2ZW50Lm51bWJlciA9IHBhcnNlSW50KG1hdGNoWzFdLCAxMCk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnRyaWdnZXIoJ2RhdGEnLCBldmVudCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgbWF0Y2ggPSAvXiNFWFQtWC1ESVNDT05USU5VSVRZLVNFUVVFTkNFOihcXC0/WzAtOS5dKik/Ly5leGVjKG5ld0xpbmUpO1xuXG4gICAgICBpZiAobWF0Y2gpIHtcbiAgICAgICAgZXZlbnQgPSB7XG4gICAgICAgICAgdHlwZTogJ3RhZycsXG4gICAgICAgICAgdGFnVHlwZTogJ2Rpc2NvbnRpbnVpdHktc2VxdWVuY2UnXG4gICAgICAgIH07XG5cbiAgICAgICAgaWYgKG1hdGNoWzFdKSB7XG4gICAgICAgICAgZXZlbnQubnVtYmVyID0gcGFyc2VJbnQobWF0Y2hbMV0sIDEwKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMudHJpZ2dlcignZGF0YScsIGV2ZW50KTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBtYXRjaCA9IC9eI0VYVC1YLVBMQVlMSVNULVRZUEU6KC4qKT8kLy5leGVjKG5ld0xpbmUpO1xuXG4gICAgICBpZiAobWF0Y2gpIHtcbiAgICAgICAgZXZlbnQgPSB7XG4gICAgICAgICAgdHlwZTogJ3RhZycsXG4gICAgICAgICAgdGFnVHlwZTogJ3BsYXlsaXN0LXR5cGUnXG4gICAgICAgIH07XG5cbiAgICAgICAgaWYgKG1hdGNoWzFdKSB7XG4gICAgICAgICAgZXZlbnQucGxheWxpc3RUeXBlID0gbWF0Y2hbMV07XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnRyaWdnZXIoJ2RhdGEnLCBldmVudCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgbWF0Y2ggPSAvXiNFWFQtWC1CWVRFUkFOR0U6KC4qKT8kLy5leGVjKG5ld0xpbmUpO1xuXG4gICAgICBpZiAobWF0Y2gpIHtcbiAgICAgICAgZXZlbnQgPSBfZXh0ZW5kcyhwYXJzZUJ5dGVyYW5nZShtYXRjaFsxXSksIHtcbiAgICAgICAgICB0eXBlOiAndGFnJyxcbiAgICAgICAgICB0YWdUeXBlOiAnYnl0ZXJhbmdlJ1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy50cmlnZ2VyKCdkYXRhJywgZXZlbnQpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIG1hdGNoID0gL14jRVhULVgtQUxMT1ctQ0FDSEU6KFlFU3xOTyk/Ly5leGVjKG5ld0xpbmUpO1xuXG4gICAgICBpZiAobWF0Y2gpIHtcbiAgICAgICAgZXZlbnQgPSB7XG4gICAgICAgICAgdHlwZTogJ3RhZycsXG4gICAgICAgICAgdGFnVHlwZTogJ2FsbG93LWNhY2hlJ1xuICAgICAgICB9O1xuXG4gICAgICAgIGlmIChtYXRjaFsxXSkge1xuICAgICAgICAgIGV2ZW50LmFsbG93ZWQgPSAhL05PLy50ZXN0KG1hdGNoWzFdKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMudHJpZ2dlcignZGF0YScsIGV2ZW50KTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBtYXRjaCA9IC9eI0VYVC1YLU1BUDooLiopJC8uZXhlYyhuZXdMaW5lKTtcblxuICAgICAgaWYgKG1hdGNoKSB7XG4gICAgICAgIGV2ZW50ID0ge1xuICAgICAgICAgIHR5cGU6ICd0YWcnLFxuICAgICAgICAgIHRhZ1R5cGU6ICdtYXAnXG4gICAgICAgIH07XG5cbiAgICAgICAgaWYgKG1hdGNoWzFdKSB7XG4gICAgICAgICAgY29uc3QgYXR0cmlidXRlcyA9IHBhcnNlQXR0cmlidXRlcyhtYXRjaFsxXSk7XG5cbiAgICAgICAgICBpZiAoYXR0cmlidXRlcy5VUkkpIHtcbiAgICAgICAgICAgIGV2ZW50LnVyaSA9IGF0dHJpYnV0ZXMuVVJJO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmIChhdHRyaWJ1dGVzLkJZVEVSQU5HRSkge1xuICAgICAgICAgICAgZXZlbnQuYnl0ZXJhbmdlID0gcGFyc2VCeXRlcmFuZ2UoYXR0cmlidXRlcy5CWVRFUkFOR0UpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMudHJpZ2dlcignZGF0YScsIGV2ZW50KTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBtYXRjaCA9IC9eI0VYVC1YLVNUUkVBTS1JTkY6KC4qKSQvLmV4ZWMobmV3TGluZSk7XG5cbiAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICBldmVudCA9IHtcbiAgICAgICAgICB0eXBlOiAndGFnJyxcbiAgICAgICAgICB0YWdUeXBlOiAnc3RyZWFtLWluZidcbiAgICAgICAgfTtcblxuICAgICAgICBpZiAobWF0Y2hbMV0pIHtcbiAgICAgICAgICBldmVudC5hdHRyaWJ1dGVzID0gcGFyc2VBdHRyaWJ1dGVzKG1hdGNoWzFdKTtcblxuICAgICAgICAgIGlmIChldmVudC5hdHRyaWJ1dGVzLlJFU09MVVRJT04pIHtcbiAgICAgICAgICAgIGNvbnN0IHNwbGl0ID0gZXZlbnQuYXR0cmlidXRlcy5SRVNPTFVUSU9OLnNwbGl0KCd4Jyk7XG4gICAgICAgICAgICBjb25zdCByZXNvbHV0aW9uID0ge307XG5cbiAgICAgICAgICAgIGlmIChzcGxpdFswXSkge1xuICAgICAgICAgICAgICByZXNvbHV0aW9uLndpZHRoID0gcGFyc2VJbnQoc3BsaXRbMF0sIDEwKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHNwbGl0WzFdKSB7XG4gICAgICAgICAgICAgIHJlc29sdXRpb24uaGVpZ2h0ID0gcGFyc2VJbnQoc3BsaXRbMV0sIDEwKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZXZlbnQuYXR0cmlidXRlcy5SRVNPTFVUSU9OID0gcmVzb2x1dGlvbjtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAoZXZlbnQuYXR0cmlidXRlcy5CQU5EV0lEVEgpIHtcbiAgICAgICAgICAgIGV2ZW50LmF0dHJpYnV0ZXMuQkFORFdJRFRIID0gcGFyc2VJbnQoZXZlbnQuYXR0cmlidXRlcy5CQU5EV0lEVEgsIDEwKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAoZXZlbnQuYXR0cmlidXRlc1snRlJBTUUtUkFURSddKSB7XG4gICAgICAgICAgICBldmVudC5hdHRyaWJ1dGVzWydGUkFNRS1SQVRFJ10gPSBwYXJzZUZsb2F0KGV2ZW50LmF0dHJpYnV0ZXNbJ0ZSQU1FLVJBVEUnXSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKGV2ZW50LmF0dHJpYnV0ZXNbJ1BST0dSQU0tSUQnXSkge1xuICAgICAgICAgICAgZXZlbnQuYXR0cmlidXRlc1snUFJPR1JBTS1JRCddID0gcGFyc2VJbnQoZXZlbnQuYXR0cmlidXRlc1snUFJPR1JBTS1JRCddLCAxMCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy50cmlnZ2VyKCdkYXRhJywgZXZlbnQpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIG1hdGNoID0gL14jRVhULVgtTUVESUE6KC4qKSQvLmV4ZWMobmV3TGluZSk7XG5cbiAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICBldmVudCA9IHtcbiAgICAgICAgICB0eXBlOiAndGFnJyxcbiAgICAgICAgICB0YWdUeXBlOiAnbWVkaWEnXG4gICAgICAgIH07XG5cbiAgICAgICAgaWYgKG1hdGNoWzFdKSB7XG4gICAgICAgICAgZXZlbnQuYXR0cmlidXRlcyA9IHBhcnNlQXR0cmlidXRlcyhtYXRjaFsxXSk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnRyaWdnZXIoJ2RhdGEnLCBldmVudCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgbWF0Y2ggPSAvXiNFWFQtWC1FTkRMSVNULy5leGVjKG5ld0xpbmUpO1xuXG4gICAgICBpZiAobWF0Y2gpIHtcbiAgICAgICAgdGhpcy50cmlnZ2VyKCdkYXRhJywge1xuICAgICAgICAgIHR5cGU6ICd0YWcnLFxuICAgICAgICAgIHRhZ1R5cGU6ICdlbmRsaXN0J1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBtYXRjaCA9IC9eI0VYVC1YLURJU0NPTlRJTlVJVFkvLmV4ZWMobmV3TGluZSk7XG5cbiAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICB0aGlzLnRyaWdnZXIoJ2RhdGEnLCB7XG4gICAgICAgICAgdHlwZTogJ3RhZycsXG4gICAgICAgICAgdGFnVHlwZTogJ2Rpc2NvbnRpbnVpdHknXG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIG1hdGNoID0gL14jRVhULVgtUFJPR1JBTS1EQVRFLVRJTUU6KC4qKSQvLmV4ZWMobmV3TGluZSk7XG5cbiAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICBldmVudCA9IHtcbiAgICAgICAgICB0eXBlOiAndGFnJyxcbiAgICAgICAgICB0YWdUeXBlOiAncHJvZ3JhbS1kYXRlLXRpbWUnXG4gICAgICAgIH07XG5cbiAgICAgICAgaWYgKG1hdGNoWzFdKSB7XG4gICAgICAgICAgZXZlbnQuZGF0ZVRpbWVTdHJpbmcgPSBtYXRjaFsxXTtcbiAgICAgICAgICBldmVudC5kYXRlVGltZU9iamVjdCA9IG5ldyBEYXRlKG1hdGNoWzFdKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMudHJpZ2dlcignZGF0YScsIGV2ZW50KTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBtYXRjaCA9IC9eI0VYVC1YLUtFWTooLiopJC8uZXhlYyhuZXdMaW5lKTtcblxuICAgICAgaWYgKG1hdGNoKSB7XG4gICAgICAgIGV2ZW50ID0ge1xuICAgICAgICAgIHR5cGU6ICd0YWcnLFxuICAgICAgICAgIHRhZ1R5cGU6ICdrZXknXG4gICAgICAgIH07XG5cbiAgICAgICAgaWYgKG1hdGNoWzFdKSB7XG4gICAgICAgICAgZXZlbnQuYXR0cmlidXRlcyA9IHBhcnNlQXR0cmlidXRlcyhtYXRjaFsxXSk7IC8vIHBhcnNlIHRoZSBJViBzdHJpbmcgaW50byBhIFVpbnQzMkFycmF5XG5cbiAgICAgICAgICBpZiAoZXZlbnQuYXR0cmlidXRlcy5JVikge1xuICAgICAgICAgICAgaWYgKGV2ZW50LmF0dHJpYnV0ZXMuSVYuc3Vic3RyaW5nKDAsIDIpLnRvTG93ZXJDYXNlKCkgPT09ICcweCcpIHtcbiAgICAgICAgICAgICAgZXZlbnQuYXR0cmlidXRlcy5JViA9IGV2ZW50LmF0dHJpYnV0ZXMuSVYuc3Vic3RyaW5nKDIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBldmVudC5hdHRyaWJ1dGVzLklWID0gZXZlbnQuYXR0cmlidXRlcy5JVi5tYXRjaCgvLns4fS9nKTtcbiAgICAgICAgICAgIGV2ZW50LmF0dHJpYnV0ZXMuSVZbMF0gPSBwYXJzZUludChldmVudC5hdHRyaWJ1dGVzLklWWzBdLCAxNik7XG4gICAgICAgICAgICBldmVudC5hdHRyaWJ1dGVzLklWWzFdID0gcGFyc2VJbnQoZXZlbnQuYXR0cmlidXRlcy5JVlsxXSwgMTYpO1xuICAgICAgICAgICAgZXZlbnQuYXR0cmlidXRlcy5JVlsyXSA9IHBhcnNlSW50KGV2ZW50LmF0dHJpYnV0ZXMuSVZbMl0sIDE2KTtcbiAgICAgICAgICAgIGV2ZW50LmF0dHJpYnV0ZXMuSVZbM10gPSBwYXJzZUludChldmVudC5hdHRyaWJ1dGVzLklWWzNdLCAxNik7XG4gICAgICAgICAgICBldmVudC5hdHRyaWJ1dGVzLklWID0gbmV3IFVpbnQzMkFycmF5KGV2ZW50LmF0dHJpYnV0ZXMuSVYpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMudHJpZ2dlcignZGF0YScsIGV2ZW50KTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBtYXRjaCA9IC9eI0VYVC1YLVNUQVJUOiguKikkLy5leGVjKG5ld0xpbmUpO1xuXG4gICAgICBpZiAobWF0Y2gpIHtcbiAgICAgICAgZXZlbnQgPSB7XG4gICAgICAgICAgdHlwZTogJ3RhZycsXG4gICAgICAgICAgdGFnVHlwZTogJ3N0YXJ0J1xuICAgICAgICB9O1xuXG4gICAgICAgIGlmIChtYXRjaFsxXSkge1xuICAgICAgICAgIGV2ZW50LmF0dHJpYnV0ZXMgPSBwYXJzZUF0dHJpYnV0ZXMobWF0Y2hbMV0pO1xuICAgICAgICAgIGV2ZW50LmF0dHJpYnV0ZXNbJ1RJTUUtT0ZGU0VUJ10gPSBwYXJzZUZsb2F0KGV2ZW50LmF0dHJpYnV0ZXNbJ1RJTUUtT0ZGU0VUJ10pO1xuICAgICAgICAgIGV2ZW50LmF0dHJpYnV0ZXMuUFJFQ0lTRSA9IC9ZRVMvLnRlc3QoZXZlbnQuYXR0cmlidXRlcy5QUkVDSVNFKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMudHJpZ2dlcignZGF0YScsIGV2ZW50KTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBtYXRjaCA9IC9eI0VYVC1YLUNVRS1PVVQtQ09OVDooLiopPyQvLmV4ZWMobmV3TGluZSk7XG5cbiAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICBldmVudCA9IHtcbiAgICAgICAgICB0eXBlOiAndGFnJyxcbiAgICAgICAgICB0YWdUeXBlOiAnY3VlLW91dC1jb250J1xuICAgICAgICB9O1xuXG4gICAgICAgIGlmIChtYXRjaFsxXSkge1xuICAgICAgICAgIGV2ZW50LmRhdGEgPSBtYXRjaFsxXTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBldmVudC5kYXRhID0gJyc7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnRyaWdnZXIoJ2RhdGEnLCBldmVudCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgbWF0Y2ggPSAvXiNFWFQtWC1DVUUtT1VUOiguKik/JC8uZXhlYyhuZXdMaW5lKTtcblxuICAgICAgaWYgKG1hdGNoKSB7XG4gICAgICAgIGV2ZW50ID0ge1xuICAgICAgICAgIHR5cGU6ICd0YWcnLFxuICAgICAgICAgIHRhZ1R5cGU6ICdjdWUtb3V0J1xuICAgICAgICB9O1xuXG4gICAgICAgIGlmIChtYXRjaFsxXSkge1xuICAgICAgICAgIGV2ZW50LmRhdGEgPSBtYXRjaFsxXTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBldmVudC5kYXRhID0gJyc7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnRyaWdnZXIoJ2RhdGEnLCBldmVudCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgbWF0Y2ggPSAvXiNFWFQtWC1DVUUtSU46KC4qKT8kLy5leGVjKG5ld0xpbmUpO1xuXG4gICAgICBpZiAobWF0Y2gpIHtcbiAgICAgICAgZXZlbnQgPSB7XG4gICAgICAgICAgdHlwZTogJ3RhZycsXG4gICAgICAgICAgdGFnVHlwZTogJ2N1ZS1pbidcbiAgICAgICAgfTtcblxuICAgICAgICBpZiAobWF0Y2hbMV0pIHtcbiAgICAgICAgICBldmVudC5kYXRhID0gbWF0Y2hbMV07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZXZlbnQuZGF0YSA9ICcnO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy50cmlnZ2VyKCdkYXRhJywgZXZlbnQpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIG1hdGNoID0gL14jRVhULVgtU0tJUDooLiopJC8uZXhlYyhuZXdMaW5lKTtcblxuICAgICAgaWYgKG1hdGNoICYmIG1hdGNoWzFdKSB7XG4gICAgICAgIGV2ZW50ID0ge1xuICAgICAgICAgIHR5cGU6ICd0YWcnLFxuICAgICAgICAgIHRhZ1R5cGU6ICdza2lwJ1xuICAgICAgICB9O1xuICAgICAgICBldmVudC5hdHRyaWJ1dGVzID0gcGFyc2VBdHRyaWJ1dGVzKG1hdGNoWzFdKTtcblxuICAgICAgICBpZiAoZXZlbnQuYXR0cmlidXRlcy5oYXNPd25Qcm9wZXJ0eSgnU0tJUFBFRC1TRUdNRU5UUycpKSB7XG4gICAgICAgICAgZXZlbnQuYXR0cmlidXRlc1snU0tJUFBFRC1TRUdNRU5UUyddID0gcGFyc2VJbnQoZXZlbnQuYXR0cmlidXRlc1snU0tJUFBFRC1TRUdNRU5UUyddLCAxMCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZXZlbnQuYXR0cmlidXRlcy5oYXNPd25Qcm9wZXJ0eSgnUkVDRU5UTFktUkVNT1ZFRC1EQVRFUkFOR0VTJykpIHtcbiAgICAgICAgICBldmVudC5hdHRyaWJ1dGVzWydSRUNFTlRMWS1SRU1PVkVELURBVEVSQU5HRVMnXSA9IGV2ZW50LmF0dHJpYnV0ZXNbJ1JFQ0VOVExZLVJFTU9WRUQtREFURVJBTkdFUyddLnNwbGl0KFRBQik7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnRyaWdnZXIoJ2RhdGEnLCBldmVudCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgbWF0Y2ggPSAvXiNFWFQtWC1QQVJUOiguKikkLy5leGVjKG5ld0xpbmUpO1xuXG4gICAgICBpZiAobWF0Y2ggJiYgbWF0Y2hbMV0pIHtcbiAgICAgICAgZXZlbnQgPSB7XG4gICAgICAgICAgdHlwZTogJ3RhZycsXG4gICAgICAgICAgdGFnVHlwZTogJ3BhcnQnXG4gICAgICAgIH07XG4gICAgICAgIGV2ZW50LmF0dHJpYnV0ZXMgPSBwYXJzZUF0dHJpYnV0ZXMobWF0Y2hbMV0pO1xuICAgICAgICBbJ0RVUkFUSU9OJ10uZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgICAgaWYgKGV2ZW50LmF0dHJpYnV0ZXMuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICAgICAgZXZlbnQuYXR0cmlidXRlc1trZXldID0gcGFyc2VGbG9hdChldmVudC5hdHRyaWJ1dGVzW2tleV0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIFsnSU5ERVBFTkRFTlQnLCAnR0FQJ10uZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgICAgaWYgKGV2ZW50LmF0dHJpYnV0ZXMuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICAgICAgZXZlbnQuYXR0cmlidXRlc1trZXldID0gL1lFUy8udGVzdChldmVudC5hdHRyaWJ1dGVzW2tleV0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKGV2ZW50LmF0dHJpYnV0ZXMuaGFzT3duUHJvcGVydHkoJ0JZVEVSQU5HRScpKSB7XG4gICAgICAgICAgZXZlbnQuYXR0cmlidXRlcy5ieXRlcmFuZ2UgPSBwYXJzZUJ5dGVyYW5nZShldmVudC5hdHRyaWJ1dGVzLkJZVEVSQU5HRSk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnRyaWdnZXIoJ2RhdGEnLCBldmVudCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgbWF0Y2ggPSAvXiNFWFQtWC1TRVJWRVItQ09OVFJPTDooLiopJC8uZXhlYyhuZXdMaW5lKTtcblxuICAgICAgaWYgKG1hdGNoICYmIG1hdGNoWzFdKSB7XG4gICAgICAgIGV2ZW50ID0ge1xuICAgICAgICAgIHR5cGU6ICd0YWcnLFxuICAgICAgICAgIHRhZ1R5cGU6ICdzZXJ2ZXItY29udHJvbCdcbiAgICAgICAgfTtcbiAgICAgICAgZXZlbnQuYXR0cmlidXRlcyA9IHBhcnNlQXR0cmlidXRlcyhtYXRjaFsxXSk7XG4gICAgICAgIFsnQ0FOLVNLSVAtVU5USUwnLCAnUEFSVC1IT0xELUJBQ0snLCAnSE9MRC1CQUNLJ10uZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgICAgaWYgKGV2ZW50LmF0dHJpYnV0ZXMuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICAgICAgZXZlbnQuYXR0cmlidXRlc1trZXldID0gcGFyc2VGbG9hdChldmVudC5hdHRyaWJ1dGVzW2tleV0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIFsnQ0FOLVNLSVAtREFURVJBTkdFUycsICdDQU4tQkxPQ0stUkVMT0FEJ10uZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgICAgaWYgKGV2ZW50LmF0dHJpYnV0ZXMuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICAgICAgZXZlbnQuYXR0cmlidXRlc1trZXldID0gL1lFUy8udGVzdChldmVudC5hdHRyaWJ1dGVzW2tleV0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMudHJpZ2dlcignZGF0YScsIGV2ZW50KTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBtYXRjaCA9IC9eI0VYVC1YLVBBUlQtSU5GOiguKikkLy5leGVjKG5ld0xpbmUpO1xuXG4gICAgICBpZiAobWF0Y2ggJiYgbWF0Y2hbMV0pIHtcbiAgICAgICAgZXZlbnQgPSB7XG4gICAgICAgICAgdHlwZTogJ3RhZycsXG4gICAgICAgICAgdGFnVHlwZTogJ3BhcnQtaW5mJ1xuICAgICAgICB9O1xuICAgICAgICBldmVudC5hdHRyaWJ1dGVzID0gcGFyc2VBdHRyaWJ1dGVzKG1hdGNoWzFdKTtcbiAgICAgICAgWydQQVJULVRBUkdFVCddLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuICAgICAgICAgIGlmIChldmVudC5hdHRyaWJ1dGVzLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICAgIGV2ZW50LmF0dHJpYnV0ZXNba2V5XSA9IHBhcnNlRmxvYXQoZXZlbnQuYXR0cmlidXRlc1trZXldKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnRyaWdnZXIoJ2RhdGEnLCBldmVudCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgbWF0Y2ggPSAvXiNFWFQtWC1QUkVMT0FELUhJTlQ6KC4qKSQvLmV4ZWMobmV3TGluZSk7XG5cbiAgICAgIGlmIChtYXRjaCAmJiBtYXRjaFsxXSkge1xuICAgICAgICBldmVudCA9IHtcbiAgICAgICAgICB0eXBlOiAndGFnJyxcbiAgICAgICAgICB0YWdUeXBlOiAncHJlbG9hZC1oaW50J1xuICAgICAgICB9O1xuICAgICAgICBldmVudC5hdHRyaWJ1dGVzID0gcGFyc2VBdHRyaWJ1dGVzKG1hdGNoWzFdKTtcbiAgICAgICAgWydCWVRFUkFOR0UtU1RBUlQnLCAnQllURVJBTkdFLUxFTkdUSCddLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuICAgICAgICAgIGlmIChldmVudC5hdHRyaWJ1dGVzLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICAgIGV2ZW50LmF0dHJpYnV0ZXNba2V5XSA9IHBhcnNlSW50KGV2ZW50LmF0dHJpYnV0ZXNba2V5XSwgMTApO1xuICAgICAgICAgICAgY29uc3Qgc3Via2V5ID0ga2V5ID09PSAnQllURVJBTkdFLUxFTkdUSCcgPyAnbGVuZ3RoJyA6ICdvZmZzZXQnO1xuICAgICAgICAgICAgZXZlbnQuYXR0cmlidXRlcy5ieXRlcmFuZ2UgPSBldmVudC5hdHRyaWJ1dGVzLmJ5dGVyYW5nZSB8fCB7fTtcbiAgICAgICAgICAgIGV2ZW50LmF0dHJpYnV0ZXMuYnl0ZXJhbmdlW3N1YmtleV0gPSBldmVudC5hdHRyaWJ1dGVzW2tleV07IC8vIG9ubHkga2VlcCB0aGUgcGFyc2VkIGJ5dGVyYW5nZSBvYmplY3QuXG5cbiAgICAgICAgICAgIGRlbGV0ZSBldmVudC5hdHRyaWJ1dGVzW2tleV07XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy50cmlnZ2VyKCdkYXRhJywgZXZlbnQpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIG1hdGNoID0gL14jRVhULVgtUkVORElUSU9OLVJFUE9SVDooLiopJC8uZXhlYyhuZXdMaW5lKTtcblxuICAgICAgaWYgKG1hdGNoICYmIG1hdGNoWzFdKSB7XG4gICAgICAgIGV2ZW50ID0ge1xuICAgICAgICAgIHR5cGU6ICd0YWcnLFxuICAgICAgICAgIHRhZ1R5cGU6ICdyZW5kaXRpb24tcmVwb3J0J1xuICAgICAgICB9O1xuICAgICAgICBldmVudC5hdHRyaWJ1dGVzID0gcGFyc2VBdHRyaWJ1dGVzKG1hdGNoWzFdKTtcbiAgICAgICAgWydMQVNULU1TTicsICdMQVNULVBBUlQnXS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgICAgICBpZiAoZXZlbnQuYXR0cmlidXRlcy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgICAgICBldmVudC5hdHRyaWJ1dGVzW2tleV0gPSBwYXJzZUludChldmVudC5hdHRyaWJ1dGVzW2tleV0sIDEwKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnRyaWdnZXIoJ2RhdGEnLCBldmVudCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH0gLy8gdW5rbm93biB0YWcgdHlwZVxuXG5cbiAgICAgIHRoaXMudHJpZ2dlcignZGF0YScsIHtcbiAgICAgICAgdHlwZTogJ3RhZycsXG4gICAgICAgIGRhdGE6IG5ld0xpbmUuc2xpY2UoNClcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG4gIC8qKlxuICAgKiBBZGQgYSBwYXJzZXIgZm9yIGN1c3RvbSBoZWFkZXJzXG4gICAqXG4gICAqIEBwYXJhbSB7T2JqZWN0fSAgIG9wdGlvbnMgICAgICAgICAgICAgIGEgbWFwIG9mIG9wdGlvbnMgZm9yIHRoZSBhZGRlZCBwYXJzZXJcbiAgICogQHBhcmFtIHtSZWdFeHB9ICAgb3B0aW9ucy5leHByZXNzaW9uICAgYSByZWd1bGFyIGV4cHJlc3Npb24gdG8gbWF0Y2ggdGhlIGN1c3RvbSBoZWFkZXJcbiAgICogQHBhcmFtIHtzdHJpbmd9ICAgb3B0aW9ucy5jdXN0b21UeXBlICAgdGhlIGN1c3RvbSB0eXBlIHRvIHJlZ2lzdGVyIHRvIHRoZSBvdXRwdXRcbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gW29wdGlvbnMuZGF0YVBhcnNlcl0gZnVuY3Rpb24gdG8gcGFyc2UgdGhlIGxpbmUgaW50byBhbiBvYmplY3RcbiAgICogQHBhcmFtIHtib29sZWFufSAgW29wdGlvbnMuc2VnbWVudF0gICAgc2hvdWxkIHRhZyBkYXRhIGJlIGF0dGFjaGVkIHRvIHRoZSBzZWdtZW50IG9iamVjdFxuICAgKi9cblxuXG4gIGFkZFBhcnNlcih7XG4gICAgZXhwcmVzc2lvbixcbiAgICBjdXN0b21UeXBlLFxuICAgIGRhdGFQYXJzZXIsXG4gICAgc2VnbWVudFxuICB9KSB7XG4gICAgaWYgKHR5cGVvZiBkYXRhUGFyc2VyICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICBkYXRhUGFyc2VyID0gbGluZSA9PiBsaW5lO1xuICAgIH1cblxuICAgIHRoaXMuY3VzdG9tUGFyc2Vycy5wdXNoKGxpbmUgPT4ge1xuICAgICAgY29uc3QgbWF0Y2ggPSBleHByZXNzaW9uLmV4ZWMobGluZSk7XG5cbiAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICB0aGlzLnRyaWdnZXIoJ2RhdGEnLCB7XG4gICAgICAgICAgdHlwZTogJ2N1c3RvbScsXG4gICAgICAgICAgZGF0YTogZGF0YVBhcnNlcihsaW5lKSxcbiAgICAgICAgICBjdXN0b21UeXBlLFxuICAgICAgICAgIHNlZ21lbnRcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG4gIC8qKlxuICAgKiBBZGQgYSBjdXN0b20gaGVhZGVyIG1hcHBlclxuICAgKlxuICAgKiBAcGFyYW0ge09iamVjdH0gICBvcHRpb25zXG4gICAqIEBwYXJhbSB7UmVnRXhwfSAgIG9wdGlvbnMuZXhwcmVzc2lvbiAgIGEgcmVndWxhciBleHByZXNzaW9uIHRvIG1hdGNoIHRoZSBjdXN0b20gaGVhZGVyXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IG9wdGlvbnMubWFwICAgICAgICAgIGZ1bmN0aW9uIHRvIHRyYW5zbGF0ZSB0YWcgaW50byBhIGRpZmZlcmVudCB0YWdcbiAgICovXG5cblxuICBhZGRUYWdNYXBwZXIoe1xuICAgIGV4cHJlc3Npb24sXG4gICAgbWFwXG4gIH0pIHtcbiAgICBjb25zdCBtYXBGbiA9IGxpbmUgPT4ge1xuICAgICAgaWYgKGV4cHJlc3Npb24udGVzdChsaW5lKSkge1xuICAgICAgICByZXR1cm4gbWFwKGxpbmUpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gbGluZTtcbiAgICB9O1xuXG4gICAgdGhpcy50YWdNYXBwZXJzLnB1c2gobWFwRm4pO1xuICB9XG5cbn1cblxuY29uc3QgY2FtZWxDYXNlID0gc3RyID0+IHN0ci50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoLy0oXFx3KS9nLCBhID0+IGFbMV0udG9VcHBlckNhc2UoKSk7XG5cbmNvbnN0IGNhbWVsQ2FzZUtleXMgPSBmdW5jdGlvbiAoYXR0cmlidXRlcykge1xuICBjb25zdCByZXN1bHQgPSB7fTtcbiAgT2JqZWN0LmtleXMoYXR0cmlidXRlcykuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG4gICAgcmVzdWx0W2NhbWVsQ2FzZShrZXkpXSA9IGF0dHJpYnV0ZXNba2V5XTtcbiAgfSk7XG4gIHJldHVybiByZXN1bHQ7XG59OyAvLyBzZXQgU0VSVkVSLUNPTlRST0wgaG9sZCBiYWNrIGJhc2VkIHVwb24gdGFyZ2V0RHVyYXRpb24gYW5kIHBhcnRUYXJnZXREdXJhdGlvblxuLy8gd2UgbmVlZCB0aGlzIGhlbHBlciBiZWNhdXNlIGRlZmF1bHRzIGFyZSBiYXNlZCB1cG9uIHRhcmdldER1cmF0aW9uIGFuZFxuLy8gcGFydFRhcmdldER1cmF0aW9uIGJlaW5nIHNldCwgYnV0IHRoZXkgbWF5IG5vdCBiZSBpZiBTRVJWRVItQ09OVFJPTCBhcHBlYXJzIGJlZm9yZVxuLy8gdGFyZ2V0IGR1cmF0aW9ucyBhcmUgc2V0LlxuXG5cbmNvbnN0IHNldEhvbGRCYWNrID0gZnVuY3Rpb24gKG1hbmlmZXN0KSB7XG4gIGNvbnN0IHtcbiAgICBzZXJ2ZXJDb250cm9sLFxuICAgIHRhcmdldER1cmF0aW9uLFxuICAgIHBhcnRUYXJnZXREdXJhdGlvblxuICB9ID0gbWFuaWZlc3Q7XG5cbiAgaWYgKCFzZXJ2ZXJDb250cm9sKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY29uc3QgdGFnID0gJyNFWFQtWC1TRVJWRVItQ09OVFJPTCc7XG4gIGNvbnN0IGhiID0gJ2hvbGRCYWNrJztcbiAgY29uc3QgcGhiID0gJ3BhcnRIb2xkQmFjayc7XG4gIGNvbnN0IG1pblRhcmdldER1cmF0aW9uID0gdGFyZ2V0RHVyYXRpb24gJiYgdGFyZ2V0RHVyYXRpb24gKiAzO1xuICBjb25zdCBtaW5QYXJ0RHVyYXRpb24gPSBwYXJ0VGFyZ2V0RHVyYXRpb24gJiYgcGFydFRhcmdldER1cmF0aW9uICogMjtcblxuICBpZiAodGFyZ2V0RHVyYXRpb24gJiYgIXNlcnZlckNvbnRyb2wuaGFzT3duUHJvcGVydHkoaGIpKSB7XG4gICAgc2VydmVyQ29udHJvbFtoYl0gPSBtaW5UYXJnZXREdXJhdGlvbjtcbiAgICB0aGlzLnRyaWdnZXIoJ2luZm8nLCB7XG4gICAgICBtZXNzYWdlOiBgJHt0YWd9IGRlZmF1bHRpbmcgSE9MRC1CQUNLIHRvIHRhcmdldER1cmF0aW9uICogMyAoJHttaW5UYXJnZXREdXJhdGlvbn0pLmBcbiAgICB9KTtcbiAgfVxuXG4gIGlmIChtaW5UYXJnZXREdXJhdGlvbiAmJiBzZXJ2ZXJDb250cm9sW2hiXSA8IG1pblRhcmdldER1cmF0aW9uKSB7XG4gICAgdGhpcy50cmlnZ2VyKCd3YXJuJywge1xuICAgICAgbWVzc2FnZTogYCR7dGFnfSBjbGFtcGluZyBIT0xELUJBQ0sgKCR7c2VydmVyQ29udHJvbFtoYl19KSB0byB0YXJnZXREdXJhdGlvbiAqIDMgKCR7bWluVGFyZ2V0RHVyYXRpb259KWBcbiAgICB9KTtcbiAgICBzZXJ2ZXJDb250cm9sW2hiXSA9IG1pblRhcmdldER1cmF0aW9uO1xuICB9IC8vIGRlZmF1bHQgbm8gcGFydCBob2xkIGJhY2sgdG8gcGFydCB0YXJnZXQgZHVyYXRpb24gKiAzXG5cblxuICBpZiAocGFydFRhcmdldER1cmF0aW9uICYmICFzZXJ2ZXJDb250cm9sLmhhc093blByb3BlcnR5KHBoYikpIHtcbiAgICBzZXJ2ZXJDb250cm9sW3BoYl0gPSBwYXJ0VGFyZ2V0RHVyYXRpb24gKiAzO1xuICAgIHRoaXMudHJpZ2dlcignaW5mbycsIHtcbiAgICAgIG1lc3NhZ2U6IGAke3RhZ30gZGVmYXVsdGluZyBQQVJULUhPTEQtQkFDSyB0byBwYXJ0VGFyZ2V0RHVyYXRpb24gKiAzICgke3NlcnZlckNvbnRyb2xbcGhiXX0pLmBcbiAgICB9KTtcbiAgfSAvLyBpZiBwYXJ0IGhvbGQgYmFjayBpcyB0b28gc21hbGwgZGVmYXVsdCBpdCB0byBwYXJ0IHRhcmdldCBkdXJhdGlvbiAqIDJcblxuXG4gIGlmIChwYXJ0VGFyZ2V0RHVyYXRpb24gJiYgc2VydmVyQ29udHJvbFtwaGJdIDwgbWluUGFydER1cmF0aW9uKSB7XG4gICAgdGhpcy50cmlnZ2VyKCd3YXJuJywge1xuICAgICAgbWVzc2FnZTogYCR7dGFnfSBjbGFtcGluZyBQQVJULUhPTEQtQkFDSyAoJHtzZXJ2ZXJDb250cm9sW3BoYl19KSB0byBwYXJ0VGFyZ2V0RHVyYXRpb24gKiAyICgke21pblBhcnREdXJhdGlvbn0pLmBcbiAgICB9KTtcbiAgICBzZXJ2ZXJDb250cm9sW3BoYl0gPSBtaW5QYXJ0RHVyYXRpb247XG4gIH1cbn07XG4vKipcbiAqIEEgcGFyc2VyIGZvciBNM1U4IGZpbGVzLiBUaGUgY3VycmVudCBpbnRlcnByZXRhdGlvbiBvZiB0aGUgaW5wdXQgaXNcbiAqIGV4cG9zZWQgYXMgYSBwcm9wZXJ0eSBgbWFuaWZlc3RgIG9uIHBhcnNlciBvYmplY3RzLiBJdCdzIGp1c3QgdHdvIGxpbmVzIHRvXG4gKiBjcmVhdGUgYW5kIHBhcnNlIGEgbWFuaWZlc3Qgb25jZSB5b3UgaGF2ZSB0aGUgY29udGVudHMgYXZhaWxhYmxlIGFzIGEgc3RyaW5nOlxuICpcbiAqIGBgYGpzXG4gKiB2YXIgcGFyc2VyID0gbmV3IG0zdTguUGFyc2VyKCk7XG4gKiBwYXJzZXIucHVzaCh4aHIucmVzcG9uc2VUZXh0KTtcbiAqIGBgYFxuICpcbiAqIE5ldyBpbnB1dCBjYW4gbGF0ZXIgYmUgYXBwbGllZCB0byB1cGRhdGUgdGhlIG1hbmlmZXN0IG9iamVjdCBieSBjYWxsaW5nXG4gKiBgcHVzaGAgYWdhaW4uXG4gKlxuICogVGhlIHBhcnNlciBhdHRlbXB0cyB0byBjcmVhdGUgYSB1c2FibGUgbWFuaWZlc3Qgb2JqZWN0IGV2ZW4gaWYgdGhlXG4gKiB1bmRlcmx5aW5nIGlucHV0IGlzIHNvbWV3aGF0IG5vbnNlbnNpY2FsLiBJdCBlbWl0cyBgaW5mb2AgYW5kIGB3YXJuaW5nYFxuICogZXZlbnRzIGR1cmluZyB0aGUgcGFyc2UgaWYgaXQgZW5jb3VudGVycyBpbnB1dCB0aGF0IHNlZW1zIGludmFsaWQgb3JcbiAqIHJlcXVpcmVzIHNvbWUgcHJvcGVydHkgb2YgdGhlIG1hbmlmZXN0IG9iamVjdCB0byBiZSBkZWZhdWx0ZWQuXG4gKlxuICogQGNsYXNzIFBhcnNlclxuICogQGV4dGVuZHMgU3RyZWFtXG4gKi9cblxuXG5jbGFzcyBQYXJzZXIgZXh0ZW5kcyBTdHJlYW0ge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlcigpO1xuICAgIHRoaXMubGluZVN0cmVhbSA9IG5ldyBMaW5lU3RyZWFtKCk7XG4gICAgdGhpcy5wYXJzZVN0cmVhbSA9IG5ldyBQYXJzZVN0cmVhbSgpO1xuICAgIHRoaXMubGluZVN0cmVhbS5waXBlKHRoaXMucGFyc2VTdHJlYW0pO1xuICAgIC8qIGVzbGludC1kaXNhYmxlIGNvbnNpc3RlbnQtdGhpcyAqL1xuXG4gICAgY29uc3Qgc2VsZiA9IHRoaXM7XG4gICAgLyogZXNsaW50LWVuYWJsZSBjb25zaXN0ZW50LXRoaXMgKi9cblxuICAgIGNvbnN0IHVyaXMgPSBbXTtcbiAgICBsZXQgY3VycmVudFVyaSA9IHt9OyAvLyBpZiBzcGVjaWZpZWQsIHRoZSBhY3RpdmUgRVhULVgtTUFQIGRlZmluaXRpb25cblxuICAgIGxldCBjdXJyZW50TWFwOyAvLyBpZiBzcGVjaWZpZWQsIHRoZSBhY3RpdmUgZGVjcnlwdGlvbiBrZXlcblxuICAgIGxldCBrZXk7XG4gICAgbGV0IGhhc1BhcnRzID0gZmFsc2U7XG5cbiAgICBjb25zdCBub29wID0gZnVuY3Rpb24gKCkge307XG5cbiAgICBjb25zdCBkZWZhdWx0TWVkaWFHcm91cHMgPSB7XG4gICAgICAnQVVESU8nOiB7fSxcbiAgICAgICdWSURFTyc6IHt9LFxuICAgICAgJ0NMT1NFRC1DQVBUSU9OUyc6IHt9LFxuICAgICAgJ1NVQlRJVExFUyc6IHt9XG4gICAgfTsgLy8gVGhpcyBpcyB0aGUgV2lkZXZpbmUgVVVJRCBmcm9tIERBU0ggSUYgSU9QLiBUaGUgc2FtZSBleGFjdCBzdHJpbmcgaXNcbiAgICAvLyB1c2VkIGluIE1QRHMgd2l0aCBXaWRldmluZSBlbmNyeXB0ZWQgc3RyZWFtcy5cblxuICAgIGNvbnN0IHdpZGV2aW5lVXVpZCA9ICd1cm46dXVpZDplZGVmOGJhOS03OWQ2LTRhY2UtYTNjOC0yN2RjZDUxZDIxZWQnOyAvLyBncm91cCBzZWdtZW50cyBpbnRvIG51bWJlcmVkIHRpbWVsaW5lcyBkZWxpbmVhdGVkIGJ5IGRpc2NvbnRpbnVpdGllc1xuXG4gICAgbGV0IGN1cnJlbnRUaW1lbGluZSA9IDA7IC8vIHRoZSBtYW5pZmVzdCBpcyBlbXB0eSB1bnRpbCB0aGUgcGFyc2Ugc3RyZWFtIGJlZ2lucyBkZWxpdmVyaW5nIGRhdGFcblxuICAgIHRoaXMubWFuaWZlc3QgPSB7XG4gICAgICBhbGxvd0NhY2hlOiB0cnVlLFxuICAgICAgZGlzY29udGludWl0eVN0YXJ0czogW10sXG4gICAgICBzZWdtZW50czogW11cbiAgICB9OyAvLyBrZWVwIHRyYWNrIG9mIHRoZSBsYXN0IHNlZW4gc2VnbWVudCdzIGJ5dGUgcmFuZ2UgZW5kLCBhcyBzZWdtZW50cyBhcmUgbm90IHJlcXVpcmVkXG4gICAgLy8gdG8gcHJvdmlkZSB0aGUgb2Zmc2V0LCBpbiB3aGljaCBjYXNlIGl0IGRlZmF1bHRzIHRvIHRoZSBuZXh0IGJ5dGUgYWZ0ZXIgdGhlXG4gICAgLy8gcHJldmlvdXMgc2VnbWVudFxuXG4gICAgbGV0IGxhc3RCeXRlcmFuZ2VFbmQgPSAwOyAvLyBrZWVwIHRyYWNrIG9mIHRoZSBsYXN0IHNlZW4gcGFydCdzIGJ5dGUgcmFuZ2UgZW5kLlxuXG4gICAgbGV0IGxhc3RQYXJ0Qnl0ZXJhbmdlRW5kID0gMDtcbiAgICB0aGlzLm9uKCdlbmQnLCAoKSA9PiB7XG4gICAgICAvLyBvbmx5IGFkZCBwcmVsb2FkU2VnbWVudCBpZiB3ZSBkb24ndCB5ZXQgaGF2ZSBhIHVyaSBmb3IgaXQuXG4gICAgICAvLyBhbmQgd2UgYWN0dWFsbHkgaGF2ZSBwYXJ0cy9wcmVsb2FkSGludHNcbiAgICAgIGlmIChjdXJyZW50VXJpLnVyaSB8fCAhY3VycmVudFVyaS5wYXJ0cyAmJiAhY3VycmVudFVyaS5wcmVsb2FkSGludHMpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBpZiAoIWN1cnJlbnRVcmkubWFwICYmIGN1cnJlbnRNYXApIHtcbiAgICAgICAgY3VycmVudFVyaS5tYXAgPSBjdXJyZW50TWFwO1xuICAgICAgfVxuXG4gICAgICBpZiAoIWN1cnJlbnRVcmkua2V5ICYmIGtleSkge1xuICAgICAgICBjdXJyZW50VXJpLmtleSA9IGtleTtcbiAgICAgIH1cblxuICAgICAgaWYgKCFjdXJyZW50VXJpLnRpbWVsaW5lICYmIHR5cGVvZiBjdXJyZW50VGltZWxpbmUgPT09ICdudW1iZXInKSB7XG4gICAgICAgIGN1cnJlbnRVcmkudGltZWxpbmUgPSBjdXJyZW50VGltZWxpbmU7XG4gICAgICB9XG5cbiAgICAgIHRoaXMubWFuaWZlc3QucHJlbG9hZFNlZ21lbnQgPSBjdXJyZW50VXJpO1xuICAgIH0pOyAvLyB1cGRhdGUgdGhlIG1hbmlmZXN0IHdpdGggdGhlIG0zdTggZW50cnkgZnJvbSB0aGUgcGFyc2Ugc3RyZWFtXG5cbiAgICB0aGlzLnBhcnNlU3RyZWFtLm9uKCdkYXRhJywgZnVuY3Rpb24gKGVudHJ5KSB7XG4gICAgICBsZXQgbWVkaWFHcm91cDtcbiAgICAgIGxldCByZW5kaXRpb247XG4gICAgICAoe1xuICAgICAgICB0YWcoKSB7XG4gICAgICAgICAgLy8gc3dpdGNoIGJhc2VkIG9uIHRoZSB0YWcgdHlwZVxuICAgICAgICAgICgoe1xuICAgICAgICAgICAgdmVyc2lvbigpIHtcbiAgICAgICAgICAgICAgaWYgKGVudHJ5LnZlcnNpb24pIHtcbiAgICAgICAgICAgICAgICB0aGlzLm1hbmlmZXN0LnZlcnNpb24gPSBlbnRyeS52ZXJzaW9uO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAnYWxsb3ctY2FjaGUnKCkge1xuICAgICAgICAgICAgICB0aGlzLm1hbmlmZXN0LmFsbG93Q2FjaGUgPSBlbnRyeS5hbGxvd2VkO1xuXG4gICAgICAgICAgICAgIGlmICghKCdhbGxvd2VkJyBpbiBlbnRyeSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnRyaWdnZXIoJ2luZm8nLCB7XG4gICAgICAgICAgICAgICAgICBtZXNzYWdlOiAnZGVmYXVsdGluZyBhbGxvd0NhY2hlIHRvIFlFUydcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0aGlzLm1hbmlmZXN0LmFsbG93Q2FjaGUgPSB0cnVlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICBieXRlcmFuZ2UoKSB7XG4gICAgICAgICAgICAgIGNvbnN0IGJ5dGVyYW5nZSA9IHt9O1xuXG4gICAgICAgICAgICAgIGlmICgnbGVuZ3RoJyBpbiBlbnRyeSkge1xuICAgICAgICAgICAgICAgIGN1cnJlbnRVcmkuYnl0ZXJhbmdlID0gYnl0ZXJhbmdlO1xuICAgICAgICAgICAgICAgIGJ5dGVyYW5nZS5sZW5ndGggPSBlbnRyeS5sZW5ndGg7XG5cbiAgICAgICAgICAgICAgICBpZiAoISgnb2Zmc2V0JyBpbiBlbnRyeSkpIHtcbiAgICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICAgKiBGcm9tIHRoZSBsYXRlc3Qgc3BlYyAoYXMgb2YgdGhpcyB3cml0aW5nKTpcbiAgICAgICAgICAgICAgICAgICAqIGh0dHBzOi8vdG9vbHMuaWV0Zi5vcmcvaHRtbC9kcmFmdC1wYW50b3MtaHR0cC1saXZlLXN0cmVhbWluZy0yMyNzZWN0aW9uLTQuMy4yLjJcbiAgICAgICAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgICAgICAgKiBTYW1lIHRleHQgc2luY2UgRVhULVgtQllURVJBTkdFJ3MgaW50cm9kdWN0aW9uIGluIGRyYWZ0IDc6XG4gICAgICAgICAgICAgICAgICAgKiBodHRwczovL3Rvb2xzLmlldGYub3JnL2h0bWwvZHJhZnQtcGFudG9zLWh0dHAtbGl2ZS1zdHJlYW1pbmctMDcjc2VjdGlvbi0zLjMuMSlcbiAgICAgICAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgICAgICAgKiBcIklmIG8gW29mZnNldF0gaXMgbm90IHByZXNlbnQsIHRoZSBzdWItcmFuZ2UgYmVnaW5zIGF0IHRoZSBuZXh0IGJ5dGVcbiAgICAgICAgICAgICAgICAgICAqIGZvbGxvd2luZyB0aGUgc3ViLXJhbmdlIG9mIHRoZSBwcmV2aW91cyBtZWRpYSBzZWdtZW50LlwiXG4gICAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICAgIGVudHJ5Lm9mZnNldCA9IGxhc3RCeXRlcmFuZ2VFbmQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgaWYgKCdvZmZzZXQnIGluIGVudHJ5KSB7XG4gICAgICAgICAgICAgICAgY3VycmVudFVyaS5ieXRlcmFuZ2UgPSBieXRlcmFuZ2U7XG4gICAgICAgICAgICAgICAgYnl0ZXJhbmdlLm9mZnNldCA9IGVudHJ5Lm9mZnNldDtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGxhc3RCeXRlcmFuZ2VFbmQgPSBieXRlcmFuZ2Uub2Zmc2V0ICsgYnl0ZXJhbmdlLmxlbmd0aDtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIGVuZGxpc3QoKSB7XG4gICAgICAgICAgICAgIHRoaXMubWFuaWZlc3QuZW5kTGlzdCA9IHRydWU7XG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICBpbmYoKSB7XG4gICAgICAgICAgICAgIGlmICghKCdtZWRpYVNlcXVlbmNlJyBpbiB0aGlzLm1hbmlmZXN0KSkge1xuICAgICAgICAgICAgICAgIHRoaXMubWFuaWZlc3QubWVkaWFTZXF1ZW5jZSA9IDA7XG4gICAgICAgICAgICAgICAgdGhpcy50cmlnZ2VyKCdpbmZvJywge1xuICAgICAgICAgICAgICAgICAgbWVzc2FnZTogJ2RlZmF1bHRpbmcgbWVkaWEgc2VxdWVuY2UgdG8gemVybydcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGlmICghKCdkaXNjb250aW51aXR5U2VxdWVuY2UnIGluIHRoaXMubWFuaWZlc3QpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5tYW5pZmVzdC5kaXNjb250aW51aXR5U2VxdWVuY2UgPSAwO1xuICAgICAgICAgICAgICAgIHRoaXMudHJpZ2dlcignaW5mbycsIHtcbiAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICdkZWZhdWx0aW5nIGRpc2NvbnRpbnVpdHkgc2VxdWVuY2UgdG8gemVybydcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGlmIChlbnRyeS5kdXJhdGlvbiA+IDApIHtcbiAgICAgICAgICAgICAgICBjdXJyZW50VXJpLmR1cmF0aW9uID0gZW50cnkuZHVyYXRpb247XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBpZiAoZW50cnkuZHVyYXRpb24gPT09IDApIHtcbiAgICAgICAgICAgICAgICBjdXJyZW50VXJpLmR1cmF0aW9uID0gMC4wMTtcbiAgICAgICAgICAgICAgICB0aGlzLnRyaWdnZXIoJ2luZm8nLCB7XG4gICAgICAgICAgICAgICAgICBtZXNzYWdlOiAndXBkYXRpbmcgemVybyBzZWdtZW50IGR1cmF0aW9uIHRvIGEgc21hbGwgdmFsdWUnXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICB0aGlzLm1hbmlmZXN0LnNlZ21lbnRzID0gdXJpcztcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIGtleSgpIHtcbiAgICAgICAgICAgICAgaWYgKCFlbnRyeS5hdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICAgICAgdGhpcy50cmlnZ2VyKCd3YXJuJywge1xuICAgICAgICAgICAgICAgICAgbWVzc2FnZTogJ2lnbm9yaW5nIGtleSBkZWNsYXJhdGlvbiB3aXRob3V0IGF0dHJpYnV0ZSBsaXN0J1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgfSAvLyBjbGVhciB0aGUgYWN0aXZlIGVuY3J5cHRpb24ga2V5XG5cblxuICAgICAgICAgICAgICBpZiAoZW50cnkuYXR0cmlidXRlcy5NRVRIT0QgPT09ICdOT05FJykge1xuICAgICAgICAgICAgICAgIGtleSA9IG51bGw7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgaWYgKCFlbnRyeS5hdHRyaWJ1dGVzLlVSSSkge1xuICAgICAgICAgICAgICAgIHRoaXMudHJpZ2dlcignd2FybicsIHtcbiAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICdpZ25vcmluZyBrZXkgZGVjbGFyYXRpb24gd2l0aG91dCBVUkknXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgaWYgKGVudHJ5LmF0dHJpYnV0ZXMuS0VZRk9STUFUID09PSAnY29tLmFwcGxlLnN0cmVhbWluZ2tleWRlbGl2ZXJ5Jykge1xuICAgICAgICAgICAgICAgIHRoaXMubWFuaWZlc3QuY29udGVudFByb3RlY3Rpb24gPSB0aGlzLm1hbmlmZXN0LmNvbnRlbnRQcm90ZWN0aW9uIHx8IHt9OyAvLyBUT0RPOiBhZGQgZnVsbCBzdXBwb3J0IGZvciB0aGlzLlxuXG4gICAgICAgICAgICAgICAgdGhpcy5tYW5pZmVzdC5jb250ZW50UHJvdGVjdGlvblsnY29tLmFwcGxlLmZwcy4xXzAnXSA9IHtcbiAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXM6IGVudHJ5LmF0dHJpYnV0ZXNcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGlmIChlbnRyeS5hdHRyaWJ1dGVzLktFWUZPUk1BVCA9PT0gJ2NvbS5taWNyb3NvZnQucGxheXJlYWR5Jykge1xuICAgICAgICAgICAgICAgIHRoaXMubWFuaWZlc3QuY29udGVudFByb3RlY3Rpb24gPSB0aGlzLm1hbmlmZXN0LmNvbnRlbnRQcm90ZWN0aW9uIHx8IHt9OyAvLyBUT0RPOiBhZGQgZnVsbCBzdXBwb3J0IGZvciB0aGlzLlxuXG4gICAgICAgICAgICAgICAgdGhpcy5tYW5pZmVzdC5jb250ZW50UHJvdGVjdGlvblsnY29tLm1pY3Jvc29mdC5wbGF5cmVhZHknXSA9IHtcbiAgICAgICAgICAgICAgICAgIHVyaTogZW50cnkuYXR0cmlidXRlcy5VUklcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgfSAvLyBjaGVjayBpZiB0aGUgY29udGVudCBpcyBlbmNyeXB0ZWQgZm9yIFdpZGV2aW5lXG4gICAgICAgICAgICAgIC8vIFdpZGV2aW5lL0hMUyBzcGVjOiBodHRwczovL3N0b3JhZ2UuZ29vZ2xlYXBpcy5jb20vd3Zkb2NzL1dpZGV2aW5lX0RSTV9ITFMucGRmXG5cblxuICAgICAgICAgICAgICBpZiAoZW50cnkuYXR0cmlidXRlcy5LRVlGT1JNQVQgPT09IHdpZGV2aW5lVXVpZCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IFZBTElEX01FVEhPRFMgPSBbJ1NBTVBMRS1BRVMnLCAnU0FNUExFLUFFUy1DVFInLCAnU0FNUExFLUFFUy1DRU5DJ107XG5cbiAgICAgICAgICAgICAgICBpZiAoVkFMSURfTUVUSE9EUy5pbmRleE9mKGVudHJ5LmF0dHJpYnV0ZXMuTUVUSE9EKSA9PT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgIHRoaXMudHJpZ2dlcignd2FybicsIHtcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogJ2ludmFsaWQga2V5IG1ldGhvZCBwcm92aWRlZCBmb3IgV2lkZXZpbmUnXG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoZW50cnkuYXR0cmlidXRlcy5NRVRIT0QgPT09ICdTQU1QTEUtQUVTLUNFTkMnKSB7XG4gICAgICAgICAgICAgICAgICB0aGlzLnRyaWdnZXIoJ3dhcm4nLCB7XG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICdTQU1QTEUtQUVTLUNFTkMgaXMgZGVwcmVjYXRlZCwgcGxlYXNlIHVzZSBTQU1QTEUtQUVTLUNUUiBpbnN0ZWFkJ1xuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKGVudHJ5LmF0dHJpYnV0ZXMuVVJJLnN1YnN0cmluZygwLCAyMykgIT09ICdkYXRhOnRleHQvcGxhaW47YmFzZTY0LCcpIHtcbiAgICAgICAgICAgICAgICAgIHRoaXMudHJpZ2dlcignd2FybicsIHtcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogJ2ludmFsaWQga2V5IFVSSSBwcm92aWRlZCBmb3IgV2lkZXZpbmUnXG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoIShlbnRyeS5hdHRyaWJ1dGVzLktFWUlEICYmIGVudHJ5LmF0dHJpYnV0ZXMuS0VZSUQuc3Vic3RyaW5nKDAsIDIpID09PSAnMHgnKSkge1xuICAgICAgICAgICAgICAgICAgdGhpcy50cmlnZ2VyKCd3YXJuJywge1xuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiAnaW52YWxpZCBrZXkgSUQgcHJvdmlkZWQgZm9yIFdpZGV2aW5lJ1xuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfSAvLyBpZiBXaWRldmluZSBrZXkgYXR0cmlidXRlcyBhcmUgdmFsaWQsIHN0b3JlIHRoZW0gYXMgYGNvbnRlbnRQcm90ZWN0aW9uYFxuICAgICAgICAgICAgICAgIC8vIG9uIHRoZSBtYW5pZmVzdCB0byBlbXVsYXRlIFdpZGV2aW5lIHRhZyBzdHJ1Y3R1cmUgaW4gYSBEQVNIIG1wZFxuXG5cbiAgICAgICAgICAgICAgICB0aGlzLm1hbmlmZXN0LmNvbnRlbnRQcm90ZWN0aW9uID0gdGhpcy5tYW5pZmVzdC5jb250ZW50UHJvdGVjdGlvbiB8fCB7fTtcbiAgICAgICAgICAgICAgICB0aGlzLm1hbmlmZXN0LmNvbnRlbnRQcm90ZWN0aW9uWydjb20ud2lkZXZpbmUuYWxwaGEnXSA9IHtcbiAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgc2NoZW1lSWRVcmk6IGVudHJ5LmF0dHJpYnV0ZXMuS0VZRk9STUFULFxuICAgICAgICAgICAgICAgICAgICAvLyByZW1vdmUgJzB4JyBmcm9tIHRoZSBrZXkgaWQgc3RyaW5nXG4gICAgICAgICAgICAgICAgICAgIGtleUlkOiBlbnRyeS5hdHRyaWJ1dGVzLktFWUlELnN1YnN0cmluZygyKVxuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgIC8vIGRlY29kZSB0aGUgYmFzZTY0LWVuY29kZWQgUFNTSCBib3hcbiAgICAgICAgICAgICAgICAgIHBzc2g6IGRlY29kZUI2NFRvVWludDhBcnJheShlbnRyeS5hdHRyaWJ1dGVzLlVSSS5zcGxpdCgnLCcpWzFdKVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgaWYgKCFlbnRyeS5hdHRyaWJ1dGVzLk1FVEhPRCkge1xuICAgICAgICAgICAgICAgIHRoaXMudHJpZ2dlcignd2FybicsIHtcbiAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICdkZWZhdWx0aW5nIGtleSBtZXRob2QgdG8gQUVTLTEyOCdcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfSAvLyBzZXR1cCBhbiBlbmNyeXB0aW9uIGtleSBmb3IgdXBjb21pbmcgc2VnbWVudHNcblxuXG4gICAgICAgICAgICAgIGtleSA9IHtcbiAgICAgICAgICAgICAgICBtZXRob2Q6IGVudHJ5LmF0dHJpYnV0ZXMuTUVUSE9EIHx8ICdBRVMtMTI4JyxcbiAgICAgICAgICAgICAgICB1cmk6IGVudHJ5LmF0dHJpYnV0ZXMuVVJJXG4gICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgaWYgKHR5cGVvZiBlbnRyeS5hdHRyaWJ1dGVzLklWICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgIGtleS5pdiA9IGVudHJ5LmF0dHJpYnV0ZXMuSVY7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgICdtZWRpYS1zZXF1ZW5jZScoKSB7XG4gICAgICAgICAgICAgIGlmICghaXNGaW5pdGUoZW50cnkubnVtYmVyKSkge1xuICAgICAgICAgICAgICAgIHRoaXMudHJpZ2dlcignd2FybicsIHtcbiAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICdpZ25vcmluZyBpbnZhbGlkIG1lZGlhIHNlcXVlbmNlOiAnICsgZW50cnkubnVtYmVyXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgdGhpcy5tYW5pZmVzdC5tZWRpYVNlcXVlbmNlID0gZW50cnkubnVtYmVyO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgJ2Rpc2NvbnRpbnVpdHktc2VxdWVuY2UnKCkge1xuICAgICAgICAgICAgICBpZiAoIWlzRmluaXRlKGVudHJ5Lm51bWJlcikpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnRyaWdnZXIoJ3dhcm4nLCB7XG4gICAgICAgICAgICAgICAgICBtZXNzYWdlOiAnaWdub3JpbmcgaW52YWxpZCBkaXNjb250aW51aXR5IHNlcXVlbmNlOiAnICsgZW50cnkubnVtYmVyXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgdGhpcy5tYW5pZmVzdC5kaXNjb250aW51aXR5U2VxdWVuY2UgPSBlbnRyeS5udW1iZXI7XG4gICAgICAgICAgICAgIGN1cnJlbnRUaW1lbGluZSA9IGVudHJ5Lm51bWJlcjtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgICdwbGF5bGlzdC10eXBlJygpIHtcbiAgICAgICAgICAgICAgaWYgKCEvVk9EfEVWRU5ULy50ZXN0KGVudHJ5LnBsYXlsaXN0VHlwZSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnRyaWdnZXIoJ3dhcm4nLCB7XG4gICAgICAgICAgICAgICAgICBtZXNzYWdlOiAnaWdub3JpbmcgdW5rbm93biBwbGF5bGlzdCB0eXBlOiAnICsgZW50cnkucGxheWxpc3RcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICB0aGlzLm1hbmlmZXN0LnBsYXlsaXN0VHlwZSA9IGVudHJ5LnBsYXlsaXN0VHlwZTtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIG1hcCgpIHtcbiAgICAgICAgICAgICAgY3VycmVudE1hcCA9IHt9O1xuXG4gICAgICAgICAgICAgIGlmIChlbnRyeS51cmkpIHtcbiAgICAgICAgICAgICAgICBjdXJyZW50TWFwLnVyaSA9IGVudHJ5LnVyaTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGlmIChlbnRyeS5ieXRlcmFuZ2UpIHtcbiAgICAgICAgICAgICAgICBjdXJyZW50TWFwLmJ5dGVyYW5nZSA9IGVudHJ5LmJ5dGVyYW5nZTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGlmIChrZXkpIHtcbiAgICAgICAgICAgICAgICBjdXJyZW50TWFwLmtleSA9IGtleTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgJ3N0cmVhbS1pbmYnKCkge1xuICAgICAgICAgICAgICB0aGlzLm1hbmlmZXN0LnBsYXlsaXN0cyA9IHVyaXM7XG4gICAgICAgICAgICAgIHRoaXMubWFuaWZlc3QubWVkaWFHcm91cHMgPSB0aGlzLm1hbmlmZXN0Lm1lZGlhR3JvdXBzIHx8IGRlZmF1bHRNZWRpYUdyb3VwcztcblxuICAgICAgICAgICAgICBpZiAoIWVudHJ5LmF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnRyaWdnZXIoJ3dhcm4nLCB7XG4gICAgICAgICAgICAgICAgICBtZXNzYWdlOiAnaWdub3JpbmcgZW1wdHkgc3RyZWFtLWluZiBhdHRyaWJ1dGVzJ1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGlmICghY3VycmVudFVyaS5hdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICAgICAgY3VycmVudFVyaS5hdHRyaWJ1dGVzID0ge307XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBfZXh0ZW5kcyhjdXJyZW50VXJpLmF0dHJpYnV0ZXMsIGVudHJ5LmF0dHJpYnV0ZXMpO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgbWVkaWEoKSB7XG4gICAgICAgICAgICAgIHRoaXMubWFuaWZlc3QubWVkaWFHcm91cHMgPSB0aGlzLm1hbmlmZXN0Lm1lZGlhR3JvdXBzIHx8IGRlZmF1bHRNZWRpYUdyb3VwcztcblxuICAgICAgICAgICAgICBpZiAoIShlbnRyeS5hdHRyaWJ1dGVzICYmIGVudHJ5LmF0dHJpYnV0ZXMuVFlQRSAmJiBlbnRyeS5hdHRyaWJ1dGVzWydHUk9VUC1JRCddICYmIGVudHJ5LmF0dHJpYnV0ZXMuTkFNRSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnRyaWdnZXIoJ3dhcm4nLCB7XG4gICAgICAgICAgICAgICAgICBtZXNzYWdlOiAnaWdub3JpbmcgaW5jb21wbGV0ZSBvciBtaXNzaW5nIG1lZGlhIGdyb3VwJ1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgfSAvLyBmaW5kIHRoZSBtZWRpYSBncm91cCwgY3JlYXRpbmcgZGVmYXVsdHMgYXMgbmVjZXNzYXJ5XG5cblxuICAgICAgICAgICAgICBjb25zdCBtZWRpYUdyb3VwVHlwZSA9IHRoaXMubWFuaWZlc3QubWVkaWFHcm91cHNbZW50cnkuYXR0cmlidXRlcy5UWVBFXTtcbiAgICAgICAgICAgICAgbWVkaWFHcm91cFR5cGVbZW50cnkuYXR0cmlidXRlc1snR1JPVVAtSUQnXV0gPSBtZWRpYUdyb3VwVHlwZVtlbnRyeS5hdHRyaWJ1dGVzWydHUk9VUC1JRCddXSB8fCB7fTtcbiAgICAgICAgICAgICAgbWVkaWFHcm91cCA9IG1lZGlhR3JvdXBUeXBlW2VudHJ5LmF0dHJpYnV0ZXNbJ0dST1VQLUlEJ11dOyAvLyBjb2xsZWN0IHRoZSByZW5kaXRpb24gbWV0YWRhdGFcblxuICAgICAgICAgICAgICByZW5kaXRpb24gPSB7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDogL3llcy9pLnRlc3QoZW50cnkuYXR0cmlidXRlcy5ERUZBVUxUKVxuICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgIGlmIChyZW5kaXRpb24uZGVmYXVsdCkge1xuICAgICAgICAgICAgICAgIHJlbmRpdGlvbi5hdXRvc2VsZWN0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZW5kaXRpb24uYXV0b3NlbGVjdCA9IC95ZXMvaS50ZXN0KGVudHJ5LmF0dHJpYnV0ZXMuQVVUT1NFTEVDVCk7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBpZiAoZW50cnkuYXR0cmlidXRlcy5MQU5HVUFHRSkge1xuICAgICAgICAgICAgICAgIHJlbmRpdGlvbi5sYW5ndWFnZSA9IGVudHJ5LmF0dHJpYnV0ZXMuTEFOR1VBR0U7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBpZiAoZW50cnkuYXR0cmlidXRlcy5VUkkpIHtcbiAgICAgICAgICAgICAgICByZW5kaXRpb24udXJpID0gZW50cnkuYXR0cmlidXRlcy5VUkk7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBpZiAoZW50cnkuYXR0cmlidXRlc1snSU5TVFJFQU0tSUQnXSkge1xuICAgICAgICAgICAgICAgIHJlbmRpdGlvbi5pbnN0cmVhbUlkID0gZW50cnkuYXR0cmlidXRlc1snSU5TVFJFQU0tSUQnXTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGlmIChlbnRyeS5hdHRyaWJ1dGVzLkNIQVJBQ1RFUklTVElDUykge1xuICAgICAgICAgICAgICAgIHJlbmRpdGlvbi5jaGFyYWN0ZXJpc3RpY3MgPSBlbnRyeS5hdHRyaWJ1dGVzLkNIQVJBQ1RFUklTVElDUztcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGlmIChlbnRyeS5hdHRyaWJ1dGVzLkZPUkNFRCkge1xuICAgICAgICAgICAgICAgIHJlbmRpdGlvbi5mb3JjZWQgPSAveWVzL2kudGVzdChlbnRyeS5hdHRyaWJ1dGVzLkZPUkNFRCk7XG4gICAgICAgICAgICAgIH0gLy8gaW5zZXJ0IHRoZSBuZXcgcmVuZGl0aW9uXG5cblxuICAgICAgICAgICAgICBtZWRpYUdyb3VwW2VudHJ5LmF0dHJpYnV0ZXMuTkFNRV0gPSByZW5kaXRpb247XG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICBkaXNjb250aW51aXR5KCkge1xuICAgICAgICAgICAgICBjdXJyZW50VGltZWxpbmUgKz0gMTtcbiAgICAgICAgICAgICAgY3VycmVudFVyaS5kaXNjb250aW51aXR5ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgdGhpcy5tYW5pZmVzdC5kaXNjb250aW51aXR5U3RhcnRzLnB1c2godXJpcy5sZW5ndGgpO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgJ3Byb2dyYW0tZGF0ZS10aW1lJygpIHtcbiAgICAgICAgICAgICAgaWYgKHR5cGVvZiB0aGlzLm1hbmlmZXN0LmRhdGVUaW1lU3RyaW5nID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgIC8vIFBST0dSQU0tREFURS1USU1FIGlzIGEgbWVkaWEtc2VnbWVudCB0YWcsIGJ1dCBmb3IgYmFja3dhcmRzXG4gICAgICAgICAgICAgICAgLy8gY29tcGF0aWJpbGl0eSwgd2UgYWRkIHRoZSBmaXJzdCBvY2N1cmVuY2Ugb2YgdGhlIFBST0dSQU0tREFURS1USU1FIHRhZ1xuICAgICAgICAgICAgICAgIC8vIHRvIHRoZSBtYW5pZmVzdCBvYmplY3RcbiAgICAgICAgICAgICAgICAvLyBUT0RPOiBDb25zaWRlciByZW1vdmluZyB0aGlzIGluIGZ1dHVyZSBtYWpvciB2ZXJzaW9uXG4gICAgICAgICAgICAgICAgdGhpcy5tYW5pZmVzdC5kYXRlVGltZVN0cmluZyA9IGVudHJ5LmRhdGVUaW1lU3RyaW5nO1xuICAgICAgICAgICAgICAgIHRoaXMubWFuaWZlc3QuZGF0ZVRpbWVPYmplY3QgPSBlbnRyeS5kYXRlVGltZU9iamVjdDtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGN1cnJlbnRVcmkuZGF0ZVRpbWVTdHJpbmcgPSBlbnRyeS5kYXRlVGltZVN0cmluZztcbiAgICAgICAgICAgICAgY3VycmVudFVyaS5kYXRlVGltZU9iamVjdCA9IGVudHJ5LmRhdGVUaW1lT2JqZWN0O1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgdGFyZ2V0ZHVyYXRpb24oKSB7XG4gICAgICAgICAgICAgIGlmICghaXNGaW5pdGUoZW50cnkuZHVyYXRpb24pIHx8IGVudHJ5LmR1cmF0aW9uIDwgMCkge1xuICAgICAgICAgICAgICAgIHRoaXMudHJpZ2dlcignd2FybicsIHtcbiAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICdpZ25vcmluZyBpbnZhbGlkIHRhcmdldCBkdXJhdGlvbjogJyArIGVudHJ5LmR1cmF0aW9uXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgdGhpcy5tYW5pZmVzdC50YXJnZXREdXJhdGlvbiA9IGVudHJ5LmR1cmF0aW9uO1xuICAgICAgICAgICAgICBzZXRIb2xkQmFjay5jYWxsKHRoaXMsIHRoaXMubWFuaWZlc3QpO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgc3RhcnQoKSB7XG4gICAgICAgICAgICAgIGlmICghZW50cnkuYXR0cmlidXRlcyB8fCBpc05hTihlbnRyeS5hdHRyaWJ1dGVzWydUSU1FLU9GRlNFVCddKSkge1xuICAgICAgICAgICAgICAgIHRoaXMudHJpZ2dlcignd2FybicsIHtcbiAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICdpZ25vcmluZyBzdGFydCBkZWNsYXJhdGlvbiB3aXRob3V0IGFwcHJvcHJpYXRlIGF0dHJpYnV0ZSBsaXN0J1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIHRoaXMubWFuaWZlc3Quc3RhcnQgPSB7XG4gICAgICAgICAgICAgICAgdGltZU9mZnNldDogZW50cnkuYXR0cmlidXRlc1snVElNRS1PRkZTRVQnXSxcbiAgICAgICAgICAgICAgICBwcmVjaXNlOiBlbnRyeS5hdHRyaWJ1dGVzLlBSRUNJU0VcbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgICdjdWUtb3V0JygpIHtcbiAgICAgICAgICAgICAgY3VycmVudFVyaS5jdWVPdXQgPSBlbnRyeS5kYXRhO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgJ2N1ZS1vdXQtY29udCcoKSB7XG4gICAgICAgICAgICAgIGN1cnJlbnRVcmkuY3VlT3V0Q29udCA9IGVudHJ5LmRhdGE7XG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAnY3VlLWluJygpIHtcbiAgICAgICAgICAgICAgY3VycmVudFVyaS5jdWVJbiA9IGVudHJ5LmRhdGE7XG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAnc2tpcCcoKSB7XG4gICAgICAgICAgICAgIHRoaXMubWFuaWZlc3Quc2tpcCA9IGNhbWVsQ2FzZUtleXMoZW50cnkuYXR0cmlidXRlcyk7XG4gICAgICAgICAgICAgIHRoaXMud2Fybk9uTWlzc2luZ0F0dHJpYnV0ZXNfKCcjRVhULVgtU0tJUCcsIGVudHJ5LmF0dHJpYnV0ZXMsIFsnU0tJUFBFRC1TRUdNRU5UUyddKTtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgICdwYXJ0JygpIHtcbiAgICAgICAgICAgICAgaGFzUGFydHMgPSB0cnVlOyAvLyBwYXJ0cyBhcmUgYWx3YXlzIHNwZWNpZmVkIGJlZm9yZSBhIHNlZ21lbnRcblxuICAgICAgICAgICAgICBjb25zdCBzZWdtZW50SW5kZXggPSB0aGlzLm1hbmlmZXN0LnNlZ21lbnRzLmxlbmd0aDtcbiAgICAgICAgICAgICAgY29uc3QgcGFydCA9IGNhbWVsQ2FzZUtleXMoZW50cnkuYXR0cmlidXRlcyk7XG4gICAgICAgICAgICAgIGN1cnJlbnRVcmkucGFydHMgPSBjdXJyZW50VXJpLnBhcnRzIHx8IFtdO1xuICAgICAgICAgICAgICBjdXJyZW50VXJpLnBhcnRzLnB1c2gocGFydCk7XG5cbiAgICAgICAgICAgICAgaWYgKHBhcnQuYnl0ZXJhbmdlKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFwYXJ0LmJ5dGVyYW5nZS5oYXNPd25Qcm9wZXJ0eSgnb2Zmc2V0JykpIHtcbiAgICAgICAgICAgICAgICAgIHBhcnQuYnl0ZXJhbmdlLm9mZnNldCA9IGxhc3RQYXJ0Qnl0ZXJhbmdlRW5kO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGxhc3RQYXJ0Qnl0ZXJhbmdlRW5kID0gcGFydC5ieXRlcmFuZ2Uub2Zmc2V0ICsgcGFydC5ieXRlcmFuZ2UubGVuZ3RoO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgY29uc3QgcGFydEluZGV4ID0gY3VycmVudFVyaS5wYXJ0cy5sZW5ndGggLSAxO1xuICAgICAgICAgICAgICB0aGlzLndhcm5Pbk1pc3NpbmdBdHRyaWJ1dGVzXyhgI0VYVC1YLVBBUlQgIyR7cGFydEluZGV4fSBmb3Igc2VnbWVudCAjJHtzZWdtZW50SW5kZXh9YCwgZW50cnkuYXR0cmlidXRlcywgWydVUkknLCAnRFVSQVRJT04nXSk7XG5cbiAgICAgICAgICAgICAgaWYgKHRoaXMubWFuaWZlc3QucmVuZGl0aW9uUmVwb3J0cykge1xuICAgICAgICAgICAgICAgIHRoaXMubWFuaWZlc3QucmVuZGl0aW9uUmVwb3J0cy5mb3JFYWNoKChyLCBpKSA9PiB7XG4gICAgICAgICAgICAgICAgICBpZiAoIXIuaGFzT3duUHJvcGVydHkoJ2xhc3RQYXJ0JykpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50cmlnZ2VyKCd3YXJuJywge1xuICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IGAjRVhULVgtUkVORElUSU9OLVJFUE9SVCAjJHtpfSBsYWNrcyByZXF1aXJlZCBhdHRyaWJ1dGUocyk6IExBU1QtUEFSVGBcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgICdzZXJ2ZXItY29udHJvbCcoKSB7XG4gICAgICAgICAgICAgIGNvbnN0IGF0dHJzID0gdGhpcy5tYW5pZmVzdC5zZXJ2ZXJDb250cm9sID0gY2FtZWxDYXNlS2V5cyhlbnRyeS5hdHRyaWJ1dGVzKTtcblxuICAgICAgICAgICAgICBpZiAoIWF0dHJzLmhhc093blByb3BlcnR5KCdjYW5CbG9ja1JlbG9hZCcpKSB7XG4gICAgICAgICAgICAgICAgYXR0cnMuY2FuQmxvY2tSZWxvYWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB0aGlzLnRyaWdnZXIoJ2luZm8nLCB7XG4gICAgICAgICAgICAgICAgICBtZXNzYWdlOiAnI0VYVC1YLVNFUlZFUi1DT05UUk9MIGRlZmF1bHRpbmcgQ0FOLUJMT0NLLVJFTE9BRCB0byBmYWxzZSdcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIHNldEhvbGRCYWNrLmNhbGwodGhpcywgdGhpcy5tYW5pZmVzdCk7XG5cbiAgICAgICAgICAgICAgaWYgKGF0dHJzLmNhblNraXBEYXRlcmFuZ2VzICYmICFhdHRycy5oYXNPd25Qcm9wZXJ0eSgnY2FuU2tpcFVudGlsJykpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnRyaWdnZXIoJ3dhcm4nLCB7XG4gICAgICAgICAgICAgICAgICBtZXNzYWdlOiAnI0VYVC1YLVNFUlZFUi1DT05UUk9MIGxhY2tzIHJlcXVpcmVkIGF0dHJpYnV0ZSBDQU4tU0tJUC1VTlRJTCB3aGljaCBpcyByZXF1aXJlZCB3aGVuIENBTi1TS0lQLURBVEVSQU5HRVMgaXMgc2V0J1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAncHJlbG9hZC1oaW50JygpIHtcbiAgICAgICAgICAgICAgLy8gcGFydHMgYXJlIGFsd2F5cyBzcGVjaWZlZCBiZWZvcmUgYSBzZWdtZW50XG4gICAgICAgICAgICAgIGNvbnN0IHNlZ21lbnRJbmRleCA9IHRoaXMubWFuaWZlc3Quc2VnbWVudHMubGVuZ3RoO1xuICAgICAgICAgICAgICBjb25zdCBoaW50ID0gY2FtZWxDYXNlS2V5cyhlbnRyeS5hdHRyaWJ1dGVzKTtcbiAgICAgICAgICAgICAgY29uc3QgaXNQYXJ0ID0gaGludC50eXBlICYmIGhpbnQudHlwZSA9PT0gJ1BBUlQnO1xuICAgICAgICAgICAgICBjdXJyZW50VXJpLnByZWxvYWRIaW50cyA9IGN1cnJlbnRVcmkucHJlbG9hZEhpbnRzIHx8IFtdO1xuICAgICAgICAgICAgICBjdXJyZW50VXJpLnByZWxvYWRIaW50cy5wdXNoKGhpbnQpO1xuXG4gICAgICAgICAgICAgIGlmIChoaW50LmJ5dGVyYW5nZSkge1xuICAgICAgICAgICAgICAgIGlmICghaGludC5ieXRlcmFuZ2UuaGFzT3duUHJvcGVydHkoJ29mZnNldCcpKSB7XG4gICAgICAgICAgICAgICAgICAvLyB1c2UgbGFzdCBwYXJ0IGJ5dGVyYW5nZSBlbmQgb3IgemVybyBpZiBub3QgYSBwYXJ0LlxuICAgICAgICAgICAgICAgICAgaGludC5ieXRlcmFuZ2Uub2Zmc2V0ID0gaXNQYXJ0ID8gbGFzdFBhcnRCeXRlcmFuZ2VFbmQgOiAwO1xuXG4gICAgICAgICAgICAgICAgICBpZiAoaXNQYXJ0KSB7XG4gICAgICAgICAgICAgICAgICAgIGxhc3RQYXJ0Qnl0ZXJhbmdlRW5kID0gaGludC5ieXRlcmFuZ2Uub2Zmc2V0ICsgaGludC5ieXRlcmFuZ2UubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gY3VycmVudFVyaS5wcmVsb2FkSGludHMubGVuZ3RoIC0gMTtcbiAgICAgICAgICAgICAgdGhpcy53YXJuT25NaXNzaW5nQXR0cmlidXRlc18oYCNFWFQtWC1QUkVMT0FELUhJTlQgIyR7aW5kZXh9IGZvciBzZWdtZW50ICMke3NlZ21lbnRJbmRleH1gLCBlbnRyeS5hdHRyaWJ1dGVzLCBbJ1RZUEUnLCAnVVJJJ10pO1xuXG4gICAgICAgICAgICAgIGlmICghaGludC50eXBlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICB9IC8vIHNlYXJjaCB0aHJvdWdoIGFsbCBwcmVsb2FkIGhpbnRzIGV4Y2VwdCBmb3IgdGhlIGN1cnJlbnQgb25lIGZvclxuICAgICAgICAgICAgICAvLyBhIGR1cGxpY2F0ZSB0eXBlLlxuXG5cbiAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjdXJyZW50VXJpLnByZWxvYWRIaW50cy5sZW5ndGggLSAxOyBpKyspIHtcbiAgICAgICAgICAgICAgICBjb25zdCBvdGhlckhpbnQgPSBjdXJyZW50VXJpLnByZWxvYWRIaW50c1tpXTtcblxuICAgICAgICAgICAgICAgIGlmICghb3RoZXJIaW50LnR5cGUpIHtcbiAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChvdGhlckhpbnQudHlwZSA9PT0gaGludC50eXBlKSB7XG4gICAgICAgICAgICAgICAgICB0aGlzLnRyaWdnZXIoJ3dhcm4nLCB7XG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IGAjRVhULVgtUFJFTE9BRC1ISU5UICMke2luZGV4fSBmb3Igc2VnbWVudCAjJHtzZWdtZW50SW5kZXh9IGhhcyB0aGUgc2FtZSBUWVBFICR7aGludC50eXBlfSBhcyBwcmVsb2FkIGhpbnQgIyR7aX1gXG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgICdyZW5kaXRpb24tcmVwb3J0JygpIHtcbiAgICAgICAgICAgICAgY29uc3QgcmVwb3J0ID0gY2FtZWxDYXNlS2V5cyhlbnRyeS5hdHRyaWJ1dGVzKTtcbiAgICAgICAgICAgICAgdGhpcy5tYW5pZmVzdC5yZW5kaXRpb25SZXBvcnRzID0gdGhpcy5tYW5pZmVzdC5yZW5kaXRpb25SZXBvcnRzIHx8IFtdO1xuICAgICAgICAgICAgICB0aGlzLm1hbmlmZXN0LnJlbmRpdGlvblJlcG9ydHMucHVzaChyZXBvcnQpO1xuICAgICAgICAgICAgICBjb25zdCBpbmRleCA9IHRoaXMubWFuaWZlc3QucmVuZGl0aW9uUmVwb3J0cy5sZW5ndGggLSAxO1xuICAgICAgICAgICAgICBjb25zdCByZXF1aXJlZCA9IFsnTEFTVC1NU04nLCAnVVJJJ107XG5cbiAgICAgICAgICAgICAgaWYgKGhhc1BhcnRzKSB7XG4gICAgICAgICAgICAgICAgcmVxdWlyZWQucHVzaCgnTEFTVC1QQVJUJyk7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICB0aGlzLndhcm5Pbk1pc3NpbmdBdHRyaWJ1dGVzXyhgI0VYVC1YLVJFTkRJVElPTi1SRVBPUlQgIyR7aW5kZXh9YCwgZW50cnkuYXR0cmlidXRlcywgcmVxdWlyZWQpO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgJ3BhcnQtaW5mJygpIHtcbiAgICAgICAgICAgICAgdGhpcy5tYW5pZmVzdC5wYXJ0SW5mID0gY2FtZWxDYXNlS2V5cyhlbnRyeS5hdHRyaWJ1dGVzKTtcbiAgICAgICAgICAgICAgdGhpcy53YXJuT25NaXNzaW5nQXR0cmlidXRlc18oJyNFWFQtWC1QQVJULUlORicsIGVudHJ5LmF0dHJpYnV0ZXMsIFsnUEFSVC1UQVJHRVQnXSk7XG5cbiAgICAgICAgICAgICAgaWYgKHRoaXMubWFuaWZlc3QucGFydEluZi5wYXJ0VGFyZ2V0KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5tYW5pZmVzdC5wYXJ0VGFyZ2V0RHVyYXRpb24gPSB0aGlzLm1hbmlmZXN0LnBhcnRJbmYucGFydFRhcmdldDtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIHNldEhvbGRCYWNrLmNhbGwodGhpcywgdGhpcy5tYW5pZmVzdCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICB9KVtlbnRyeS50YWdUeXBlXSB8fCBub29wKS5jYWxsKHNlbGYpO1xuICAgICAgICB9LFxuXG4gICAgICAgIHVyaSgpIHtcbiAgICAgICAgICBjdXJyZW50VXJpLnVyaSA9IGVudHJ5LnVyaTtcbiAgICAgICAgICB1cmlzLnB1c2goY3VycmVudFVyaSk7IC8vIGlmIG5vIGV4cGxpY2l0IGR1cmF0aW9uIHdhcyBkZWNsYXJlZCwgdXNlIHRoZSB0YXJnZXQgZHVyYXRpb25cblxuICAgICAgICAgIGlmICh0aGlzLm1hbmlmZXN0LnRhcmdldER1cmF0aW9uICYmICEoJ2R1cmF0aW9uJyBpbiBjdXJyZW50VXJpKSkge1xuICAgICAgICAgICAgdGhpcy50cmlnZ2VyKCd3YXJuJywge1xuICAgICAgICAgICAgICBtZXNzYWdlOiAnZGVmYXVsdGluZyBzZWdtZW50IGR1cmF0aW9uIHRvIHRoZSB0YXJnZXQgZHVyYXRpb24nXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGN1cnJlbnRVcmkuZHVyYXRpb24gPSB0aGlzLm1hbmlmZXN0LnRhcmdldER1cmF0aW9uO1xuICAgICAgICAgIH0gLy8gYW5ub3RhdGUgd2l0aCBlbmNyeXB0aW9uIGluZm9ybWF0aW9uLCBpZiBuZWNlc3NhcnlcblxuXG4gICAgICAgICAgaWYgKGtleSkge1xuICAgICAgICAgICAgY3VycmVudFVyaS5rZXkgPSBrZXk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgY3VycmVudFVyaS50aW1lbGluZSA9IGN1cnJlbnRUaW1lbGluZTsgLy8gYW5ub3RhdGUgd2l0aCBpbml0aWFsaXphdGlvbiBzZWdtZW50IGluZm9ybWF0aW9uLCBpZiBuZWNlc3NhcnlcblxuICAgICAgICAgIGlmIChjdXJyZW50TWFwKSB7XG4gICAgICAgICAgICBjdXJyZW50VXJpLm1hcCA9IGN1cnJlbnRNYXA7XG4gICAgICAgICAgfSAvLyByZXNldCB0aGUgbGFzdCBieXRlcmFuZ2UgZW5kIGFzIGl0IG5lZWRzIHRvIGJlIDAgYmV0d2VlbiBwYXJ0c1xuXG5cbiAgICAgICAgICBsYXN0UGFydEJ5dGVyYW5nZUVuZCA9IDA7IC8vIHByZXBhcmUgZm9yIHRoZSBuZXh0IFVSSVxuXG4gICAgICAgICAgY3VycmVudFVyaSA9IHt9O1xuICAgICAgICB9LFxuXG4gICAgICAgIGNvbW1lbnQoKSB7Ly8gY29tbWVudHMgYXJlIG5vdCBpbXBvcnRhbnQgZm9yIHBsYXliYWNrXG4gICAgICAgIH0sXG5cbiAgICAgICAgY3VzdG9tKCkge1xuICAgICAgICAgIC8vIGlmIHRoaXMgaXMgc2VnbWVudC1sZXZlbCBkYXRhIGF0dGFjaCB0aGUgb3V0cHV0IHRvIHRoZSBzZWdtZW50XG4gICAgICAgICAgaWYgKGVudHJ5LnNlZ21lbnQpIHtcbiAgICAgICAgICAgIGN1cnJlbnRVcmkuY3VzdG9tID0gY3VycmVudFVyaS5jdXN0b20gfHwge307XG4gICAgICAgICAgICBjdXJyZW50VXJpLmN1c3RvbVtlbnRyeS5jdXN0b21UeXBlXSA9IGVudHJ5LmRhdGE7IC8vIGlmIHRoaXMgaXMgbWFuaWZlc3QtbGV2ZWwgZGF0YSBhdHRhY2ggdG8gdGhlIHRvcCBsZXZlbCBtYW5pZmVzdCBvYmplY3RcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5tYW5pZmVzdC5jdXN0b20gPSB0aGlzLm1hbmlmZXN0LmN1c3RvbSB8fCB7fTtcbiAgICAgICAgICAgIHRoaXMubWFuaWZlc3QuY3VzdG9tW2VudHJ5LmN1c3RvbVR5cGVdID0gZW50cnkuZGF0YTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgfSlbZW50cnkudHlwZV0uY2FsbChzZWxmKTtcbiAgICB9KTtcbiAgfVxuXG4gIHdhcm5Pbk1pc3NpbmdBdHRyaWJ1dGVzXyhpZGVudGlmaWVyLCBhdHRyaWJ1dGVzLCByZXF1aXJlZCkge1xuICAgIGNvbnN0IG1pc3NpbmcgPSBbXTtcbiAgICByZXF1aXJlZC5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgIGlmICghYXR0cmlidXRlcy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgIG1pc3NpbmcucHVzaChrZXkpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaWYgKG1pc3NpbmcubGVuZ3RoKSB7XG4gICAgICB0aGlzLnRyaWdnZXIoJ3dhcm4nLCB7XG4gICAgICAgIG1lc3NhZ2U6IGAke2lkZW50aWZpZXJ9IGxhY2tzIHJlcXVpcmVkIGF0dHJpYnV0ZShzKTogJHttaXNzaW5nLmpvaW4oJywgJyl9YFxuICAgICAgfSk7XG4gICAgfVxuICB9XG4gIC8qKlxuICAgKiBQYXJzZSB0aGUgaW5wdXQgc3RyaW5nIGFuZCB1cGRhdGUgdGhlIG1hbmlmZXN0IG9iamVjdC5cbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IGNodW5rIGEgcG90ZW50aWFsbHkgaW5jb21wbGV0ZSBwb3J0aW9uIG9mIHRoZSBtYW5pZmVzdFxuICAgKi9cblxuXG4gIHB1c2goY2h1bmspIHtcbiAgICB0aGlzLmxpbmVTdHJlYW0ucHVzaChjaHVuayk7XG4gIH1cbiAgLyoqXG4gICAqIEZsdXNoIGFueSByZW1haW5pbmcgaW5wdXQuIFRoaXMgY2FuIGJlIGhhbmR5IGlmIHRoZSBsYXN0IGxpbmUgb2YgYW4gTTNVOFxuICAgKiBtYW5pZmVzdCBkaWQgbm90IGNvbnRhaW4gYSB0cmFpbGluZyBuZXdsaW5lIGJ1dCB0aGUgZmlsZSBoYXMgYmVlblxuICAgKiBjb21wbGV0ZWx5IHJlY2VpdmVkLlxuICAgKi9cblxuXG4gIGVuZCgpIHtcbiAgICAvLyBmbHVzaCBhbnkgYnVmZmVyZWQgaW5wdXRcbiAgICB0aGlzLmxpbmVTdHJlYW0ucHVzaCgnXFxuJyk7XG4gICAgdGhpcy50cmlnZ2VyKCdlbmQnKTtcbiAgfVxuICAvKipcbiAgICogQWRkIGFuIGFkZGl0aW9uYWwgcGFyc2VyIGZvciBub24tc3RhbmRhcmQgdGFnc1xuICAgKlxuICAgKiBAcGFyYW0ge09iamVjdH0gICBvcHRpb25zICAgICAgICAgICAgICBhIG1hcCBvZiBvcHRpb25zIGZvciB0aGUgYWRkZWQgcGFyc2VyXG4gICAqIEBwYXJhbSB7UmVnRXhwfSAgIG9wdGlvbnMuZXhwcmVzc2lvbiAgIGEgcmVndWxhciBleHByZXNzaW9uIHRvIG1hdGNoIHRoZSBjdXN0b20gaGVhZGVyXG4gICAqIEBwYXJhbSB7c3RyaW5nfSAgIG9wdGlvbnMudHlwZSAgICAgICAgIHRoZSB0eXBlIHRvIHJlZ2lzdGVyIHRvIHRoZSBvdXRwdXRcbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gW29wdGlvbnMuZGF0YVBhcnNlcl0gZnVuY3Rpb24gdG8gcGFyc2UgdGhlIGxpbmUgaW50byBhbiBvYmplY3RcbiAgICogQHBhcmFtIHtib29sZWFufSAgW29wdGlvbnMuc2VnbWVudF0gICAgc2hvdWxkIHRhZyBkYXRhIGJlIGF0dGFjaGVkIHRvIHRoZSBzZWdtZW50IG9iamVjdFxuICAgKi9cblxuXG4gIGFkZFBhcnNlcihvcHRpb25zKSB7XG4gICAgdGhpcy5wYXJzZVN0cmVhbS5hZGRQYXJzZXIob3B0aW9ucyk7XG4gIH1cbiAgLyoqXG4gICAqIEFkZCBhIGN1c3RvbSBoZWFkZXIgbWFwcGVyXG4gICAqXG4gICAqIEBwYXJhbSB7T2JqZWN0fSAgIG9wdGlvbnNcbiAgICogQHBhcmFtIHtSZWdFeHB9ICAgb3B0aW9ucy5leHByZXNzaW9uICAgYSByZWd1bGFyIGV4cHJlc3Npb24gdG8gbWF0Y2ggdGhlIGN1c3RvbSBoZWFkZXJcbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gb3B0aW9ucy5tYXAgICAgICAgICAgZnVuY3Rpb24gdG8gdHJhbnNsYXRlIHRhZyBpbnRvIGEgZGlmZmVyZW50IHRhZ1xuICAgKi9cblxuXG4gIGFkZFRhZ01hcHBlcihvcHRpb25zKSB7XG4gICAgdGhpcy5wYXJzZVN0cmVhbS5hZGRUYWdNYXBwZXIob3B0aW9ucyk7XG4gIH1cblxufVxuXG5leHBvcnQgeyBMaW5lU3RyZWFtLCBQYXJzZVN0cmVhbSwgUGFyc2VyIH07XG4iLCJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBfZXh0ZW5kcygpIHtcbiAgX2V4dGVuZHMgPSBPYmplY3QuYXNzaWduID8gT2JqZWN0LmFzc2lnbi5iaW5kKCkgOiBmdW5jdGlvbiAodGFyZ2V0KSB7XG4gICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV07XG4gICAgICBmb3IgKHZhciBrZXkgaW4gc291cmNlKSB7XG4gICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoc291cmNlLCBrZXkpKSB7XG4gICAgICAgICAgdGFyZ2V0W2tleV0gPSBzb3VyY2Vba2V5XTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdGFyZ2V0O1xuICB9O1xuICByZXR1cm4gX2V4dGVuZHMuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn0iLCIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHR2YXIgY2FjaGVkTW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXTtcblx0aWYgKGNhY2hlZE1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0cmV0dXJuIGNhY2hlZE1vZHVsZS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuIiwiLy8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbl9fd2VicGFja19yZXF1aXJlX18ubiA9IChtb2R1bGUpID0+IHtcblx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG5cdFx0KCkgPT4gKG1vZHVsZVsnZGVmYXVsdCddKSA6XG5cdFx0KCkgPT4gKG1vZHVsZSk7XG5cdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsIHsgYTogZ2V0dGVyIH0pO1xuXHRyZXR1cm4gZ2V0dGVyO1xufTsiLCIvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9ucyBmb3IgaGFybW9ueSBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSAoZXhwb3J0cywgZGVmaW5pdGlvbikgPT4ge1xuXHRmb3IodmFyIGtleSBpbiBkZWZpbml0aW9uKSB7XG5cdFx0aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKGRlZmluaXRpb24sIGtleSkgJiYgIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBrZXkpKSB7XG5cdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywga2V5LCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZGVmaW5pdGlvbltrZXldIH0pO1xuXHRcdH1cblx0fVxufTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLmcgPSAoZnVuY3Rpb24oKSB7XG5cdGlmICh0eXBlb2YgZ2xvYmFsVGhpcyA9PT0gJ29iamVjdCcpIHJldHVybiBnbG9iYWxUaGlzO1xuXHR0cnkge1xuXHRcdHJldHVybiB0aGlzIHx8IG5ldyBGdW5jdGlvbigncmV0dXJuIHRoaXMnKSgpO1xuXHR9IGNhdGNoIChlKSB7XG5cdFx0aWYgKHR5cGVvZiB3aW5kb3cgPT09ICdvYmplY3QnKSByZXR1cm4gd2luZG93O1xuXHR9XG59KSgpOyIsIl9fd2VicGFja19yZXF1aXJlX18ubyA9IChvYmosIHByb3ApID0+IChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKSkiLCIvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSAoZXhwb3J0cykgPT4ge1xuXHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcblx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcblx0fVxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xufTsiLCIiLCIvLyBzdGFydHVwXG4vLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbi8vIFRoaXMgZW50cnkgbW9kdWxlIGlzIHJlZmVyZW5jZWQgYnkgb3RoZXIgbW9kdWxlcyBzbyBpdCBjYW4ndCBiZSBpbmxpbmVkXG52YXIgX193ZWJwYWNrX2V4cG9ydHNfXyA9IF9fd2VicGFja19yZXF1aXJlX18oXCIuL3NyYy9hcHAud29ya2VyLnRzXCIpO1xuIiwiIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9";

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/global */
/******/ 	(() => {
/******/ 		__webpack_require__.g = (function() {
/******/ 			if (typeof globalThis === 'object') return globalThis;
/******/ 			try {
/******/ 				return this || new Function('return this')();
/******/ 			} catch (e) {
/******/ 				if (typeof window === 'object') return window;
/******/ 			}
/******/ 		})();
/******/ 	})();
/******/ 	
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module is referenced by other modules so it can't be inlined
/******/ 	var __webpack_exports__ = __webpack_require__("./src/index.ts");
/******/ 	
/******/ })()
;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYnVuZGxlLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFBYTtBQUNiO0FBQ0EsNEJBQTRCLCtEQUErRCxpQkFBaUI7QUFDNUc7QUFDQSxvQ0FBb0MsTUFBTSwrQkFBK0IsWUFBWTtBQUNyRixtQ0FBbUMsTUFBTSxtQ0FBbUMsWUFBWTtBQUN4RixnQ0FBZ0M7QUFDaEM7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLDZDQUE2QztBQUM3QztBQUNBLDhDQUE2QyxFQUFFLGFBQWEsRUFBQztBQUM3RDtBQUNBO0FBQ0Esd0NBQXdDLG1CQUFPLENBQUMsbURBQXVCO0FBQ3ZFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0M7QUFDbEMsdUJBQXVCLGNBQWMsR0FBRztBQUN4QywrREFBK0QseUJBQXlCO0FBQ3hGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLHFCQUFNO0FBQ3RCLGdCQUFnQixxQkFBTTtBQUN0QiwyQ0FBMkMscUJBQU07QUFDakQ7QUFDQTtBQUNBLGlEQUFpRCx1Q0FBdUM7QUFDeEY7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkNBQTZDLGtDQUFrQztBQUMvRTtBQUNBO0FBQ0E7QUFDQSxpREFBaUQsb0RBQW9EO0FBQ3JHO0FBQ0E7QUFDQTtBQUNBLGlEQUFpRCwyQ0FBMkM7QUFDNUY7QUFDQTtBQUNBO0FBQ0EsaURBQWlELDBDQUEwQztBQUMzRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaURBQWlELDBEQUEwRDtBQUMzRztBQUNBO0FBQ0E7QUFDQSxpREFBaUQsZ0NBQWdDO0FBQ2pGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaURBQWlELGtEQUFrRDtBQUNuRztBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxDQUFDO0FBQ0QsMkNBQTJDOzs7Ozs7Ozs7Ozs7Ozs7O1VDL0czQztVQUNBOztVQUVBO1VBQ0E7VUFDQTtVQUNBO1VBQ0E7VUFDQTtVQUNBO1VBQ0E7VUFDQTtVQUNBO1VBQ0E7VUFDQTtVQUNBOztVQUVBO1VBQ0E7O1VBRUE7VUFDQTtVQUNBOzs7OztXQ3RCQTtXQUNBO1dBQ0E7V0FDQTtXQUNBLEdBQUc7V0FDSDtXQUNBO1dBQ0EsQ0FBQzs7Ozs7VUVQRDtVQUNBO1VBQ0E7VUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3NyYy9pbmRleC50cyIsIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vL3dlYnBhY2svcnVudGltZS9nbG9iYWwiLCJ3ZWJwYWNrOi8vL3dlYnBhY2svYmVmb3JlLXN0YXJ0dXAiLCJ3ZWJwYWNrOi8vL3dlYnBhY2svc3RhcnR1cCIsIndlYnBhY2s6Ly8vd2VicGFjay9hZnRlci1zdGFydHVwIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xyXG52YXIgX19hd2FpdGVyID0gKHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcclxuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxyXG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XHJcbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xyXG4gICAgfSk7XHJcbn07XHJcbnZhciBfX2ltcG9ydERlZmF1bHQgPSAodGhpcyAmJiB0aGlzLl9faW1wb3J0RGVmYXVsdCkgfHwgZnVuY3Rpb24gKG1vZCkge1xyXG4gICAgcmV0dXJuIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpID8gbW9kIDogeyBcImRlZmF1bHRcIjogbW9kIH07XHJcbn07XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuLy90aGlzIGxpbmUgZ29ubmEgaW1wb3J0IHRoZSBjb250ZW50IGZyb20gY29tcGlsZSB3b3JrZXIgYXMgc3RyaW5nXHJcbi8vQHRzLWV4cGVjdC1lcnJvclxyXG5jb25zdCBhcHBfd29ya2VyX2pzXzEgPSBfX2ltcG9ydERlZmF1bHQocmVxdWlyZShcIi4uL2Rpc3QvYXBwLndvcmtlci5qc1wiKSk7XHJcbihmdW5jdGlvbiAoKSB7XHJcbiAgICBsZXQgbWFpbldvcmtlcjtcclxuICAgIHdpbmRvdy5Xb3JrZXIgPSBjbGFzcyBXb3JrZXJJbmplY3RvciBleHRlbmRzIFdvcmtlciB7XHJcbiAgICAgICAgY29uc3RydWN0b3IodHdpdGNoQmxvYlVybCkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIm5ldyB3b3JrZXIgaW50YW5jZSBcIiArIHR3aXRjaEJsb2JVcmwpO1xyXG4gICAgICAgICAgICBpZiAodHdpdGNoQmxvYlVybCA9PSBcIlwiKVxyXG4gICAgICAgICAgICAgICAgc3VwZXIodHdpdGNoQmxvYlVybCk7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiW1B1cnBsZV06IGluaXQgXCIgKyB0d2l0Y2hCbG9iVXJsKTtcclxuICAgICAgICAgICAgY29uc3QgbmV3QmxvYlN0ciA9IGAke2FwcF93b3JrZXJfanNfMS5kZWZhdWx0fVxuICAgICAgaW1wb3J0U2NyaXB0cygnJHt0d2l0Y2hCbG9iVXJsfScpO2A7XHJcbiAgICAgICAgICAgIHN1cGVyKFVSTC5jcmVhdGVPYmplY3RVUkwobmV3IEJsb2IoW25ld0Jsb2JTdHJdLCB7IHR5cGU6IFwidGV4dC9qYXZhc2NyaXB0XCIgfSkpKTtcclxuICAgICAgICAgICAgbWFpbldvcmtlciA9IHRoaXM7XHJcbiAgICAgICAgICAgIG1haW5Xb3JrZXIuZGVjbGFyZUV2ZW50V29ya2VyKCk7XHJcbiAgICAgICAgICAgIG1haW5Xb3JrZXIuZGVjbGFyZUV2ZW50V2luZG93KCk7XHJcbiAgICAgICAgICAgIG1haW5Xb3JrZXIuaW50ZWdyaXR5KCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGludGVncml0eSgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcclxuICAgICAgICAgICAgICAgIGdsb2JhbC5yZXF1ZXN0ID0gZmV0Y2g7XHJcbiAgICAgICAgICAgICAgICBnbG9iYWwuZmV0Y2ggPSAodXJsLCBvcHRpb25zKSA9PiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSB5aWVsZCBnbG9iYWwucmVxdWVzdCh1cmwsIG9wdGlvbnMpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGJvZHkgPSB5aWVsZCByZXNwb25zZS50ZXh0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHVybCA9PSBcImh0dHBzOi8vZ3FsLnR3aXRjaC50di9pbnRlZ3JpdHlcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBtYWluV29ya2VyLnBvc3RNZXNzYWdlKHsgZnVuY05hbWU6IFwic2V0SW50ZWdyaXR5XCIsIHZhbHVlOiBib2R5IH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFJlc3BvbnNlKGJvZHksIHJlc3BvbnNlKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZGVjbGFyZUV2ZW50V29ya2VyKCkge1xyXG4gICAgICAgICAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoXCJtZXNzYWdlXCIsIChldmVudCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdmFyIF9hLCBfYiwgX2MsIF9kLCBfZTtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoKF9hID0gZXZlbnQgPT09IG51bGwgfHwgZXZlbnQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGV2ZW50LmRhdGEpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS50eXBlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcImdldFNldHRpbmdzXCI6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LnBvc3RNZXNzYWdlKHsgdHlwZTogXCJnZXRTZXR0aW5nc1wiLCB2YWx1ZTogbnVsbCB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJQbGF5ZXJRdWFsaXR5Q2hhbmdlZFwiOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1haW5Xb3JrZXIucG9zdE1lc3NhZ2UoeyBmdW5jTmFtZTogXCJzZXRRdWFsaXR5XCIsIHZhbHVlOiBldmVudC5kYXRhLmFyZy5uYW1lIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcInBhdXNlXCI6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWFpbldvcmtlci5wb3N0TWVzc2FnZSh7IGZ1bmNOYW1lOiBcInBhdXNlXCIsIGFyZ3M6IHVuZGVmaW5lZCwgaWQ6IDEgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBjYXNlIFwicGxheVwiOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1haW5Xb3JrZXIucG9zdE1lc3NhZ2UoeyBmdW5jTmFtZTogXCJwbGF5XCIsIGFyZ3M6IHVuZGVmaW5lZCwgaWQ6IDEgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoKF9jID0gKF9iID0gZXZlbnQgPT09IG51bGwgfHwgZXZlbnQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGV2ZW50LmRhdGEpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5hcmcpID09PSBudWxsIHx8IF9jID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYy5rZXkpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIFwicXVhbGl0eVwiOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZXZlbnQuZGF0YS5hcmcudmFsdWUubmFtZSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkNoYW5nZWQgcXVhbGl0eSBieSBwbGF5ZXI6IFwiICsgZXZlbnQuZGF0YS5hcmcudmFsdWUubmFtZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1haW5Xb3JrZXIucG9zdE1lc3NhZ2UoeyBmdW5jTmFtZTogXCJzZXRRdWFsaXR5XCIsIHZhbHVlOiBldmVudC5kYXRhLmFyZy52YWx1ZS5uYW1lIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcInN0YXRlXCI6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWFpbldvcmtlci5wb3N0TWVzc2FnZSh7IGZ1bmNOYW1lOiBldmVudC5kYXRhLmFyZy52YWx1ZSB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKChfZSA9IChfZCA9IGV2ZW50ID09PSBudWxsIHx8IGV2ZW50ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBldmVudC5kYXRhKSA9PT0gbnVsbCB8fCBfZCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2QuYXJnKSA9PT0gbnVsbCB8fCBfZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2UubmFtZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJwYXVzZVwiOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBjYXNlIFwicGxheVwiOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGRlY2xhcmVFdmVudFdpbmRvdygpIHtcclxuICAgICAgICAgICAgLy9FdmVudCBsaXN0ZW5lciBmcm9tIHdpbmRvdyBhbmQgZXh0ZW5zaW9uLlxyXG4gICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcIm1lc3NhZ2VcIiwgKGV2ZW50KSA9PiB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKGV2ZW50LmRhdGEudHlwZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJzZXRTZXR0aW5nc1wiOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vc2VuZCBzZXR0aW5ncyB0byB3b3JrZXJcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWFpbldvcmtlci5wb3N0TWVzc2FnZSh7IGZ1bmNOYW1lOiBcInNldFNldHRpbmdzXCIsIHZhbHVlOiBldmVudC5kYXRhLnZhbHVlIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxufSkoKTtcclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZGF0YTphcHBsaWNhdGlvbi9qc29uO2Jhc2U2NCxleUoyWlhKemFXOXVJam96TENKbWFXeGxJam9pYVc1a1pYZ3Vhbk1pTENKemIzVnlZMlZTYjI5MElqb2lJaXdpYzI5MWNtTmxjeUk2V3lJdUxpOXpjbU12YVc1a1pYZ3VkSE1pWFN3aWJtRnRaWE1pT2x0ZExDSnRZWEJ3YVc1bmN5STZJanM3T3pzN096czdPenM3T3pzN1FVRkJRU3hyUlVGQmEwVTdRVUZEYkVVc2EwSkJRV3RDTzBGQlEyeENMREJGUVVGM1F6dEJRVVY0UXl4RFFVRkRPMGxCUTBNc1NVRkJTU3hWUVVGbExFTkJRVU03U1VGRmNFSXNUVUZCVFN4RFFVRkRMRTFCUVUwc1IwRkJSeXhOUVVGTkxHTkJRV1VzVTBGQlVTeE5RVUZOTzFGQlEycEVMRmxCUVZrc1lVRkJhMEk3V1VGRE5VSXNUMEZCVHl4RFFVRkRMRWRCUVVjc1EwRkJReXh4UWtGQmNVSXNSMEZCUnl4aFFVRmhMRU5CUVVNc1EwRkJRenRaUVVWdVJDeEpRVUZKTEdGQlFXRXNTVUZCU1N4RlFVRkZPMmRDUVVGRkxFdEJRVXNzUTBGQlF5eGhRVUZoTEVOQlFVTXNRMEZCUXp0WlFVTTVReXhQUVVGUExFTkJRVU1zUjBGQlJ5eERRVUZETEdsQ1FVRnBRaXhIUVVGSExHRkJRV0VzUTBGQlF5eERRVUZETzFsQlJTOURMRTFCUVUwc1ZVRkJWU3hIUVVGSExFZEJRVWNzZFVKQlFVYzdkVUpCUTFJc1lVRkJZU3hMUVVGTExFTkJRVU03V1VGRmNFTXNTMEZCU3l4RFFVRkRMRWRCUVVjc1EwRkJReXhsUVVGbExFTkJRVU1zU1VGQlNTeEpRVUZKTEVOQlFVTXNRMEZCUXl4VlFVRlZMRU5CUVVNc1JVRkJSU3hGUVVGRkxFbEJRVWtzUlVGQlJTeHBRa0ZCYVVJc1JVRkJSU3hEUVVGRExFTkJRVU1zUTBGQlF5eERRVUZETzFsQlEyaEdMRlZCUVZVc1IwRkJSeXhKUVVGSkxFTkJRVU03V1VGRGJFSXNWVUZCVlN4RFFVRkRMR3RDUVVGclFpeEZRVUZGTEVOQlFVTTdXVUZEYUVNc1ZVRkJWU3hEUVVGRExHdENRVUZyUWl4RlFVRkZMRU5CUVVNN1dVRkRhRU1zVlVGQlZTeERRVUZETEZOQlFWTXNSVUZCUlN4RFFVRkRPMUZCUTNwQ0xFTkJRVU03VVVGRlN5eFRRVUZUT3p0blFrRkRZaXhOUVVGTkxFTkJRVU1zVDBGQlR5eEhRVUZITEV0QlFVc3NRMEZCUVR0blFrRkRkRUlzVFVGQlRTeERRVUZETEV0QlFVc3NSMEZCUnl4RFFVRlBMRWRCUVZFc1JVRkJSU3hQUVVGWkxFVkJRVVVzUlVGQlJUdHZRa0ZET1VNc1RVRkJUU3hSUVVGUkxFZEJRVWNzVFVGQlRTeE5RVUZOTEVOQlFVTXNUMEZCVHl4RFFVRkRMRWRCUVVjc1JVRkJSU3hQUVVGUExFTkJRVU1zUTBGQlF6dHZRa0ZEY0VRc1RVRkJUU3hKUVVGSkxFZEJRVWNzVFVGQlRTeFJRVUZSTEVOQlFVTXNTVUZCU1N4RlFVRkZMRU5CUVVNN2IwSkJSVzVETEVsQlFVa3NSMEZCUnl4SlFVRkpMR2xEUVVGcFF5eEZRVUZGTzNkQ1FVTTFReXhWUVVGVkxFTkJRVU1zVjBGQlZ5eERRVUZETEVWQlFVVXNVVUZCVVN4RlFVRkZMR05CUVdNc1JVRkJSU3hMUVVGTExFVkJRVVVzU1VGQlNTeEZRVUZGTEVOQlFVTXNRMEZCUXp0eFFrRkRia1U3YjBKQlJVUXNUMEZCVHl4SlFVRkpMRkZCUVZFc1EwRkJReXhKUVVGSkxFVkJRVVVzVVVGQlVTeERRVUZETEVOQlFVTTdaMEpCUTNSRExFTkJRVU1zUTBGQlFTeERRVUZETzFsQlEwb3NRMEZCUXp0VFFVRkJPMUZCUjBRc2EwSkJRV3RDTzFsQlEyaENMRWxCUVVrc1EwRkJReXhuUWtGQlowSXNRMEZCUXl4VFFVRlRMRVZCUVVVc1EwRkJReXhMUVVGTExFVkJRVVVzUlVGQlJUczdaMEpCUlhwRExGRkJRVkVzVFVGQlFTeExRVUZMTEdGQlFVd3NTMEZCU3l4MVFrRkJUQ3hMUVVGTExFTkJRVVVzU1VGQlNTd3dRMEZCUlN4SlFVRkpMRVZCUVVVN2IwSkJRM3BDTEV0QlFVc3NZVUZCWVN4RFFVRkRMRU5CUVVNN2QwSkJRMnhDTEUxQlFVMHNRMEZCUXl4WFFVRlhMRU5CUVVNc1JVRkJSU3hKUVVGSkxFVkJRVVVzWVVGQllTeEZRVUZGTEV0QlFVc3NSVUZCUlN4SlFVRkpMRVZCUVVVc1EwRkJReXhEUVVGRE8zZENRVU42UkN4TlFVRk5PM0ZDUVVOUU8yOUNRVU5FTEV0QlFVc3NjMEpCUVhOQ0xFTkJRVU1zUTBGQlF6dDNRa0ZETTBJc1ZVRkJWU3hEUVVGRExGZEJRVmNzUTBGQlF5eEZRVUZGTEZGQlFWRXNSVUZCUlN4WlFVRlpMRVZCUVVVc1MwRkJTeXhGUVVGRkxFdEJRVXNzUTBGQlF5eEpRVUZKTEVOQlFVTXNSMEZCUnl4RFFVRkRMRWxCUVVrc1JVRkJSU3hEUVVGRExFTkJRVU03ZDBKQlF5OUZMRTFCUVUwN2NVSkJRMUE3YjBKQlEwUXNTMEZCU3l4UFFVRlBMRU5CUVVNc1EwRkJRenQzUWtGRFdpeFZRVUZWTEVOQlFVTXNWMEZCVnl4RFFVRkRMRVZCUVVVc1VVRkJVU3hGUVVGRkxFOUJRVThzUlVGQlJTeEpRVUZKTEVWQlFVVXNVMEZCVXl4RlFVRkZMRVZCUVVVc1JVRkJSU3hEUVVGRExFVkJRVVVzUTBGQlF5eERRVUZETzNkQ1FVTjBSU3hOUVVGTk8zRkNRVU5RTzI5Q1FVTkVMRXRCUVVzc1RVRkJUU3hEUVVGRExFTkJRVU03ZDBKQlExZ3NWVUZCVlN4RFFVRkRMRmRCUVZjc1EwRkJReXhGUVVGRkxGRkJRVkVzUlVGQlJTeE5RVUZOTEVWQlFVVXNTVUZCU1N4RlFVRkZMRk5CUVZNc1JVRkJSU3hGUVVGRkxFVkJRVVVzUTBGQlF5eEZRVUZGTEVOQlFVTXNRMEZCUXp0M1FrRkRja1VzVFVGQlRUdHhRa0ZEVUR0dlFrRkRSQ3hQUVVGUExFTkJRVU1zUTBGQlF6dDNRa0ZEVUN4TlFVRk5PM0ZDUVVOUU8ybENRVU5HTzJkQ1FVVkVMRkZCUVZFc1RVRkJRU3hOUVVGQkxFdEJRVXNzWVVGQlRDeExRVUZMTEhWQ1FVRk1MRXRCUVVzc1EwRkJSU3hKUVVGSkxEQkRRVUZGTEVkQlFVY3NNRU5CUVVVc1IwRkJSeXhGUVVGRk8yOUNRVU0zUWl4TFFVRkxMRk5CUVZNc1EwRkJReXhEUVVGRE8zZENRVU5rTEVsQlFVa3NRMEZCUXl4TFFVRkxMRU5CUVVNc1NVRkJTU3hEUVVGRExFZEJRVWNzUTBGQlF5eExRVUZMTEVOQlFVTXNTVUZCU1RzMFFrRkJSU3hOUVVGTk8zZENRVU4wUXl4UFFVRlBMRU5CUVVNc1IwRkJSeXhEUVVGRExEWkNRVUUyUWl4SFFVRkhMRXRCUVVzc1EwRkJReXhKUVVGSkxFTkJRVU1zUjBGQlJ5eERRVUZETEV0QlFVc3NRMEZCUXl4SlFVRkpMRU5CUVVNc1EwRkJRenQzUWtGRGRrVXNWVUZCVlN4RFFVRkRMRmRCUVZjc1EwRkJReXhGUVVGRkxGRkJRVkVzUlVGQlJTeFpRVUZaTEVWQlFVVXNTMEZCU3l4RlFVRkZMRXRCUVVzc1EwRkJReXhKUVVGSkxFTkJRVU1zUjBGQlJ5eERRVUZETEV0QlFVc3NRMEZCUXl4SlFVRkpMRVZCUVVVc1EwRkJReXhEUVVGRE8zZENRVU55Uml4TlFVRk5PM0ZDUVVOUU8yOUNRVU5FTEV0QlFVc3NUMEZCVHl4RFFVRkRMRU5CUVVNN2QwSkJRMW9zVlVGQlZTeERRVUZETEZkQlFWY3NRMEZCUXl4RlFVRkZMRkZCUVZFc1JVRkJSU3hMUVVGTExFTkJRVU1zU1VGQlNTeERRVUZETEVkQlFVY3NRMEZCUXl4TFFVRkxMRVZCUVVVc1EwRkJReXhEUVVGRE8zRkNRVU0xUkR0dlFrRkRSQ3hQUVVGUExFTkJRVU1zUTBGQlF6dDNRa0ZEVUN4TlFVRk5PM0ZDUVVOUU8ybENRVU5HTzJkQ1FVVkVMRkZCUVZFc1RVRkJRU3hOUVVGQkxFdEJRVXNzWVVGQlRDeExRVUZMTEhWQ1FVRk1MRXRCUVVzc1EwRkJSU3hKUVVGSkxEQkRRVUZGTEVkQlFVY3NNRU5CUVVVc1NVRkJTU3hGUVVGRk8yOUNRVU01UWl4TFFVRkxMRTlCUVU4c1EwRkJReXhEUVVGRE8zZENRVU5hTEUxQlFVMDdjVUpCUTFBN2IwSkJRMFFzUzBGQlN5eE5RVUZOTEVOQlFVTXNRMEZCUXp0M1FrRkRXQ3hOUVVGTk8zRkNRVU5RTzI5Q1FVTkVMRTlCUVU4c1EwRkJReXhEUVVGRE8zZENRVU5RTEUxQlFVMDdjVUpCUTFBN2FVSkJRMFk3V1VGRFNDeERRVUZETEVOQlFVTXNRMEZCUXp0UlFVTk1MRU5CUVVNN1VVRkZSQ3hyUWtGQmEwSTdXVUZEYUVJc01rTkJRVEpETzFsQlF6TkRMRTFCUVUwc1EwRkJReXhuUWtGQlowSXNRMEZCUXl4VFFVRlRMRVZCUVVVc1EwRkJReXhMUVVGTExFVkJRVVVzUlVGQlJUdG5Ra0ZETTBNc1VVRkJVU3hMUVVGTExFTkJRVU1zU1VGQlNTeERRVUZETEVsQlFVa3NSVUZCUlR0dlFrRkRka0lzUzBGQlN5eGhRVUZoTEVOQlFVTXNRMEZCUXp0M1FrRkRiRUlzZVVKQlFYbENPM2RDUVVONlFpeFZRVUZWTEVOQlFVTXNWMEZCVnl4RFFVRkRMRVZCUVVVc1VVRkJVU3hGUVVGRkxHRkJRV0VzUlVGQlJTeExRVUZMTEVWQlFVVXNTMEZCU3l4RFFVRkRMRWxCUVVrc1EwRkJReXhMUVVGTExFVkJRVVVzUTBGQlF5eERRVUZETzNGQ1FVTTVSVHRwUWtGRFJqdFpRVU5JTEVOQlFVTXNRMEZCUXl4RFFVRkRPMUZCUTB3c1EwRkJRenRMUVVOR0xFTkJRVU03UVVGRFNpeERRVUZETEVOQlFVTXNSVUZCUlN4RFFVRkRJbjA9IiwiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0dmFyIGNhY2hlZE1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF07XG5cdGlmIChjYWNoZWRNb2R1bGUgIT09IHVuZGVmaW5lZCkge1xuXHRcdHJldHVybiBjYWNoZWRNb2R1bGUuZXhwb3J0cztcblx0fVxuXHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuXHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHtcblx0XHQvLyBubyBtb2R1bGUuaWQgbmVlZGVkXG5cdFx0Ly8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWRcblx0XHRleHBvcnRzOiB7fVxuXHR9O1xuXG5cdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuXHRfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuXHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuXHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG59XG5cbiIsIl9fd2VicGFja19yZXF1aXJlX18uZyA9IChmdW5jdGlvbigpIHtcblx0aWYgKHR5cGVvZiBnbG9iYWxUaGlzID09PSAnb2JqZWN0JykgcmV0dXJuIGdsb2JhbFRoaXM7XG5cdHRyeSB7XG5cdFx0cmV0dXJuIHRoaXMgfHwgbmV3IEZ1bmN0aW9uKCdyZXR1cm4gdGhpcycpKCk7XG5cdH0gY2F0Y2ggKGUpIHtcblx0XHRpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ29iamVjdCcpIHJldHVybiB3aW5kb3c7XG5cdH1cbn0pKCk7IiwiIiwiLy8gc3RhcnR1cFxuLy8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4vLyBUaGlzIGVudHJ5IG1vZHVsZSBpcyByZWZlcmVuY2VkIGJ5IG90aGVyIG1vZHVsZXMgc28gaXQgY2FuJ3QgYmUgaW5saW5lZFxudmFyIF9fd2VicGFja19leHBvcnRzX18gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFwiLi9zcmMvaW5kZXgudHNcIik7XG4iLCIiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=